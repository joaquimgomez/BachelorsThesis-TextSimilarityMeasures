






























































SIMP-ALL: A generalized SIMP method based on the topological derivative concept


Received: 15 March 2019 Revised: 21 May 2019 Accepted: 4 June 2019

DOI: 10.1002/nme.6140

R E S E A R C H A R T I C L E

SIMP-ALL: A generalized SIMP method based on the
topological derivative concept

A. Ferrer1,2

1Centre de MathÃ©matiques AppliquÃ©es,
Ã‰cole Polytechnique, UniversitÃ©
Paris-Saclay, Palaiseau, France
2Centre Internacional de MÃ¨todes
NumÃ¨rics en Enginyeria (CIMNE),
Campus Nord UPC, Barcelona, Spain

Correspondence
A. Ferrer, Centre de MathÃ©matiques
AppliquÃ©es, Ã‰cole Polytechnique,
UniversitÃ© Paris-Saclay, 91128 Palaiseau,
France; or Centre Internacional de
MÃ¨todes NumÃ¨rics en Enginyeria
(CIMNE), Campus Nord UPC, Edifici C-1,
c/Jordi Girona 1-3, 08034 Barcelona, Spain.
Email: aferrer@cimne.upc.edu

Funding information
European Union's Horizon 2020 research
and innovation programme, Grant/Award
Number: 712949; Agency for Business
Competitiveness of the Government of
Catalonia

Summary

Topology optimization has emerged in the last years as a promising research field
with a wide range of applications. One of the most successful approaches, the
SIMP method, is based on regularizing the problem and proposing a penaliza-
tion interpolation function. In this work, we propose an alternative interpolation
function, the SIMP-ALL method that is based on the topological derivative con-
cept. First, we show the strong relation in plane linear elasticity between the
Hashin-Shtrikman (H-S) bounds and the topological derivative, providing a
new interpretation of the last one. Then, we show that the SIMP-ALL interpo-
lation remains always in between the H-S bounds regardless the materials to
be interpolated. This result allows us to interpret intermediate values as real
microstructures. Finally, we verify numerically this result and we show the con-
venience of the proposed SIMP-ALL interpolation for obtaining auto-penalized
optimal design in a wider range of cases. A MATLAB code of the SIMP-ALL
interpolation function is also provided.

KEYWORDS

Hashin-Shtrikman bounds, SIMP, topological derivative, topology optimization

1 INTRODUCTION

In the recent years, topology optimization has become a research field by itself, not only because it arouses interest on
the scientific community but also because it provides successful solutions to industrial problems.1 Traditionally, topology
optimization seeks to design light-weight structural components without losing stiffness capabilities. In the last years, it
addresses other fields of applications with equally success. For that propose, several approaches have emerged in the last
decades.

Initially, topology optimization has been successfully addressed through regularization techniques. The SIMP method
represents probably the most celebrated strategy. The characteristic function, usually used to describe the weak (white)
and stiff (black) subdomains, is regularized allowing intermediate values, or in other words, allowing the presence of gray
areas. Frequently, this regularized representation of the characteristic is commonly named density function. Usually, the
challenge is to characterize the material properties of the intermediate values of the density function (gray areas). This
characterization is commonly described by an interpolation function. As referred in the work of BendsÃ¸e and Sigmund,2
the SIMP method proposes a polynomial interpolation function that, in some cases, lies inside the Hashin-Shtrikman
(H-S) bounds. This could lead to gray areas that sometimes cannot be interpreted as microstructures. Additionally,
depending on the nature of the materials, the SIMP method could propose a weak interpolation penalization, and
consequently, large gray areas could appear.

This is an open access article under the terms of the Creative Commons Attribution License, which permits use, distribution, and reproduction in any medium, provided the
original work is properly cited.
Â© 2019 The Authors. International Journal for Numerical Methods in Engineering Published by John Wiley & Sons, Ltd.

Int J Numer Methods Eng. 2019;120:361â€“381. wileyonlinelibrary.com/journal/nme 361

https://doi.org/10.1002/nme.6140
https://orcid.org/0000-0003-1011-0230


362 FERRER

In this sense, novel projection methods have enabled promising black and white topologies.3 However, even not gray
areas appear when using projection method, the final topology could be significantly suboptimal since it is influenced by
the material properties provided by the corresponding interpolation. To circumvent this limitation and in order to fulfill
the H-S bounds, other interpolation functions have been also proposed. Some examples can be found in the works of
Stolpe and Svanberg4 and DzierzÌ‡anowski.5

Alternatively, due to the concept of shape derivative, shape optimization has also established as a reference strategy
to solve topology optimization problems. Usually, the domain is described through a level-set function that, in turn, is
advected using the shape derivate expression of the objective function. In this case, the shape derivative plays the role of
the velocity field in the Hamilton-Jacobi equation.6 Although the algorithm requires considering initial holes, which can
be increased and merged, resulting in new topologies during the iterations, the optimal shape presents no intermediate
values and is clearly defined in the boundary.

Likewise, topological derivative addresses topology optimization with the intention of not considering intermediate
values. The concept is based on studying the sensitivity of a functional when a circular (or ellipsoidal) inclusion of a
weak material is inserted in a stiff material (or vice-versa). Through an asymptotic expansion and after solving an exterior
problem, the obtained topological derivative closed formula certainly measures the adequacy or not of inserting in a
certain point a weak/stiff inclusion. This valued concept is frequently exploited by level-set algorithms. The pioneer work
of Amstutz and AndrÃ¤7 is a clear example. Other approaches can be found in the works of Allaire et al8 and Yamada et al.9

Additionally, we can find in the literature the discrete and evolutionary algorithms, like BESO,10 as a competitive alter-
native to solve the problem. Although high efficiency is not clear for large problems, significant progress is achieved due to
the increase of the available computational power. In the last years, other numerical techniques for decreasing the compu-
tational cost of topology optimization problems have been developed, like adaptive mesh refinement11 and polytree-based
adaptive polygonal finite element method.12

Although, at first sight, all the described approaches may seem very different, some connections have been observed
in the work of Amstutz13 for the case of the topological derivative and the SIMP method approach, especially when the
Poisson ratio of the stiff material is around 1âˆ•3. The present work follows and generalizes the results of that work. The
first main result of the present work is to connect the topological derivative with the H-S bounds. This result allows us
to have a new physical interpretation of the topological derivative concept. Then, based on the topological derivative, we
propose the SIMP-ALL interpolation. Apart of being free of heuristic parameters, we show, as the second main result of
this work, that it always remains in between the H-S bounds regardless the stiff and weak materials properties we want
to interpolate. This result provides us a physical interpretation in terms of microstructures when using the SIMP-ALL
interpolation. Note that proposing an interpolation strategy is convenient when the characteristic functions appears inside
the differential operator. When this is not the case, no interpolation is needed, see for example, the work of SÃ¡ et al.14

To validate the results, different cases are presented to compare SIMP-ALL with the SIMP interpolation functions and
their relation with the H-S bounds. Finally, some numerical examples are computed to see the influence and convenience
of the interpolation function on the optimal topologies. Additionally, a MATLAB code of the SIMP-ALL interpolation is
provided.

This work is organized as follows. Section 2 presents the bimaterial topology optimization problem. Section 3 introduces
the concept of the topological derivative and presents the topological derivative for isotropic materials in terms of the shear
and bulk modulus. H-S bounds are briefly presented in Section 4 and connected with the topological derivative. The special
kind of rational functions used in this work is defined in Section 5, and the SIMP-ALL interpolation function is presented
in Section 6. Section 7 includes a comparison between SIMP and SIMP-ALL in relation with the H-S bounds. Additionally,
some numerical examples are computed to observe the influence of the interpolation functions in the optimal topologies.
The present work concludes in Section 8.

2 TOPOLOGY OPTIMIZATION FORMULATION

2.1 The exact topology optimization problem
Let Î© be a fixed domain split into Î©1 and Î©0 with enough regularity, fulfilling Î©1 âˆª Î©0 = Î© and Î©1 âˆ© Î©0 = âˆ…. Let the
boundary of Î© be defined as Î“ âˆ¶= ğœ•Î© and split into Î“D and Î“N and let the spaces î‰ ,î‰‚ , and î‰„ be defined as

î‰ âˆ¶= {ğœ™ âˆˆ H1(Î©) âˆ¶ ğœ™|Î“D = u0} ,î‰‚ âˆ¶= {ğœ™ âˆˆ H1(Î©) âˆ¶ ğœ™|Î“D = 0} , and î‰„ âˆ¶= Lâˆ(Î©, {0, 1}). (1)



FERRER 363

Then, let us define the characteristic function ğœ’ âˆˆ î‰„ and the fourth-order tensor C(ğœ’) as

ğœ’(x) =

{
0 x âˆˆ Î©0
1 x âˆˆ Î©1

and C(ğœ’) = (1 âˆ’ ğœ’)C0 + ğœ’C1. (2)

The constitutive tensors C0 and C1 in plane stress linear elasticity are defined as

C1 = 2ğœ‡1I + (ğœ…1 âˆ’ ğœ‡1)I âŠ— I and C0 = 2ğœ‡0I + (ğœ…0 âˆ’ ğœ‡0)I âŠ— I, (3)

where I and I represents the fourth- and second-order identity tensors andğœ…1, ğœ‡1 andğœ…0, ğœ‡0 are the bulk and shear modulus
of the material in Î©1 and in Î©0, respectively. Introducing the bilinear and linear form of the linear elasticity problem as

a(ğœ’,u, v) = âˆ«Î©âˆ‡
su âˆ¶ C(ğœ’) âˆ¶ âˆ‡su and l(v) = âˆ«Î“N

t Â· v, (4)

the exact topology optimization problem can be then defined as follows: find ğœ’ âˆˆ î‰„ and u âˆˆ î‰ such that
min.
ğœ’,u

J(ğœ’,u) = l(u)
s.t. âˆ«Î©ğœ’ â‰¤ V

a(ğœ’,u, v) = l(v) âˆ€v âˆˆ î‰‚ ,
(5)

where, in this case, the cost J(ğœ’,u) stands for the compliance function.

2.2 The relaxed topology optimization problem
The difficulties of solving the exact problem are usually circumvented by proposing a relaxed version of it, this is by
replacing the characteristic function with a density-like function ğœŒ(x) âˆˆ [0, 1], which, in contrast with the characteristic
function, can take intermediate values. Thus, the exact topology optimization problem can be rewritten as the following
regularized topology optimization problem: find ğœŒ âˆˆ îˆ¾ = Lâˆ(Î©, [0, 1]) and u âˆˆ î‰ such that

min.
ğœŒ,u

J(ğœŒ,u) = l(u)
s.t. âˆ«Î©ğœŒ â‰¤ V

a(ğœŒ,u, v) = l(v) âˆ€v âˆˆ î‰‚ ,
(6)

where the bilinear and linear form are now defined as

a(ğœŒ,u, v) = âˆ«Î©âˆ‡
su âˆ¶ C(ğœŒ) âˆ¶ âˆ‡su and l(v) = âˆ«Î“N

t Â· v. (7)

In this case, the constitutive tensor takes the following form:

C(ğœŒ) = 2ğœ‡(ğœŒ)I + (ğœ…(ğœŒ) âˆ’ ğœ‡(ğœŒ))I âŠ— I, (8)

where ğœ‡(ğœŒ) âˆˆ Câˆ([0, 1], [ğœ‡0, ğœ‡1]) and ğœ…(ğœŒ) âˆˆ C
âˆ([0, 1], [ğœ…0, ğœ…1]) are interpolation functions that must be proposed.

Computation of the compliance gradient. Let the compliance function l(u) be defined as in (7) and let u âˆˆ î‰ be
the solution of the elasticity problem defined in (6), then the gradient of the compliance takes the following form:

g(ğœŒ) = âˆ’âˆ‡su âˆ¶ Câ€²(ğœŒ) âˆ¶ âˆ‡su, (9)

where Câ€²(ğœŒ) is the derivative of the constitutive tensor defined in (8). To see this result, let us define the implicit function
F(ğœŒ) as

F(ğœŒ) = a(ğœŒ,u(ğœŒ), v) âˆ’ l(v) = 0 âˆ€v âˆˆ î‰‚ , (10)



364 FERRER

and let us compute its differential. From ellipticity arguments,15 we can state that âˆ€ v âˆˆ î‰‚ and âˆ€ğœŒ âˆˆ îˆ¾ that provides a
coercive constitutive tensor, there exists a unique u âˆˆ î‰ that solves a(ğœŒ,u(ğœŒ), v) = l(v). Thus, defining a density variation
ï¿½Ìƒï¿½ âˆˆ îˆ¾, we can state that F(ğœŒ + ï¿½Ìƒï¿½) = F(ğœŒ) = 0, and consequently,

F(ğœŒ + ï¿½Ìƒï¿½) âˆ’ F(ğœŒ) = a(ğœŒ + ï¿½Ìƒï¿½,u(ğœŒ + ï¿½Ìƒï¿½), v) âˆ’ a(ğœŒ,u(ğœŒ), v)
= a(ğœŒ + ï¿½Ìƒï¿½,u(ğœŒ + ï¿½Ìƒï¿½), v) âˆ’ a(ğœŒ + ï¿½Ìƒï¿½,u(ğœŒ), v) + a(ğœŒ + ï¿½Ìƒï¿½,u(ğœŒ), v) âˆ’ a(ğœŒ,u(ğœŒ), v)
= a(ğœŒ + ï¿½Ìƒï¿½,u(ğœŒ) + Du(ğœŒ)ï¿½Ìƒï¿½, v) âˆ’ a(ğœŒ + ï¿½Ìƒï¿½,u(ğœŒ), v) + DğœŒa(ğœŒ,u(ğœŒ), v)ï¿½Ìƒï¿½ + o(||ï¿½Ìƒï¿½||2)
= a(ğœŒ + ï¿½Ìƒï¿½,Du(ğœŒ)ï¿½Ìƒï¿½, v) + DğœŒa(ğœŒ,u(ğœŒ), v)ï¿½Ìƒï¿½ + o(||ï¿½Ìƒï¿½||2)
= a(ğœŒ,Du(ğœŒ)ï¿½Ìƒï¿½, v) + DğœŒa(ğœŒ,u(ğœŒ), v)ï¿½Ìƒï¿½ + o(||ï¿½Ìƒï¿½||2) = 0,

(11)

where DğœŒa(ğœŒ,u(ğœŒ), v) is the FrÃ©chet derivative with respect to the first argument of the bilinear form a(ğœŒ,u, v) and Du(ğœŒ)
is the FrÃ©chet derivative of u at ğœŒ. Then, the differential of the compliance can be computed as

l(u(ğœŒ + ï¿½Ìƒï¿½)) âˆ’ l(u(ğœŒ)) = a(ğœŒ,u(ğœŒ),DğœŒu(ğœŒ)ï¿½Ìƒï¿½) + o(||ï¿½Ìƒï¿½||2) = a(ğœŒ,DğœŒu(ğœŒ)ï¿½Ìƒï¿½,u(ğœŒ)) + o(||ï¿½Ìƒï¿½||2)
= âˆ’DğœŒa(ğœŒ,u(ğœŒ), v)ï¿½Ìƒï¿½ + o(||ï¿½Ìƒï¿½||2) = âˆ’[a(ğœŒ + ï¿½Ìƒï¿½,u(ğœŒ), v) âˆ’ a(ğœŒ,u(ğœŒ), v)] + o(||ï¿½Ìƒï¿½||2)
= âˆ’âˆ«Î©âˆ‡

su âˆ¶ (C(ğœŒ + ï¿½Ìƒï¿½) âˆ’C(ğœŒ)) âˆ¶ âˆ‡su + o(||ï¿½Ìƒï¿½||2)
= âˆ’âˆ«Î©âˆ‡

su âˆ¶ (Câ€²(ğœŒ)ï¿½Ìƒï¿½) âˆ¶ âˆ‡su + o(||ï¿½Ìƒï¿½||2) = Dl(ğœŒ)ï¿½Ìƒï¿½ + o(||ï¿½Ìƒï¿½||2),
(12)

where we have used the symmetric behavior of the bilinear form and the result of (11). Note that, for neglecting
higher-order terms, we have supposed that the reminder o(||ï¿½Ìƒï¿½||2) is small enough. The proof ends relating the gradient
g(ğœŒ) of the compliance with its FrÃ©chet derivative Dl(u) by the Riesz representation theorem, ie, Dl(ğœŒ)ï¿½Ìƒï¿½ = âˆ«Î©gï¿½Ìƒï¿½.

3 TOPOLOGICAL DERIVATIVE

On a given domain (unperturbed) Î© âŠ‚ R2, let us insert in a certain point xÌ‚ a small circular inclusion Bğœ€ of radius ğœ€ > 0.
We call the new (perturbed) domain Î©ğœ€ (see in Figure 1).

Definition 1. Let J(Î©) and Jğœ€(Î©) be the value of a function in the unperturbed and perturbed domain. For a certain
positive function f(ğœ€) such that f(ğœ€) â†’ 0 when ğœ€ â†’ 0, typically, f(ğœ€) = ğœ‹ğœ€2, we define the topological derivative of J(Î©)
as the following limit:

gT(xÌ‚) = lim
ğœ€â†’0+

Jğœ€(Î©) âˆ’ J(Î©)
ğ‘“ (ğœ€)

. (13)

Remark 1. Note that to make expression (13) well defined, we need to ask that function Jğœ€(Î©) admits the following
asymptotic expansion:

Jğœ€(Î©) âˆ’ J(Î©) = ğ‘“ (ğœ€)gT(xÌ‚) + o( ğ‘“ (ğœ€)). (14)

Definition 2. For a given Young's modulus and Poisson's ratio of the matrix Î©ğœ€â§µBğœ€ and the inclusion Bğœ€, represented
by Em, ğœˆm and Ei, ğœˆi respectively, we define the fourth-order polarization tensor P as

P = p1I + p2I âŠ— I, (15)

FIGURE 1 Topological derivative concept



FERRER 365

where the parameters p1 and p2 take the following values:

p1 =
1

ğ›½ğ›¾ + ğœ1
(1 + ğ›½)(ğœ1 âˆ’ ğ›¾) and p2 =

1
2
(ğ›¼ âˆ’ ğ›½)
ğ›½ğ›¾ + ğœ1

[ğ›¾(ğ›¾ âˆ’ 2ğœ3) + ğœ1ğœ2]
ğ›¼ğ›¾ + ğœ2

, (16)

and the coefficients ğ›¼, ğ›½, ğ›¾ , ğœ1, ğœ2, and ğœ3 are of the form

ğ›¼ =
1 + ğœˆm
1 âˆ’ ğœˆm

, ğ›½ =
3 âˆ’ ğœˆm
1 + ğœˆm

, ğ›¾ =
Ei
Em

, (17)

ğœ1 =
1 + ğœˆi
1 + ğœˆm

, ğœ2 =
1 âˆ’ ğœˆi
1 âˆ’ ğœˆm

, and ğœ3 =
ğœˆi(3ğœˆm âˆ’ 4) + 1
ğœˆm(3ğœˆm âˆ’ 4) + 1

. (18)

Proposition 1. Let u âˆˆ î‰ be the solution of the elasticity problem defined in (6), let the compliance l(u) be defined as in
(7), and let the polarization tensor P be expressed as in Definition 1, then the topological derivative at the point xÌ‚, defined
as in Definition 1, is as follows:

gT(xÌ‚) = ğœ(xÌ‚) âˆ¶ P âˆ¶ âˆ‡su(xÌ‚), (19)
where âˆ‡s is the symmetric gradient operator and ğœ = Cm âˆ¶ âˆ‡su the stresses with Cm the constitutive tensor of the matrix
domain.

Proof. This result is not trivial and is obtained after proposing an asymptotic expansion of the solution of the topolog-
ically perturbed problem and after analytically solving an associated exterior problem. See the work of Novotny and
SokoÅ‚owski16 for full details. For the same result but for any value of the Poisson ratio, see the work of Giusti et al.17

For an easier comparison with the H-S bounds, we seek to rewrite the topological derivative only in terms of the shear
and bulk modulus.

Topological derivative in terms of the shear and bulk modulus. Let us define the parameters ğœ‚ğœ‡m =
ğœ…mğœ‡m

2ğœ‡m+ğœ…m
and

ğœ‚ğœ…m = ğœ‡m in terms of the shear and bulk modulus of the matrix ğœ‡m, km and the insertion ğœ‡i, ğœ… i and let us define the shear
and bulk polarization parameters qğœ‡ and qğœ… as

qğœ‡ = q(ğœ‡m, ğœ‡I , ğœ‚ğœ‡m), qğœ… = q(ğœ…m, ğœ…I , ğœ‚ğœ…m) with q(t1, t2, t3) =
(t1 + t3)

t1(t2 + t3)
. (20)

Then, the topological derivative in xÌ‚ can be written only in terms of the shear and bulk modulus (of the matrix and
inclusion) as follows:

gT(xÌ‚) = âˆ’âˆ‡su(xÌ‚) âˆ¶ dC âˆ¶ âˆ‡su(xÌ‚) with dC = 2dğœ‡I + [dğœ… âˆ’ dğœ‡]I âŠ— I, (21)

where the parameters dğœ‡ and dğœ… are

dğœ‡ = ğœ‡m(ğœ‡I âˆ’ ğœ‡m)qğœ‡ and dğœ… = ğœ…m(ğœ…I âˆ’ ğœ…m)qğœ…. (22)

To obtain this expression, let the shear and bulk polarization coefficients qğœ‡ and qğœ… be computed first as

qğœ‡ =
pğœ‡

(ğœ‡m âˆ’ ğœ‡I)
and qğœ… =

pğœ…
(ğœ…m âˆ’ ğœ…I)

with pğœ‡ = p1 and pğœ… = 2p1 + p2. (23)

Inserting the lame parameters relations for plane stress E = 4ğœ…ğœ‡
ğœ…+ğœ‡

, and ğœˆ = ğœ…âˆ’ğœ‡
ğœ…+ğœ‡

into the coefficients defined in (17) and
(18) and replacing them in (16), we can write the shear and bulk polarization coefficients as follows:

qğœ‡ =

(
ğœ‡m +

ğœ…mğœ‡m
2ğœ‡m+ğœ…m

)
ğœ‡m

(
ğœ‡I +

ğœ…mğœ‡m
2ğœ‡m+ğœ…m

) and qğœ… = (ğœ…m + ğœ‡m)
ğœ…m(ğœ…I + ğœ‡m)

, (24)



366 FERRER

which are precisely q(ğœ‡m, ğœ‡I , ğœ‚ğœ‡m) and q(ğœ…m, ğœ…I , ğœ‚ğœ…m ). Then, replacing relation (23) in (15), we can directly rewrite the
polarization tensor as P = pğœ‡I+

1
2
(pğœ… âˆ’ pğœ‡)I âŠ— I. The proof ends by replacing this last relation and the constitutive tensor

of the matrix Cm = 2ğœ‡mI + (ğœ…m âˆ’ ğœ‡m)I âŠ— I in the topological derivative expression (19).

Remark 2. We can clearly identify two different cases.

(i) Stiffer inclusion insertion: We define this case by saying that, in a point xÌ‚ âˆˆ Î©0 with parametersğœ‡m = ğœ‡0, ğœ…m =
ğœ…0, we add an inclusion with parameters ğœ‡I = ğœ‡1 and ğœ…I = ğœ…1. Then, the topological derivative gT0 in this scenario
takes in the point xÌ‚ the following form:

gT0 (xÌ‚) = âˆ’âˆ‡
su(xÌ‚) âˆ¶ dC0 âˆ¶ âˆ‡su(xÌ‚), (25)

with
dC0 = 2ğœ‡0(ğœ‡1 âˆ’ ğœ‡0)qğœ‡0I +

[
ğœ…0(ğœ…1 âˆ’ ğœ…0)qğœ…0 âˆ’ ğœ‡0(ğœ‡1 âˆ’ ğœ‡0)qğœ‡0

]
I âŠ— I, (26)

where qğœ‡0 = q(ğœ‡0, ğœ‡1, ğœ‚ğœ‡0), qğœ…0 = q(ğœ…0, ğœ…1, ğœ‚ğœ…0 ), ğœ‚ğœ‡0 =
ğœ…0ğœ‡0

2ğœ‡0+ğœ…0
, and ğœ‚ğœ…0 = ğœ‡0 are all positive values.

(ii) Weaker inclusion insertion: Similarly, we define the opposite case by identifying in a point xÌ‚ âˆˆ Î©1 the matrix
parameters asğœ‡m = ğœ‡1, ğœ…m = ğœ…1 and the parameters of the inclusion asğœ‡I = ğœ‡0 and ğœ…I = ğœ…0. Then, the topological
derivative gT1 takes in the point xÌ‚ the following form:

gT1 (xÌ‚) = âˆ’âˆ‡
su(xÌ‚) âˆ¶ dC1 âˆ¶ âˆ‡su(xÌ‚), (27)

with
dC1 = 2ğœ‡1(ğœ‡0 âˆ’ ğœ‡1)qğœ‡1I +

[
ğœ…1(ğœ…0 âˆ’ ğœ…1)qğœ…1 âˆ’ ğœ‡1(ğœ‡0 âˆ’ ğœ‡1)qğœ‡1

]
I âŠ— I, (28)

where qğœ‡1 = q(ğœ‡1, ğœ‡0, ğœ‚ğœ‡1), qğœ…1 = q(ğœ…1, ğœ…0, ğœ‚ğœ…1 ), ğœ‚ğœ‡1 =
ğœ…1ğœ‡1

2ğœ‡1+ğœ…1
and ğœ‚ğœ…1 = ğœ‡1 are also positive values.

Remark 3. Following the seminal work of Amstutz,13 one could think on proposing an interpolation scheme such that
the gradient in Î©1 and Î©0 coincides precisely with the topological derivative. We distinguish again both scenarios.

(i) Stiffer inclusion insertion: Take ï¿½Ìƒï¿½ = ğœ‹ğœ€2 in B(xÌ‚, ğœ€) and zero otherwise, where B(xÌ‚, ğœ€) represents a small circular
ball of center xÌ‚ and radius ğœ€. This means that, when replacing a small circular domain of the matrix by a small
circular inclusion, we add a small amount of density. Then, if we want that Taylor's expansion (12) matches with
the asymptotic expansion (14), we must define an interpolation such that, when xÌƒ âˆˆ Î©0 (ğœŒ = 0),

g(0) = gT0(xÌ‚) =â‡’ C
â€²(0) = dC0 =â‡’

{
ğœ‡â€²(0) = ğœ‡0(ğœ‡1 âˆ’ ğœ‡0)qğœ‡0
ğœ…â€²(0) = ğœ…0(ğœ…1 âˆ’ ğœ…0)qğœ…0,

(29)

(ii) Weaker inclusion insertion: In this case, we take ï¿½Ìƒï¿½ = âˆ’ğœ‹ğœ€2 in B(xÌ‚, ğœ€) and zero otherwise. This means that,
when replacing a small circular domain of the matrix by a small circular inclusion, we subtract a small amount of
density. Similarly, to match both expansions, we should define an interpolation such that, when xÌƒ âˆˆ Î©1 (ğœŒ = 1),

âˆ’g(1) = gT1(xÌ‚) =â‡’ C
â€²(1) = âˆ’dC1 =â‡’

{
ğœ‡â€²(1) = ğœ‡1(ğœ‡1 âˆ’ ğœ‡0)qğœ‡1
ğœ…â€²(1) = ğœ…1(ğœ…1 âˆ’ ğœ…0)qğœ…1.

(30)

4 CONNECTION BETWEEN THE TOPOLOGICAL DERIVATIVE AND
HASHIN-SHTRIKMAN BOUNDS

H-S bounds. Let us suppose that a composite material with shear and bulk constitutive properties ğœ‡H and ğœ…H is com-
posed by two-phase materials with a fraction volume ğœŒ âˆˆ [0, 1]. Let us assume that the shear and bulk modulus of both
constituents of the composite are ğœ‡0 and ğœ…0 and ğœ‡1 and ğœ…1 and satisfies ğœ…1 > ğœ…0. Then, the shear and bulk modulus of the



FERRER 367

composite material ğœ‡H and ğœ…H have an upper and lower bound regardless the arrangement of both phases. In addition,
those bounds, commonly called isotropic H-S bounds, can be written, in the case of the shear modulus, as

ğœ‡LB(ğœŒ) = ğœ‡0(1 âˆ’ ğœŒ) + ğœ‡1ğœŒ âˆ’
(1 âˆ’ ğœŒ)ğœŒ(ğœ‡1 âˆ’ ğœ‡0)2

ğœ‡0ğœŒ + ğœ‡1(1 âˆ’ ğœŒ) +
ğœ…0ğœ‡0

2ğœ‡0+ğœ…0

ğœ‡UB(ğœŒ) = ğœ‡0(1 âˆ’ ğœŒ) + ğœ‡1ğœŒ âˆ’
(1 âˆ’ ğœŒ)ğœŒ(ğœ‡1 âˆ’ ğœ‡0)2

ğœ‡0ğœŒ + ğœ‡1(1 âˆ’ ğœŒ) +
ğœ…1ğœ‡1

2ğœ‡1+ğœ…1

(31)

and similarly in the bulk modulus case as

ğœ…LB(ğœŒ) = ğœ…0(1 âˆ’ ğœŒ) + ğœ…1ğœŒ âˆ’
(1 âˆ’ ğœŒ)ğœŒ(ğœ…1 âˆ’ ğœ…0)2

ğœ…0ğœŒ + ğœ…1(1 âˆ’ ğœŒ) + ğœ‡0

ğœ…UB(ğœŒ) = ğœ…0(1 âˆ’ ğœŒ) + ğœ…1ğœŒ âˆ’
(1 âˆ’ ğœŒ)ğœŒ(ğœ…1 âˆ’ ğœ…0)2

ğœ…0ğœŒ + ğœ…1(1 âˆ’ ğœŒ) + ğœ‡1
.

(32)

Those bounds were developed in the work of Hashin and Shtrikman.18 See also reference books by BendsÃ¸e and
Sigmund19 and Allaire.20

Remark 4. Note that all bounds can be expressed in the following general form (generalized H-S bounds):

ğ‘“HS(ğœŒ) = ğ‘“0(1 âˆ’ ğœŒ) + ğ‘“1ğœŒ âˆ’
(1 âˆ’ ğœŒ)ğœŒ(ğ‘“1 âˆ’ ğ‘“0)2

ğ‘“0ğœŒ + ğ‘“1(1 âˆ’ ğœŒ) + ğœ‚
, (33)

where the shear and bulk H-S bounds are recovered by choosing the values described in the following table.

Remark 5. Note that the derivative of the H-S bounds in both components can be rewritten as follows:

{
ğœ‡â€²LB(0) = ğœ‡0(ğœ‡1 âˆ’ ğœ‡0)qğœ‡0
ğœ‡â€²UB(1) = ğœ‡1(ğœ‡1 âˆ’ ğœ‡0)qğœ‡1

and

{
ğœ…â€²LB(0) = ğœ…0(ğœ…1 âˆ’ ğœ…0)qğœ…0
ğœ…â€²UB(1) = ğœ…1(ğœ…1 âˆ’ ğœ…0)qğœ…1.

(35)

In fact, this way of rewriting the H-S bounds derivative can be obtained after simple calculations. From
Equation (33), the generalized H-S bound can be rewritten as

ğ‘“HS(ğœŒ) =
ğ‘“0dHS0 (1 âˆ’ ğœŒ) + ğ‘“1d

HS
1 ğœŒ

dHS0 (1 âˆ’ ğœŒ) + d
HS
1 ğœŒ

with dHS0 =
(ğ‘“1 âˆ’ ğ‘“0)2

ğ‘“0 + ğœ‚
, dHS1 =

(ğ‘“1 âˆ’ ğ‘“0)2

ğ‘“1 + ğœ‚
, (36)

and consequently, the derivative of the generalized H-S bounds is expressed as

ğ‘“ â€²HS(ğœŒ) =
dHS0 d

HS
1 (ğ‘“1 âˆ’ ğ‘“0)[

dHS0 (1 âˆ’ ğœŒ) + d
HS
1 ğœŒ

]2 . (37)



368 FERRER

Thus, its value in the components is just

ğ‘“ â€²HS(0) =
dHS1
dHS0

(ğ‘“1 âˆ’ ğ‘“0) =
ğ‘“0 + ğœ‚
ğ‘“1 + ğœ‚

(ğ‘“1 âˆ’ ğ‘“0)

ğ‘“ â€²HS(1) =
dHS0
dHS1

(ğ‘“1 âˆ’ ğ‘“0) =
ğ‘“1 + ğœ‚
ğ‘“0 + ğœ‚

(ğ‘“1 âˆ’ ğ‘“0).
(38)

Inserting (34) into (37) and using definition of q in (20), the derivative of the H-S bounds for the shear modulus in Î©0
(ğœŒ = 0) and in Î©1 (ğœŒ = 1) are

ğœ‡â€²LB(0) =
(ğœ‡0 + ğœ‚ğœ‡0)(ğœ‡1 âˆ’ ğœ‡0)

ğœ‡1 + ğœ‚ğœ‡0
= âˆ’ğœ‡0(ğœ‡0 âˆ’ ğœ‡1)q(ğœ‡0, ğœ‡1, ğœ‚ğœ‡0) = ğœ‡0(ğœ‡1 âˆ’ ğœ‡0)qğœ‡0

ğœ‡â€²LB(1) =
(ğœ‡1 + ğœ‚ğœ‡0)(ğœ‡1 âˆ’ ğœ‡0)

ğœ‡0 + ğœ‚ğœ‡0
= ğœ‡1(ğœ‡1 âˆ’ ğœ‡0)q(ğœ‡1, ğœ‡0, ğœ‚ğœ‡0)

ğœ‡â€²UB(0) =
(ğœ‡0 + ğœ‚ğœ‡1)(ğœ‡1 âˆ’ ğœ‡0)

ğœ‡1 + ğœ‚ğœ‡1
= âˆ’ğœ‡0(ğœ‡0 âˆ’ ğœ‡1)q(ğœ‡0, ğœ‡1, ğœ‚ğœ‡1)

ğœ‡â€²UB(1) =
(ğœ‡1 + ğœ‚ğœ‡1)(ğœ‡1 âˆ’ ğœ‡0)

ğœ‡0 + ğœ‚ğœ‡1
= ğœ‡1(ğœ‡1 âˆ’ ğœ‡0)q(ğœ‡1, ğœ‡0, ğœ‚ğœ‡1) = ğœ‡1(ğœ‡1 âˆ’ ğœ‡0)qğœ‡1.

(39)

Similarly, the derivative of the H-S bounds for the bulk modulus in Î©0 (ğœŒ = 0) and in Î©1 (ğœŒ = 1) can be written as

ğœ…â€²LB(0) =
(ğœ…0 + ğœ‚ğœ…0)(ğœ…1 âˆ’ ğœ…0)

ğœ…1 + ğœ‚ğœ…0
= âˆ’ğœ…0(ğœ…0 âˆ’ ğœ…1)q(ğœ…0, ğœ…1, ğœ‚ğœ…0) = ğœ…0(ğœ…1 âˆ’ ğœ…0)qğœ…0

ğœ…â€²LB(1) =
(ğœ…1 + ğœ‚ğœ…0)(ğœ…1 âˆ’ ğœ…0)

ğœ…0 + ğœ‚ğœ…0
= ğœ…1(ğœ…1 âˆ’ ğœ…0)q(ğœ…1, ğœ…0, ğœ‚ğœ…0)

ğœ…â€²UB(0) =
(ğœ…0 + ğœ‚ğœ…1)(ğœ…1 âˆ’ ğœ…0)

ğœ…1 + ğœ‚ğœ…1
= âˆ’ğœ…0(ğœ…0 âˆ’ ğœ…1)q(ğœ…0, ğœ…1, ğœ‚ğœ…1)

ğœ…â€²UB(1) =
(ğœ…1 + ğœ‚ğœ…1)(ğœ…1 âˆ’ ğœ…0)

ğœ…0 + ğœ‚ğœ…1
= ğœ…1(ğœ…1 âˆ’ ğœ…0)q(ğœ…1, ğœ…0, ğœ‚ğœ…1) = ğœ…1(ğœ…1 âˆ’ ğœ…0)qğœ…1.

(40)

Topological derivative as H-S bounds derivative. This is one of the two main results of this work. Let us define
two material components with shear and bulk material properties ğœ‡0, ğœ…0 and ğœ‡1, ğœ…1, respectively, and let us propose an
interpolation function for modeling its mixture by means of its fraction volume ğœŒ = [0, 1] such that close to Î©0 coincides
with the H-S lower bound and close to Î©1 with the H-S upper bound. Then, the gradient of the compliance coincides with
the topological derivative in Î©0 and Î©1.

To see this result, from Equation (9), we can write the gradient of the compliance (when using the isotropic lower and
upper bound as interpolation function) as follows:

gLB(0) = âˆ’âˆ‡su âˆ¶ Câ€²LB(0) âˆ¶ âˆ‡
su with CLB(ğœŒ) = 2ğœ‡LB(ğœŒ)I + [ğœ…LB(ğœŒ) âˆ’ ğœ‡LB(ğœŒ)]I âŠ— I

gUB(1) = âˆ’âˆ‡su âˆ¶ Câ€²UB(1) âˆ¶ âˆ‡
su with CUB(ğœŒ) = 2ğœ‡UB(ğœŒ)I + [ğœ…UB(ğœŒ) âˆ’ ğœ‡UB(ğœŒ)]I âŠ— I.

(41)

Then, we can identify coefficients in (39) and (40) with precisely the ones established by the topological derivative in (29)
and (30), and thus, {

C
â€²
LB(0) = dC0 when xÌƒ âˆˆ Î©0

C
â€²
UB(1) = dC1 when xÌƒ âˆˆ Î©1.

(42)

Finally, using (42) in Equations (25), (27), and (9), we obtain

{
gLB(0) = gT0(xÌƒ) when xÌƒ âˆˆ Î©0
gUB(1) = gT1(xÌƒ) when xÌƒ âˆˆ Î©1.

(43)



FERRER 369

Remark 6. This result confirms that the material in the neighborhood of the infinitesimal inclusion inserted in the
perturbed domain used to compute the topological derivative can be understood as an homogenized microstructure
with circular inclusions (H-S bounds microstructures) with a fraction volume value equivalent to the infinitesimal
inclusion volume. This is to say that, in order to study a change on the compliance, the topological derivative concepts
proposes in fact to insert H-S microstructures.

5 RATIONAL FUNCTIONS

Definition 3. Let us introduce the following particular family of rational functions:

îˆ¾ =
{
ğ‘“ âˆˆ Câˆ([0, 1], [ğ‘“0, ğ‘“1]) | ğ‘“ (ğœŒ) = AğœŒ2 + BğœŒ + CDğœŒ + 1

}
, (44)

where A, B, C, and D â‰  âˆ’1 are scalar parameters to be determined by fixing the value and its derivative in the extremes,
ie,

ğ‘“ (0) = ğ‘“0, ğ‘“ â€²(0) =
.
ğ‘“ 0, ğ‘“ (1) = ğ‘“1, and ğ‘“

â€²(1) =
.
ğ‘“ 1. (45)

Remark 7. Note that function ğ‘“ âˆˆ îˆ¾ is equivalent to the following expression:

ğ‘“ (ğœŒ) =
d01(1 âˆ’ ğœŒ)ğœŒ + ğ‘“0d0(1 âˆ’ ğœŒ) + ğ‘“1d1ğœŒ

d0(1 âˆ’ ğœŒ) + d1ğœŒ
with

â§âªâ¨âªâ©
d01 =

.
ğ‘“ 1

.
ğ‘“ 0 âˆ’ (ğ‘“1 âˆ’ ğ‘“0)2

d0 =
.
ğ‘“ 1 âˆ’ (ğ‘“1 âˆ’ ğ‘“0)

d1 = (ğ‘“1 âˆ’ ğ‘“0) âˆ’
.
ğ‘“ 0.

(46)

This result is easily obtained by computing the derivative of the rational function as

ğ‘“ â€²(ğœŒ) =
ADğœŒ2 + 2AğœŒ + (B âˆ’ CD)

(DğœŒ + 1)2
(47)

and imposing conditions (45). Then, we can solve the system of four equations to find the value of the parameters A, B,
C, and D. This is

A =
âˆ’

.
ğ‘“ 1

.
ğ‘“ 0 + (ğ‘“1 âˆ’ ğ‘“0)2

.
ğ‘“ 1 + (ğ‘“1 âˆ’ ğ‘“0)

, B =
2ğ‘“0(ğ‘“1 âˆ’ ğ‘“0) +

.
ğ‘“ 1

.
ğ‘“ 0 âˆ’ ğ‘“1

.
ğ‘“ 0 âˆ’

.
ğ‘“ 1ğ‘“0

.
ğ‘“ 1 + (ğ‘“1 âˆ’ ğ‘“0)

, C = ğ‘“0, and D =
2(ğ‘“1 âˆ’ ğ‘“0) âˆ’ (

.
ğ‘“ 1 +

.
ğ‘“ 0)

.
ğ‘“ 1 + (ğ‘“1 âˆ’ ğ‘“0)

. (48)

Remark 8. Note that, with the definitions above, the following property holds: d01 = (f1 âˆ’ f0)(d0 âˆ’ d1) âˆ’ d0d1.

Remark 9. The generalized H-S bounds and therefore the upper and lower bounds of the shear and bulk modulus are
rational functions. This can be easily seen by imposing

d01 = 0, d0 = dHS0 =
(ğ‘“1 âˆ’ ğ‘“0)2

ğ‘“0 + ğœ‚
, and d1 = dHS1 =

(ğ‘“1 âˆ’ ğ‘“0)2

ğ‘“1 + ğœ‚
(49)

in the general rational Equation (46) and obtaining

ğ‘“HS(ğœŒ) =
ğ‘“0dHS0 (1 âˆ’ ğœŒ) + ğ‘“1d

HS
1 ğœŒ

dHS0 (1 âˆ’ ğœŒ) + d
HS
1 ğœŒ

, (50)

which is precisely the generalized H-S equation (33).



370 FERRER

6 SIMP-ALL METHOD

The idea of the SIMP-ALL method is precisely to propose an interpolation such that the gradient of the compliance
coincides with the topological derivative in both Î©0 and Î©1. As already shown in Equation (43), in the case of isotropic
materials, this is equivalent to impose the derivative of the H-S lower bound in Î©0 and the derivative of the H-S upper
bound in Î©1 for the shear and bulk modulus interpolations.

Definition 4. The SIMP-ALL function fSA(ğœŒ) is defined as a rational functionîˆ¾with the H-S bound derivatives (lower
in ğœŒ = 0 and upper in ğœŒ = 1) as derivative parameters

.
ğ‘“0 and

.
ğ‘“1. This is

.
ğ‘“0 = ğ‘“ â€²HS(0) =

ğ‘“0 + ğœ‚0
ğ‘“1 + ğœ‚0

(ğ‘“1 âˆ’ ğ‘“0) and
.
ğ‘“1 = ğ‘“ â€²HS(1) =

ğ‘“1 + ğœ‚1
ğ‘“0 + ğœ‚1

(ğ‘“1 âˆ’ ğ‘“0). (51)

Remark 10. Note that the shear and bulk SIMP-ALL interpolation function ğœ‡SA(ğœŒ) and ğœ…SA(ğœŒ) can be rewritten in the
following compact form:

ğœ‡SA(ğœŒ) =
(ğœ‡1 âˆ’ ğœ‡0)(ğœ‚ğœ‡0 âˆ’ ğœ‚ğœ‡1)(1 âˆ’ ğœŒ)ğœŒ + ğœ‡0(ğœ‡1 + ğœ‚ğœ‡0 )(1 âˆ’ ğœŒ) + ğœ‡1(ğœ‡0 + ğœ‚ğœ‡1)ğœŒ

(ğœ‡1 + ğœ‚ğœ‡0)(1 âˆ’ ğœŒ) + (ğœ‡0 + ğœ‚ğœ‡1)ğœŒ

ğœ…SA(ğœŒ) =
(ğœ…1 âˆ’ ğœ…0)(ğœ‚ğœ…0 âˆ’ ğœ‚ğœ…1)(1 âˆ’ ğœŒ)ğœŒ + ğœ…0(ğœ…1 + ğœ‚ğœ…0)(1 âˆ’ ğœŒ) + ğœ…1(ğœ…0 + ğœ‚ğœ…1 )ğœŒ

(ğœ…1 + ğœ‚ğœ…0)(1 âˆ’ ğœŒ) + (ğœ…0 + ğœ‚ğœ…1)ğœŒ
,

(52)

where ğœ‚ğœ‡0 =
ğœ…0ğœ‡0

2ğœ‡0+ğœ…0
, ğœ‚ğœ‡1 =

ğœ…1ğœ‡1
2ğœ‡1+ğœ…1

, ğœ‚ğœ…0 = ğœ‡0, and ğœ‚ğœ…1 = ğœ‡1 were previously defined in (34).

These expressions can be easily obtained by computing the rational function parameters d01, d0, and d1 defined in
Equation (46). In the case of the SIMP-ALL interpolation, they can be written as

dSA01 =
.
ğ‘“ 1

.
ğ‘“ 0 âˆ’ (ğ‘“1 âˆ’ ğ‘“0)

2 = (ğ‘“1 âˆ’ ğ‘“0)2
(
ğ‘“0 + ğœ‚0
ğ‘“1 + ğœ‚0

ğ‘“1 + ğœ‚1
ğ‘“0 + ğœ‚1

âˆ’ 1
)

=
(ğ‘“1 âˆ’ ğ‘“0)3(ğœ‚0 âˆ’ ğœ‚1)
(ğ‘“0 + ğœ‚1)(ğ‘“1 + ğœ‚0)

dSA0 =
.
ğ‘“ 1 âˆ’ (ğ‘“1 âˆ’ ğ‘“0) = (ğ‘“1 âˆ’ ğ‘“0)

(
ğ‘“1 + ğœ‚1
ğ‘“0 + ğœ‚1

âˆ’ 1
)

=
(ğ‘“1 âˆ’ ğ‘“0)2

ğ‘“0 + ğœ‚1

dSA1 = (ğ‘“1 âˆ’ ğ‘“0) âˆ’
.
ğ‘“ 0 = (ğ‘“1 âˆ’ ğ‘“0)

(
1 âˆ’

ğ‘“0 + ğœ‚0
ğ‘“1 + ğœ‚0

)
=

(ğ‘“1 âˆ’ ğ‘“0)2

ğ‘“1 + ğœ‚0
.

(53)

These parameters let us build the SIMP-ALL general interpolation function f SA(ğœŒ) as

ğ‘“SA(ğœŒ) =
dSA01 (1 âˆ’ ğœŒ)ğœŒ + ğ‘“0d

SA
0 (1 âˆ’ ğœŒ) + ğ‘“1d

SA
1 ğœŒ

dSA0 (1 âˆ’ ğœŒ) + d
SA
1 ğœŒ

=
(ğ‘“1 âˆ’ ğ‘“0)(ğœ‚0 âˆ’ ğœ‚1)(1 âˆ’ ğœŒ)ğœŒ + ğ‘“0(ğ‘“1 + ğœ‚0)(1 âˆ’ ğœŒ) + ğ‘“1(ğ‘“0 + ğœ‚1)ğœŒ

(ğ‘“1 + ğœ‚0)(1 âˆ’ ğœŒ) + (ğ‘“0 + ğœ‚1)ğœŒ
,

(54)

where the last expression is obtained multiplying the upper and lower parts of the fraction by (ğ‘“0+ğœ‚1)(ğ‘“1+ğœ‚0)
(ğ‘“1âˆ’ğ‘“0)2

. Finally, we
have to take the corresponding f0, f1, ğœ‚0, and ğœ‚1 parameters values for the case of the shear and bulk modulus.

Difference of two rational functions. Let ğ‘“A âˆˆ îˆ¾ and ğ‘“B âˆˆ îˆ¾ be two rational functions such that ğ‘“ â€²B(0) â‰¤ ğ‘“ â€²A(0),
ğ‘“ â€²A(1) â‰¤ ğ‘“ â€²B(1), fA(0) = fB(0), and fA(1) = fB(1) for all ğœŒ âˆˆ [0, 1]. Then,

ğ‘“A(ğœŒ) â‰¥ ğ‘“B(ğœŒ) âˆ€ğœŒ âˆˆ [0, 1]. (55)



FERRER 371

To obtain this result, we will show in four steps that the difference of fA and fB is positive âˆ€ğœŒ âˆˆ [0, 1].

(i) Computing the difference function. Let us compute the function fC as the difference of the two rational functions
fA and fB. This is

ğ‘“C(ğœŒ) = ğ‘“A(ğœŒ) âˆ’ ğ‘“B(ğœŒ) =
nC(ğœŒ)
dC(ğœŒ)

, (56)

where the numerator nC(ğœŒ) is written as

nC(ğœŒ) = nA(ğœŒ)dB(ğœŒ) âˆ’ nB(ğœŒ)dA(ğœŒ) with

{
nA(ğœŒ) = dA01(1 âˆ’ ğœŒ)ğœŒ + ğ‘“0d

A
0 (1 âˆ’ ğœŒ) + ğ‘“1d

A
1 ğœŒ

nB(ğœŒ) = dB01(1 âˆ’ ğœŒ)ğœŒ + ğ‘“0d
B
0 (1 âˆ’ ğœŒ) + ğ‘“1d

B
1ğœŒ

(57)

and the denominator dC(ğœŒ) as

dC(ğœŒ) = dA(ğœŒ)dB(ğœŒ) with

{
dA(ğœŒ) = dA0 (1 âˆ’ ğœŒ) + d

A
1 ğœŒ

dB(ğœŒ) = dB0 (1 âˆ’ ğœŒ) + d
B
1ğœŒ.

(58)

(ii) Computing the difference function numerator. For sake of compactness, we write the numerator in matrix
form as

nC(ğœŒ) =
[
(1 âˆ’ ğœŒ)ğœŒ (1 âˆ’ ğœŒ) ğœŒ

] â›âœâœâ
â¡â¢â¢â£

dA01
ğ‘“0dA0
ğ‘“1dA1

â¤â¥â¥â¦
[

dB0 d
B
1
]
âˆ’
â¡â¢â¢â£

dB01
ğ‘“0dB0
ğ‘“1dB1

â¤â¥â¥â¦
[

dA0 d
A
1
]ââŸâŸâ 
[
(1 âˆ’ ğœŒ)

ğœŒ

]
=

=
[
(1 âˆ’ ğœŒ)ğœŒ (1 âˆ’ ğœŒ) ğœŒ

] â¡â¢â¢â¢â£
dA01d

B
0 âˆ’ d

B
01d

A
0 d

A
01d

B
0 âˆ’ d

B
01d

A
0

ğ‘“0dA0 d
B
0 âˆ’ ğ‘“0d

B
0 d

A
0 ğ‘“0d

A
0 d

B
1 âˆ’ ğ‘“0d

B
0 d

A
1

ğ‘“1dA1 d
B
0 âˆ’ ğ‘“1d

B
1 d

A
0 ğ‘“1d

A
01d

B
0 âˆ’ ğ‘“1d

B
01d

A
0

â¤â¥â¥â¥â¦
[
(1 âˆ’ ğœŒ)

ğœŒ

]
=

=
[
(1 âˆ’ ğœŒ)ğœŒ (1 âˆ’ ğœŒ) ğœŒ

] [N11 N12
0 N22

N31 0

][
(1 âˆ’ ğœŒ)

ğœŒ

]
=

= (1 âˆ’ ğœŒ)2ğœŒN11 + (1 âˆ’ ğœŒ)ğœŒ2N12 + (1 âˆ’ ğœŒ)ğœŒN22 + ğœŒ(1 âˆ’ ğœŒ)N31 =

= (1 âˆ’ ğœŒ)ğœŒ
[
(1 âˆ’ ğœŒ)N11 + ğœŒN12 + N22 + N31

]
= (1 âˆ’ ğœŒ)ğœŒ

[
(1 âˆ’ ğœŒ)(N11 + N22 + N31) + ğœŒ(N12 + N22 + N31)

]
= (1 âˆ’ ğœŒ)ğœŒ

[
(1 âˆ’ ğœŒ)c0 + ğœŒc1

]
,

(59)

where c0 = N11 + N22 + N31 and c1 = N12 + N22 + N31. Note that, from Remark 8, N11, N12, N22, and N31 can be
written as

N11 =
[
(ğ‘“1 âˆ’ ğ‘“0)

(
dA0 âˆ’ d

A
1
)
âˆ’ dA0 d

A
1
]

dB0 âˆ’
[
(ğ‘“1 âˆ’ ğ‘“0)

(
dB0 âˆ’ d

B
1
)
âˆ’ dB0 d

B
1
]

dA0 =

= âˆ’(ğ‘“1 âˆ’ ğ‘“0)
(

dB0 d
A
1 âˆ’ d

B
1 d

A
0
)
+
(

dB1 âˆ’ d
A
1
)

dA0 d
B
0

N12 =
[
(ğ‘“1 âˆ’ ğ‘“0)

(
dA0 âˆ’ d

A
1
)
âˆ’ dA0 d

A
1
]

dB1 âˆ’
[
(ğ‘“1 âˆ’ ğ‘“0)

(
dB0 âˆ’ d

B
1
)
âˆ’ dB0 d

B
1
]

dA1 =

= âˆ’(ğ‘“1 âˆ’ ğ‘“0)
(

dB0 d
A
1 âˆ’ d

B
1 d

A
0
)
+
(

dB0 âˆ’ d
A
0
)

dA1 d
B
1

N22 = âˆ’ğ‘“0
(

dB0 d
A
1 âˆ’ d

B
1 d

A
0
)

N31 = âˆ’ğ‘“1
(

dB0 d
A
1 âˆ’ d

B
1 d

A
0
)
.

(60)

and the sum of N22 and N31 as N22 + N31 = (ğ‘“1 âˆ’ ğ‘“0)(dB0 d
A
1 âˆ’ d

B
1 d

A
0 ). Thus, we can write coefficients c0 and c1 in a

simplified form as
c0 =

(
dB1 âˆ’ d

A
1
)

dA0 d
B
0 ,

c1 =
(

dB0 âˆ’ d
A
0
)

dA1 d
B
1 .

(61)



372 FERRER

(iii) Computing the difference function denominator. From Equation (58), this is simply

dC(ğœŒ) =
[
dA0 (1 âˆ’ ğœŒ) + d

A
1 ğœŒ
] [

dB0 (1 âˆ’ ğœŒ) + d
B
1ğœŒ
]
. (62)

(iv) Positiveness of the difference for all possible scenarios. The idea is now to analyze if the numerator and the
denominator of the difference have always the same sign in all possible cases. First, note that, since ğ‘“A âˆˆ îˆ¾ and
ğ‘“B âˆˆ îˆ¾, their image should not be unbounded (should be between [f0, f1]). Thus, from (62), we see that the following
two scenarios are only possible:

d0, d1 > 0 or d0, d1 < 0. (63)

Then, the assumptions of ğ‘“ â€²B(0) â‰¤ ğ‘“ â€²A(0) and ğ‘“ â€²A(1) â‰¤ ğ‘“ â€²B(1) entail the following inequalities:

ğ‘“ â€²B(0) âˆ’ ğ‘“
â€²
A(0) =

[
(ğ‘“1 âˆ’ ğ‘“0) âˆ’ dB1

]
âˆ’
[
(ğ‘“1 âˆ’ ğ‘“0) âˆ’ dA1

]
= dA1 âˆ’ d

B
1 â‰¤ 0 =â‡’ dB1 â‰¥ dA1

ğ‘“ â€²A(1) âˆ’ ğ‘“
â€²
B(0) =

[
(ğ‘“1 âˆ’ ğ‘“0) + dA0

]
âˆ’
[
(ğ‘“1 âˆ’ ğ‘“0) + dB0

]
= dA0 âˆ’ d

B
0 â‰¤ 0 =â‡’ dB0 â‰¥ dA0 .

(64)

In view of (64), we summarize all the possible scenarios in the following table.

In the table, Cases 1, 2, and 3 are the only possible cases that makes fA and fB satisfy condition (63), and consequently,
the rest of cases are not included. Thus, we can guarantee positiveness of function fC reasoning as follows:

Case 1:

{
c1, c0 > 0 =â‡’ nC(ğœŒ) > 0
dA(ğœŒ) > 0, dB(ğœŒ) > 0 =â‡’ dC(ğœŒ) > 0

=â‡’ ğ‘“C(ğœŒ) > 0 âˆ€ğœŒ âˆˆ [0, 1]

Case 2:

{
c1, c0 < 0 =â‡’ nC(ğœŒ) < 0
dA(ğœŒ) < 0, dB(ğœŒ) > 0 =â‡’ dC(ğœŒ) < 0

=â‡’ ğ‘“C(ğœŒ) > 0 âˆ€ğœŒ âˆˆ [0, 1]

Case 3:

{
c1, c0 > 0 =â‡’ nC(ğœŒ) > 0
dA(ğœŒ) > 0, dB(ğœŒ) < 0 =â‡’ dC(ğœŒ) > 0

=â‡’ ğ‘“C(ğœŒ) > 0 âˆ€ğœŒ âˆˆ [0, 1].

(66)

Remark 11. Based on the results shown above, although it may be obvious, we could show that the H-S upper bound
is above the H-S lower bound. Indeed,

ğ‘“ â€²UB(0) âˆ’ ğ‘“
â€²
LB(0) =

ğ‘“0 + ğœ‚1
ğ‘“1 + ğœ‚1

(ğ‘“1 âˆ’ ğ‘“0) âˆ’
ğ‘“0 + ğœ‚0
ğ‘“1 + ğœ‚0

(ğ‘“1 âˆ’ ğ‘“0) =
(ğ‘“1 âˆ’ ğ‘“0)2(ğœ‚1 âˆ’ ğœ‚0)
(ğ‘“1 + ğœ‚0)(ğ‘“1 + ğœ‚0)

â‰¥ 0 (67)

ğ‘“ â€²LB(1) âˆ’ ğ‘“
â€²
UB(1) =

ğ‘“1 + ğœ‚0
ğ‘“0 + ğœ‚0

(ğ‘“1 âˆ’ ğ‘“0) âˆ’
ğ‘“1 + ğœ‚1
ğ‘“0 + ğœ‚1

(ğ‘“1 âˆ’ ğ‘“0) =
(ğ‘“1 âˆ’ ğ‘“0)2(ğœ‚1 âˆ’ ğœ‚0)
(ğ‘“0 + ğœ‚0)(ğ‘“0 + ğœ‚0)

â‰¥ 0, (68)

where we have used f1, f0 â‰¥ 0 for coercivity reasons and ğœ‚1 â‰¥ 0, ğœ‚0 â‰¥ 0 is fulfilled by definition from table (34)
for both the shear and the bulk modulus. Thus, as expected, the H-S bound for both the shear and bulk modulus is
always above the H-S lower bound. This is

ğœ‡UB(ğœŒ) â‰¥ ğœ‡LB(ğœŒ) and ğœ…UB(ğœŒ) â‰¥ ğœ…LB(ğœŒ) âˆ€ğœŒ âˆˆ [0, 1]. (69)



FERRER 373

SIMP-ALL in between H-S bounds. At this point, we can show that the SIMP-ALL interpolation for the bulk and
shear modulus rest always between the H-S bounds, this is

ğœ‡UB(ğœŒ) â‰¥ ğœ‡SA(ğœŒ) â‰¥ ğœ‡LB(ğœŒ) and ğœ…UB(ğœŒ) â‰¥ ğœ…SA(ğœŒ) â‰¥ ğœ…LB(ğœŒ) âˆ€ğœŒ âˆˆ [0, 1]. (70)

This result is certainly the second main contribution of this work. To show it, we only have to verify the conditions stated
before Equation (55). In fact, the H-S upper bound and the SIMP-ALL interpolation function fulfills by construction

ğ‘“ â€²UB(0) âˆ’ ğ‘“
â€²
SA(0) = ğ‘“

â€²
UB(0) âˆ’ ğ‘“

â€²
LB(0) â‰¥ 0 and ğ‘“ â€²SA(1) âˆ’ ğ‘“ â€²UB(1) = 0. (71)

Condition ğ‘“ â€²UB(0) âˆ’ ğ‘“
â€²
LB(0) â‰¥ 0 has been already shown in (67). We can proceed similarly for the H-S lower bound. By

construction,

ğ‘“ â€²SA(0) âˆ’ ğ‘“
â€²
LB(0) = 0 and ğ‘“

â€²
SA(1) âˆ’ ğ‘“

â€²
UB(1) = ğ‘“

â€²
LB(1) âˆ’ ğ‘“

â€²
UB(1) â‰¥ 0, (72)

and condition ğ‘“ â€²SA(1) âˆ’ ğ‘“
â€²
UB(1) = ğ‘“

â€²
LB(1) âˆ’ ğ‘“

â€²
UB(1) â‰¥ 0 has been also already proven in (67).

7 COMPARISON BETWEEN SIMP AND SIMP-ALL

The celebrated SIMP interpolation function19 proposes basically to combine the property of both materials as follows:

C(ğœŒ) = (1 âˆ’ ğœŒp)C0 + ğœŒpC1, (73)

where p is the penalization parameter, frequently taken as p = 3.

7.1 Interpolation function comparison
We seek in this section to compare both interpolations in the following two different situations.

(a) Material-void interpolation
In regularized topology optimization, the material of the domain (base material) is usually interpolated with a void
material, modeled with an extremely weak material. As discussed in the work of BendsÃ¸e and Sigmund,2 standard
SIMP proposes an isotropic interpolation, which its corresponding intermediate values (gray) cannot be interpreted
in some situations as a composite material composed by the base material and the void material (the interpola-
tion function remains outside the H-S bounds). To circumvent this limitation, an adaptive value of the penalization
parameter (in terms of the Poisson ratio value of the base material ğœˆ1) is proposed in the aforementioned work2 for
two-dimensional plane stress cases by changing the penalization parameter as follows:

p â‰¥ pâˆ—(ğœˆ1) = max
(

2
1 âˆ’ ğœˆ1

,
4

1 + ğœˆ1

)
. (74)

With this adaptation of the penalization parameter, the SIMP method remains in between the H-S bounds when
ğœ‡0 â†’ 0 and ğœ…0 â†’ 0. In the following, we will call this interpolation choice as adaptive SIMP. For comparing SIMP,
SIMP-ALL, and adaptive SIMP, in this work, we have proposed a sequence of composite materials composed by an
isotropic base material with properties (E1 = 1, ğœˆ1 âˆˆ {1âˆ•3, 0,âˆ’0.5,âˆ’0.75,âˆ’0.9}) and a void material with properties
(E0 = 10âˆ’3, ğœˆ0 = 1âˆ•3). Note that the value of ğœˆ0 when E0 â†’ 0 has no relevance.
The SIMP, adaptive SIMP, and SIMP-ALL interpolation function have been depicted in Figure 2 in relation with
the shear and bulk H-S bounds. In view of the results, when the Poisson ratio is ğœˆ = 1âˆ•3, the three interpolations
behave similarly. In fact, SIMP adaptive and SIMP coincides since pâˆ—(1âˆ•3) = 3. Additionally, both the SIMP and the



374 FERRER

0 0.5 1
Density

0

0.1

0.2

0.3

0.4
Shear modulus

0 0.5 1
Density

0

0.2

0.4

0.6

0.8
Bulk modulus

0 0.5 1
Density

0

2

4

6
Shear modulus

0 0.5 1
Density

0

0.5

1

1.5

2

2.5
Shear modulus

0 0.5 1
Density

0

0.2

0.4

0.6

0.8

1
Shear modulus

0 0.5 1
Density

0

0.1

0.2

0.3
Bulk modulus

0 0.5 1
Density

0

0.1

0.2

0.3
Bulk modulus

0 0.5 1
Density

0

0.1

0.2

0.3

0.4
Bulk modulus

0 0.5 1
Density

0

0.1

0.2

0.3

0.4

0.5
Shear modulus

0 0.5 1
0

0.2

0.4

0.6
Bulk modulus

Density

FIGURE 2 Shear and bulk interpolation function comparison when interpolating void material (E0 = 10âˆ’3, ğœˆ0 = 1âˆ•3) with a sequence of
stiff materials (E1 = 1 and ğœˆ1 decreasing). In contrast with SIMP, SIMP adaptive, and SIMP-ALL interpolations remain in between H-S bounds

SIMP-ALL interpolation function take the H-S bounds derivative values in the extreme values (the lower bound in
ğœŒ = 0 and the upper bound in ğœŒ = 1). The former coincidence is proved in the work of BendsÃ¸e and Sigmund19 while
the latter is obtained by construction. In this case, both interpolation remain in between the H-S bounds. However,
as soon as ğœˆ1 decreases, SIMP, SIMP adaptive, and SIMP-ALL start differing. In fact, SIMP-ALL and SIMP adaptive
interpolation function, in contrast with SIMP, remain in between H-S bounds as expected. Additionally, note that
as soon as ğœˆ1 decreases, eg, ğœˆ1 = âˆ’0.9, pâˆ— = 40 (Case (E)), the adaptive SIMP interpolation, in comparison with
the SIMP-ALL interpolation, increases extremely markedly resulting in possible limitations when solving topology
optimization problems.

(b) Bimaterial interpolation
For a more general case, when the weak material is not necessary much less stiff than the base material, the topology
optimization problem is in fact a bimaterial optimization problem. The aim is to decide in which part of Î© is appro-
priate to use one material or the other, or in case of â€œgrays,â€ a combination of both. Two different cases have been
presented. The first one (Case (A)) seeks to model an Steel-Aluminum composite. In this sense, the material proper-
ties have been taken as E0 = 1âˆ•3, ğœˆ0 = 0.35, E1 = 1, and ğœˆ1 = 0.3. The second example (Case (B)) intends to model
an extreme case where one material has larger bulk modulus value and the other material has larger shear modulus
value. To this aim, the material properties considered are E0 = 0.9, ğœˆ0 = âˆ’0.9, E1 = 1, and ğœˆ1 = 0.3.



FERRER 375

0 0.5 1
Density

0.2

0.4

0.6

0.8
Bulk modulus

0 0.5 1
Density

0.2

0.4

0.6

0.8
Bulk modulus

0 0.5 1
Density

0

1

2

3

4

5
Shear modulus

0 0.5 1
Density

0.1

0.2

0.3

0.4
Shear modulus

FIGURE 3 Interpolation function comparison when interpolating two real materials. SIMP adaptive interpolation is not even defined. In
contrast with SIMP, SIMP-ALL remains in between H-S bounds despite both bounds are really close

In the bimaterial problem, the value of the penalization parameter p for the SIMP interpolation function is unclear.
In the following, we take a penalization parameter of value p = 3. The SIMP adaptive method is even not defined. The
corresponding H-S bounds, SIMP, and SIMP-ALL method have been depicted in Figure 3. As expected, in both cases
(A and B), SIMP function falls outside H-S bounds. However, although the space between H-S bounds is significantly
narrow, the SIMP-ALL interpolation function comes to lie inside them, as stated in Equation (70). Thus, the use of
SIMP-ALL interpolation seems as convenient as the SIMP interpolation for ğœˆ1 â‰ƒ 1âˆ•3 and more convenient (from the
physical point of view) for different values of ğœˆ1 and when solving bimaterial problems.

7.2 Numerical examples comparison
In order to see the numerical effects of using different kind of interpolation functions, a cantilever beam example has
been solved for the sequence of Cases described in Figure 2. The size of the domain is 2Ã— 1 with the left side clamped. A
distributed vertical force of unit value is applied in a 0.2 centered part of the right side. The domain is equipped with a
structured triangular mesh of 20 000 elements from a Cartesian grid by splitting each cell into four triangles. The density
function is approximated with P1 Lagrangian finite element functions21 and the following filter is applied to the density
function:

ğœŒk =

âˆ‘
iâˆˆSk

âˆ«Î©NiNğ‘—ğœŒğ‘—âˆ‘
iâˆˆSk

âˆ«Î©Ni
, (75)

where ğœŒk is the density value in element k and Sk is the set of nodes of element k, see the work of Amstutz et al22 for
further details. This filter is defined in a discrete sense, in terms of the shape functions. Other filters depending on the
distance are also possible.

We consider the compliance as the cost function and the volume (volume target of the stiff material V = 0.5) as a
constraint of the topology optimization problem. Additionally, we consider the MMA algorithm,23 widely used in the
community, to solve the problem with a stopping criteria tolerance of 10âˆ’4 and a maximum number of iterations of nmax =
5000. The design variable is initialized with stiff material overall the domain (ğœŒ = 1).

As depicted in Figure 4, we observe similar optimal topologies regardless the interpolation used when the Poisson
ratio of the stiff material is closed to ğœˆ1 = 1âˆ•3. Additionally, the number of iterations and the finite-element solver eval-
uation are also similar. The examples are computed in MATLABÂ© with a standard PC (3.40 GHz processor in a 64-bit
architecture). However, some differences appear when ğœˆ1 becomes smaller. The optimal topologies when using the SIMP
interpolation require large number of iterations and finite-element solver evaluations to converge and gray areas appear.
This is probably due to a small penalization value appeared in that cases (see Figure 2). In the case of SIMP adaptive,
in which the penalization value is rather large, although it seems to be almost free of numerical instabilities, nonstan-
dard topologies appear. Likewise, a significant computational effort in terms of iterations is required to converge. In
contrast, the SIMP-ALL interpolation behaves as adequately in terms of optimal topology and computational effort as



376 FERRER

FIGURE 4 Cantilever beam example for a sequence of different material-void interpolations using different interpolation functions. For
standard isotropic materials (ğœˆ1 = 1âˆ•3), all interpolations behave similarly. As ğœˆ1 becomes more negative, gray areas appear when using SIMP
and a larger number of convergence iterations are needed. Adaptive SIMP is presents no large gray areas but a noncompetitive cost function
and a larger number of convergence iterations appear. SIMP-ALL interpolation presents no gray areas, the number of iterations remains
small, and the objective function achieves considerable smaller values. In comparison with SIMP, the SIMP-ALL method evidences an
auto-penalizing effect in a wider range of cases [Colour figure can be viewed at wileyonlinelibrary.com]

when considering standard Poisson ratio values, typically ğœˆ = 1âˆ•3. In Case (C), the SIMP method did not converge.
Note that, comparing cost values between interpolation could be fuzzy, since in gray areas, each interpolation proposes
different stiffness values. In some cases, SIMP interpolation may propose values stiffer than physically possible (out of
H-S bounds). To have a stiffness comparison with physical sense, the cost of the optimal topologies obtained by the
three interpolations have been evaluated using the SIMP-ALL interpolation (JSA). The value of the cost (compliance)
shown in Figure 4 is normalized with the value of the cost in the initial guess. Admittedly, using the SIMP-ALL inter-
polation, a decrease in the cost in Case (E) of 35% is obtained when comparing with the SIMP interpolation and of
30% when comparing with the SIMP adaptive interpolation. This result shows the convenience of using the SIMP-ALL
interpolation when extreme isotropic materials (see, for example, the work of Greaves et al24) or bimaterial problems
are considered.

Finally, the gray areas appearing in the SIMP method is probably because intermediate values with this interpolation
are competitive, as seen in Figure 2. Large stiffness values (more than physically possible) are provided for intermediate
values. In this case, SIMP behaves not as an auto-penalizing interpolation function. In contrast, SIMP-ALL seems to
be auto-penalizing in all the cases. This is not thoroughly surprising since, as shown in Equation (43), the topological
derivative (used in the SIMP-ALL interpolation) proposes in fact to insert H-S microstructures near the extreme values.
Thus, the possibility of adding a certain amount of density (or inserting certain stiffer inclusions) is not competitive
since they provide small stiffness increment. Intuitively, microstructure made of weak material with a small number of
circular inclusion transmits barely the load, making it, in general, not attractive from the optimization point of view. This
may explain why the proposed SIMP-ALL interpolation, in contrast with SIMP, evidences in the results of Figure 4 an
auto-penalizing behavior for all the studied cases.

http://wileyonlinelibrary.com


FERRER 377

8 CONCLUSIONS

The main contributions of this work can be summarized in the following four points.
First, we have showed in Equation (43) that the topological derivative of the compliance is precisely the linear approx-

imation of the H-S bound (lower bound for the weak and upper bound for stiff material). In other words, using the
topological derivative for the compliance is equivalent to inserting H-S bound microstructures (circular inclusions). This
result strongly relates both concepts and allow us to give a new interpretation of the topological derivative.

Second, we have proposed the SIMP-ALL method, a new interpolation function for the shear and bulk modulus. It
is defined as a rational function and build so that its derivative coincides with the H-S lower bound derivative in the
weak material and the H-S upper bound derivative in the stiff material, making the gradient coincide, as shown in (43),
with the topological derivative in the stiff and the weak material. The key point of the SIMP-ALL interpolation is that in
Equation (70), we have shown that it stays always in between the H-S bound regardless the materials to be interpolated,
allowing us to interpret its intermediate values always as real microstructures.

Third, we have compared the SIMP-ALL with the SIMP and SIMP adaptive interpolation function. We have observed
similar behavior when ğœˆ1 is closed to 1âˆ•3 and quite different behavior as it becomes smaller. In contrast with SIMP, the
SIMP-ALL interpolation has shown to stay in between the H-S bounds, numerically verifying the result of Equation (70),
not only in the case of weak-stiff material but also in the more challenging case of interpolating two general isotropic
materials.

Finally, concerning numerical examples, we observed also similar behavior of the optimal topologies around ğœˆ = 1âˆ•3.
However, as it becomes smaller, the SIMP-ALL method has shown to obtain up to 20% stiffer topologies, free of gray areas
and smaller computational cost. In comparison with SIMP, this result shows that the SIMP-ALL method is auto-penalizing
in a wider range of cases.

From the author's point of view, rather than an alternative, the SIMP-ALL interpolation method can be under-
stood as a generalization of the SIMP method, adequate for all kind of interpolation materials, with physical meaning,
free of heuristic parameters, and with no extra computational effort. In this sense, SIMP-ALL interpolation bridge
also the gap between the topological derivative community and the SIMP community, allowing the first to use reg-
ularized algorithms and the second to use the topological derivative concept. A MATLAB implementation of the
SIMP-ALL interpolation is available at https://github.com/FerrerFerreAlex/SimpALL and has been also provided in the
Appendix.

ACKNOWLEDGEMENTS

The research leading to these results has received funding from the European Union's Horizon 2020 research and inno-
vation programme under the Marie SkÅ‚odowska-Curie grant agreement no. 712949 (TECNIOspring PLUS) and from the
Agency for Business Competitiveness of the Government of Catalonia. We thank Dr Samuel Amstutz for assistance with
developing the methodology, for helping on deeply understand the topic and for the comments that greatly improved the
manuscript.

ORCID

A. Ferrer https://orcid.org/0000-0003-1011-0230

REFERENCES
1. Pedersen CBW, Allinger P. Industrial implementation and applications of topology optimization and future needs. In: BendsÃ¸e MP,

Olhoff N, Sigmund O, eds. IUTAM Symposium on Topological Design Optimization of Structures, Machines and Materials. Dordrecht, The
Netherlands: Springer; 2006:229-238.

2. BendsÃ¸e MP, Sigmund O. Material interpolation schemes in topology optimization. Arch Appl Mech. 1999;69(9):635-654. https://doi.org/
10.1007/s004190050248

3. Wang F, Lazarov BS, Sigmund O. On projection methods, convergence and robust formulations in topology optimization. Struct Multidiscip
Optim. 2011;43(6):767-784. https://doi.org/10.1007/s00158-010-0602-y

4. Stolpe M, Svanberg K. An alternative interpolation scheme for minimum compliance topology optimization. Struct Multidiscip Optim.
2001;22:116-124.

https://github.com/FerrerFerreAlex/SimpALL
https://orcid.org/0000-0003-1011-0230
https://orcid.org/0000-0003-1011-0230
https://doi.org/10.1007/s004190050248
https://doi.org/10.1007/s004190050248
https://doi.org/10.1007/s00158-010-0602-y


378 FERRER

5. DzierzÌ‡anowski G. On the comparison of material interpolation schemes and optimal composite properties in plane shape optimization.
Struct Multidiscip Optim. 2012;46:693-710.

6. Allaire G, Jouve F, Toader A-M. Structural optimization using sensitivity analysis and a level-set method. J Comput Phys.
2004;194(1):363-393. http://www.sciencedirect.com/science/article/pii/S002199910300487X

7. Amstutz S, AndrÃ¤ H. A new algorithm for topology optimization using a level-set method. J Comput Phys. 2006;216(2):573-588. http://
www.sciencedirect.com/science/article/pii/S0021999105005656

8. Allaire G, De Gournay F, Jouve F, Toader AM. Structural optimization using topological and shape sensitivity via a level set method.
Control Cybern. 2005;34(1):59.

9. Yamada T, Izui K, Nishiwaki S, Takezawa A. A topology optimization method based on the level set method incorporating a fictitious
interface energy. Comput Methods Appl Mech Eng. 2010;199(45-48):2876-2891.

10. Huang X, Xie YM. A new look at ESO and BESO optimization methods. Struct Multidiscip Optim. 2008;35(1):89-92.
11. Baiges J, MartÃ­nez-Frutos J, Herrero-PÃ©rez D, Otero F, Ferrer A. Large-scale stochastic topology optimization using adaptive mesh

refinement and coarsening through a two-level parallelization scheme. Comput Methods Appl Mech Eng. 2019;343:186-206.
12. Nguyen-Xuan H. A polytree-based adaptive polygonal finite element method for topology optimization. Int J Numer Methods Eng.

2017;110(10):972-1000.
13. Amstutz S. Connections between topological sensitivity analysis and material interpolation schemes in topology optimization. Struct

Multidiscip Optim. 2011;43(6):755-765.
14. SÃ¡ LFN, Amigo RCR, Novotny AA, Silva ECN. Topological derivatives applied to fluid flow channel design optimization problems. Struct

Multidiscip Optim. 2016;54(2):249264.
15. Brezis H. Functional Analysis, Sobolev Spaces and Partial Differential Equations. New York, NY: Springer Science; 2010.
16. Novotny AA, SokoÅ‚owski J. Topological Derivatives in Shape Optimization. Berlin, Germany: Springer-Verlag; 2013. Interaction of Mechanics

and Mathematics Series.
17. Giusti SM, Ferrer A, Oliver J. Topological sensitivity analysis in heterogeneous anisotropic elasticity problem. Theoretical and computa-

tional aspects. Comput Methods Appl Mech Eng. 2016;311:134-150.
18. Hashin Z, Shtrikman S. A variational approach to the theory of the elastic behaviour of multiphase materials. J Mech Phys Solids.

1963;11(2):127-140.
19. BendsÃ¸e MP, Sigmund O. Topology optimization: Theory Methods and Applications. Berlin, Germany: Springer-Verlag; 2003.
20. Allaire G. Shape Optimization by the Homogenization Method. New York, NY: Springer-Verlag; 2002. Applied Mathematical Sciences;

vol. 146.
21. Ern A, Guermond J-L. Theory and Practice of Finite Elements. Vol. 159. New York, NY: Springer Science Business Media; 2013.
22. Amstutz S, Dapogny C, Ferrer A. A consistent relaxation of optimal design problems for coupling shape and topological derivatives.

Numerische Mathematik. 2018;140(1):35-94. https://doi.org/10.1007/s00211-018-0964-4
23. Svanberg K. The method of moving asymptotesâ€”a new method for structural optimization. Int J Numer Methods Eng. 1987;24(2):359-373.
24. Greaves GN, Greer AL, Lakes RS, Rouxel T. Poisson's ratio and modern materials. Nature Materials. 2011;10(11):823.

How to cite this article: Ferrer A. SIMP-ALL: A generalized SIMP method based on the topological derivative
concept. Int J Numer Methods Eng. 2019;120:361â€“381. https://doi.org/10.1002/nme.6140

APPENDIX

SIMP-ALL MATLAB CODE

In this Appendix, we provide a simplified MATLAB code to facilitate the use of the SIMP-ALL interpolation to the reader.
The code is also available at https://github.com/FerrerFerreAlex/SimpALL. The SIMP_all_interpolation.m function is
devised to be used when starting the topology optimization code. The time of computing the interpolation function is
negligible making it as usable as the well-established interpolation functions. The constitutive interpolated tensor and
its derivative are provided since these are usually used when computing the compliance function and the gradient of
the compliance. To obtain the interpolation function, we first compute the shear and bulk modulus and the additional
ğœ‚ parameters. Then, the coefficients and the rational function are computed. Finally, we differentiate with respect to the
density variable to obtain the derivative.

http://www.sciencedirect.com/science/article/pii/S002199910300487X
http://www.sciencedirect.com/science/article/pii/S0021999105005656
http://www.sciencedirect.com/science/article/pii/S0021999105005656
https://doi.org/10.1007/s00211-018-0964-4
https://doi.org/10.1002/nme.6140
https://github.com/FerrerFerreAlex/SimpALL


FERRER 379

11 % dC ( rho ) : Derivative of the isotropic material constitutive tensor respect

12 % to the density function rho .

13 %

14 % Remark 1: No conditions are required to E1 , E0 , nu1 , nu0 ( except E>0 and

15 % âˆ’1<nu < 0.5) , so we could have referred to the strong and weak material as

16 % material A and B . However , we prefer to name them strong and weak to

17 % follow topology optimization naming .

18 %

19 % Remark 2: This version of the SIMPâˆ’ALL interpolation function is intended

20 % for 2D plane stress problems .

21 %

22 % Remark 3: SIMPâˆ’ALL interpolation evidenced to fulfill the Hashin âˆ’Shtrikman

23 % ( HS) bounds for all possible combination of the material properties .

24 % Thus , when the density function takes intermediate values , the resulting

25 % constitutive tensor can be interpreted as an homogenized constitutive

26 % tensor of a micro âˆ’ structure made of the strong and weak material with a

27 % relative fraction volume of the intermediate density value .

28 %

29 % Remark 4: SIMPâˆ’ALL interpolation is free of penalization and heuristic

30 % parameters .

31 %

32 % Remark 5: The interpolation is built on the one hand such that the

33 % constitutive tensor coincides with C0 ( constitutive tensor with E0 , nu0

34 % material properties ) in rho =0 and with C1 ( respectively E1 , nu1 ) in rho =1

35 % and on the other hand such that the constitutive tensor derivative in

36 % rho =0 and rho =1 coincides with the topological derivative of the

37 % compliance dC0 and dC1 , i . e .,

38 % C (0) = C0 , C (1) = C1 ,

39 % dC (0) = dC0 , dC (1) = dC1 .

40 %

41 % Remark 6: We opt for providing dC since when using the compliance

42 % ( integral f âˆ—u = integral e ( u ) :C( rho ) : e ( u ) ) in a topology optimization

43 % problem , its gradient is directly obtained as âˆ’ e ( u ) : dC ( rho ) : e ( u ) .

44 %

45 % Shear and bulk modulus

46 mu = @( E , nu ) E /(2 âˆ—(1+ nu ));

47 kappa = @( E , nu ) E /(2 âˆ—(1 âˆ’ nu ));

48 %

49 mu0 = mu( E0 , nu0 );

50 mu1 = mu( E1 , nu1 );

51 %

52 kappa0 = kappa ( E0 , nu0 );

53 kappa1 = kappa ( E1 , nu1 );

54 %

55 % Auxiliar material property

56 eta mu = @( mu, kappa )( kappa âˆ—mu)/(2 âˆ—mu+kappa );

57 eta kappa = @( mu, kappa ) mu;

58 %

59 eta mu0 = eta mu ( mu0, kappa0 );

60 eta mu1 = eta mu ( mu1, kappa1 );

1 f u n c t i o n [C , dC ] = s i m p a l l i n t e r p o l a t i o n ( E1 , E0 , nu1 , nu0 )

2 % SIMPâˆ’ALL i n t e r p o l a t i o n f u n c t i o n by Alex Fer re r , March 2019 .

3 %

4 % E0 , nu0 : Young modulus and Poisson r a t i o o f the i s o t r o p i c weak m a t e r i a l

5 % E1 , nu1 : Young modulus and Poisson r a t i o o f the i s o t r o p i c s t r o n g m a t e r i a l

6 %

7 % C( rho ) : I s o t r o p i c c o n s t i t u t i v e t e n s o r i n t e r p o l a t e d from the i s o t r o p i c

8 % m a t e r i a l p r o p e r t i e s o f the s t r o n g ( E1 , nu1 ) and the weak m a t e r i a l ( E0 , nu0 )

9 % through the â€ d e n s i t y f u n c t i o n â€ rho .

10 %

61 %

62 e ta kappa0 = eta kappa ( mu0 , kappa0 ) ;

63 e ta kappa1 = eta kappa ( mu1 , kappa1 ) ;

64 %

65 % I s o t r o p i c f o u r t h o rde r t e n s o r i n Voigt n o t a t i o n



380 FERRER

66 I1 = eye ( 3 ) ; I1 ( 3 , 3 ) = 1 / 2 ;

67 I2 = [ 1 1 0 ; 1 1 0 ; 0 0 0 ] ;

68 Aiso = @( alpha , beta ) a lpha âˆ— I1 + beta âˆ— I2 ;

69 %

70 % C o e fi c i e n t s ( n= numerator , d = denominator ) o f the r a t i o n a l f u n c t i o n

71 n01 = @( f0 , f1 , eta0 , e ta1 ) âˆ’( f 1 âˆ’ f 0 ) âˆ—( e ta1 âˆ’ eta0 ) ;

72 n0 = @( f0 , f1 , e ta0 ) f 0 âˆ—( f 1 + eta0 ) ;

73 n1 = @( f0 , f1 , e ta1 ) f 1 âˆ—( f 0 + eta1 ) ;

74 d0 = @( f1 , e ta0 ) ( f 1 + e ta0 ) ;

75 d1 = @( f0 , e ta1 ) ( f 0 + e ta1 ) ;

76 %

77 n01 mu = n01 ( mu0 , mu1 , eta mu0 , eta mu1 ) ;

78 n01 kappa = n01 ( kappa0 , kappa1 , eta kappa0 , e ta kappa1 ) ;

79 %

80 n0 mu = n0 ( mu0 , mu1 , eta mu0 ) ;

81 n0 kappa = n0 ( kappa0 , kappa1 , e ta kappa0 ) ;

82 %

83 n1 mu = n1 ( mu0 , mu1 , eta mu1 ) ;

84 n1 kappa = n1 ( kappa0 , kappa1 , e ta kappa1 ) ;

85 %

86 d0 mu = d0 ( mu1 , eta mu0 ) ;

87 d0 kappa = d0 ( kappa1 , e ta kappa0 ) ;

88 %

89 d1 mu = d1 ( mu0 , eta mu1 ) ;

90 d1 kappa = d1 ( kappa0 , e ta kappa1 ) ;

91 %

92 % Dens i ty f u n c t i o n ( symbol ic in o rde r f o r f u r t h e r d i ff e r e n t i a t i o n )

93 rho = sym ( â€™ rho â€™ , â€™ p o s i t i v e â€™ ) ;

94 %

95 % SIMPâˆ’ALL as a r a t i o n a l f u n c t i o n

96 f = @( n01 , n0 , n1 , d0 , d1 , rho ) . . .

97 ( n01 âˆ—(1 âˆ’ rho ) âˆ—( rho ) + n0 âˆ—(1 âˆ’ rho ) + n1 âˆ— rho ) / ( d0 âˆ—(1 âˆ’ rho )+ d1 âˆ— rho ) ;

98 %

99 mu = f ( n01 mu , n0 mu , n1 mu , d0 mu , d1 mu , rho ) ;

100 kappa = f ( n01 kappa , n0 kappa , n1 kappa , d0 kappa , d1 kappa , rho ) ;

101 %

102 % I s o t r o p i c c o n s t i t u t i v e t e n s o r .

103 Csym = s i m p l i f y ( Aiso (2 âˆ—mu , kappa âˆ’ mu ) ) ;

104 %

105 % Shear and bulk modulus d e r i v a t i v e s

106 dmu = d i ff (mu ) ;

107 dkappa = d i ff ( kappa ) ;

108 %

109 % I s o t r o p i c c o n s t i t u t i v e t e n s o r d e r i v a t i v e

110 dCsym = Aiso (2 âˆ—dmu , dkappa âˆ’dmu) ;

111 %

112 % In orde r to ob ta in a handle f u n c t i o n i n s t e a d o f a symbol ic e x p r e s s i o n and

113 % to d i r e c t l y e v a l u a t e the c o n s t i t u t i v e t e n s o r ( and d e r i v a t i v e ) f o r any

114 % v e c t o r o f d e n s i t i e s , we make use o f matlabFunction ( ) .

115 n s t r e = 3 ; % Number o f s t r e s s components i n Voigt n o t a t i o n i n p lane s t r e s s

116 dC = c e l l ( n s t r e , n s t r e ) ;

117 f o r i =1: n s t r e

118 f o r j =1: n s t r e

119 i f Csym ( i , j )==0

120 C{ i , j } = @( rho ) z e r o s ( s i z e ( rho ) ) ;

121 dC { i , j } = @( rho ) z e r o s ( s i z e ( rho ) ) ;

122 e l s e

123 C{ i , j } = matlabFunction ( Csym ( i , j ) ) ;

124 dC { i , j } = matlabFunction ( dCsym ( i , j ) ) ;

125 end

126 end

127 end

128 end



FERRER 381

In the following, we present an example for using the interpolation function in a common finite element context.

1 f u n c t i o n U s e e x a m p l e o f s i m p a l l i n t e r p o l a t i o n

2 % Use example o f the SIMPâˆ’ALL i n t e r p o l a t i o n f u n c t i o n f o r computing the

3 %compl iance and i t s g rad i en t , by Alex Fer re r , May 2018 .

4 %

5 % From a given m a t e r i a l i s o t r o p i c p r o p e r t i e s v a l u e s

6 E1 = 1 ;

7 E0 = 0 . 0 1 ;

8 nu1 = 1 / 3 ;

9 nu0 = 1 / 3 ;

10 % Bui ld the SIMPâˆ’ALL i n t e r p o l a t i o n o f the c o n s t i t u t i v e t e n s o r as

11 [C , dC ] = s i m p a l l i n t e r p o l a t i o n ( E1 , E0 , nu1 , nu0 ) ;

12 %

13 %In the con tex t o f a FE problem , f o r a g iven number o f gauss p o i n t s ngaus

14 % and number o f e lements nelem o f f o r example

15 nelem = 1000 ;

16 ngaus = 4 ;

17 %

18 % and f o r a g iven a d e n s i t y v a l u e s 0 <= rho <= 1 o f dimension

19 % dim ( rho ) = ngaus x nelem o f f o r example

20 rho = rand ( ngaus , nelem ) ;

21 %

22 % and f o r a g iven s t r a i n t e n s o r v a l u e s i n Voigt n o t a t i o n ( n s t r e = 3)

23 % ob ta ined from t h e s o l u t i o n o f a fi n i t e element problem KU=F o f f o r example

24 n s t r e s = 3 ;

25 s t r a i n = rand ( n s t r e s , ngaus , nelem ) ;

26 %

27 %Although i t would be cheaper with F âˆ—U, d e fi n i n g dV ( weight âˆ— Jacobian )

28 dV = rand ( ngaus , nelem ) ;

29 %the compl iance can be computed as

30 c = 0 ;

31 f o r i s t r e s = 1 : n s t r e s

32 f o r j s t r e s = 1 : n s t r e s

33 s t r = squeeze ( s t r a i n ( j s t r e s , : , : ) ) ;

34 aux = s t r . âˆ—C{ i s t r e s , j s t r e s } ( rho ) . âˆ— s t r . âˆ—dV ;

35 c = c + sum ( aux ( : ) ) ;

36 end

37 end

38 %

39 % and the g r a d i e n t o f the compl iance as

40 g = z e r o s ( ngaus , nelem ) ;

41 f o r i s t r e s = 1 : n s t r e s

42 f o r j s t r e s = 1 : n s t r e s

43 s t r = squeeze ( s t r a i n ( j s t r e s , : , : ) ) ;

44 g = g âˆ’ s t r . âˆ—dC { i s t r e s , j s t r e s } ( rho ) . âˆ— s t r ;

45 end

46 end

47 end


	SIMP-ALL: A generalized SIMP method based on the topological derivative concept
	Abstract
	INTRODUCTION
	TOPOLOGY OPTIMIZATION FORMULATION
	The exact topology optimization problem
	The relaxed topology optimization problem

	TOPOLOGICAL DERIVATIVE
	CONNECTION BETWEEN THE TOPOLOGICAL DERIVATIVE AND HASHIN-SHTRIKMAN BOUNDS
	RATIONAL FUNCTIONS
	SIMP-ALL METHOD
	COMPARISON BETWEEN SIMP AND SIMP-ALL
	Interpolation function comparison
	Numerical examples comparison

	CONCLUSIONS
	REFERENCES


