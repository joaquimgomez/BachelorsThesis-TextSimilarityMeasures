










































































































- 1 - 

 

 

An enhanced finite element macro-model for the  

realistic simulation of localized cracks in masonry structures:  

A large-scale application 

Savvas Saloustrosa,b *, Luca PelÃ a,b, Miguel Cerveraa,b, Pere Rocaa,b 

a Universitat PolitÃ¨cnica de Catalunya (UPC-BarcelonaTech), Department of Civil and En-
vironmental Engineering, Campus Nord, Jordi Girona 1-3, 08034, Barcelona, Spain. 

b International Center for Numerical Methods in Engineering (CIMNE), Universitat PolitÃ¨c-
nica de Catalunya (UPC-BarcelonaTech), Gran CapitÃ¡, S/N, 08034, Barcelona, Spain 

 

  

                                                 

* Corresponding author.  

E-mail addresses: savvas.saloustros@upc.edu (Savvas Saloustros), luca.pela@upc.edu (Luca PelÃ ), mi-

guel.cervera@upc.edu (Miguel Cervera), pere.roca.fabregat@upc.edu (Pere Roca) 

mailto:savvas.saloustros@upc.edu
mailto:luca.pela@upc.edu
mailto:miguel.cervera@upc.edu
mailto:miguel.cervera@upc.edu
mailto:pere.roca.fabregat@upc.edu


- 2 - 

 

 

Abstract â€“ Finite element macro-modelling approaches are widely used for the anal-

ysis of large-scale masonry structures. Despite their efficiency, they still face two im-

portant challenges: the realistic representation of damage and a reasonable independency 

of the numerical results to the used discretization. In this work, the classical smeared 

crack approach is enhanced with a crack-tracking algorithm, originating from the analysis 

of localized cracking in quasi-brittle materials. The proposed algorithm is for the first 

time applied to a large-scale wall exhibiting multiple shear and flexural cracking. Discus-

sion covers structural aspects, as the response of the structure under different assumptions 

regarding the floor rigidity, but also numerical issues, commonly overlooked in the sim-

ulation of large structures, such the mesh-dependency of the numerical results.  

 

Keywords: Continuum Modelling, Finite element analysis, FaÃ§ades, Macro-model-

ling, Masonry, Mesh independency, Pushover Analysis, Shear/Flexural cracks, Strain Lo-

calization, Tracking algorithm. 

 

Running head: A FE macro-model for localized cracks in large masonry structures 

 

  



- 3 - 

 

 

1.  Introduction 

The important advances of the last decades in the field of computational solid mechan-

ics, as well as the increasing capabilities of modern computers have resulted to an ample 

inventory of numerical methods used for the analysis of masonry structures. Nevertheless, 

there is no unified approach adhering all the aspects relative to the realistic simulation of 

masonry, namely damage localization, geometry representation, material description, and 

computational efficiency. The choice of the numerical approach depends on the purpose 

of the structural analysis (e.g. capacity, ductility, damage origin/propagation, collapse 

mechanism), the complexity and scale of the structure (e.g. single structural member or 

whole building) and the available resources (e.g. computational cost, knowledge of ge-

ometry and material properties).  

A common categorization of the various approaches is performed in terms of the detail 

of the material description within the numerical strategy. Under this scope, we can rec-

ognize direct numerical simulations that consider the geometry and the properties of the 

composite masonry material and simplified approaches that consider masonry as a ho-

mogenous material with average properties.  

Direct numerical simulations of masonry originate in the pioneering work of Page 

(1978, 1979). Micro-modelling (Lourenco and Rots 1997, Gambarotta and Lagomarsino 

1997a, Macorini  and Izzudin 2011) and discrete element methods (Papastamatiou and 

Psycharis 1993, Lemos 1997, McInerney and DeJong 2015) are today among the most 

used approaches accounting for the geometry of the composite material at the scale of its 

constituents, i.e. mortar joints and units (brick or blocks). Corollary of this detailed mod-



- 4 - 

 

 

elling are realistic numerical simulations that are in very good agreement with experi-

mental results. Nevertheless, important challenges of direct numerical simulations are the 

acquisition of a large number of material properties, the calibration of the numerical prop-

erties (Sarhosis and Sheng 2014) and, most importantly, the high computational cost 

(Roca et al. 2010). Due to these reasons, micro-modelling and discrete element ap-

proaches are up-to-date restricted to the analysis of small-scale structural elements or 

structures. 

Numerical simulations of large masonry structures are based on a different philosophy. 

For large-scale computations, the direct simulation of the masonry components becomes 

unaffordable both in terms of model preparation and computation times. The alternative 

is to idealize the masonry as a homogenous material with averaged properties depending 

on its components. This is the assumption of a wide and diverse family of computational 

approaches, including equivalent frame methods (Magenes and Calvi 1996, Molins and 

Roca 1998, Parisi and Augenti 2013, Lagomarsino et al. 2013, Addesi, Liberatore and 

Masiani 2015), numerical limit analysis (Block and Lachauer 2013, Milani 2013) and 

continuum mechanics (or macro-modelling) finite element methods (FEM) (Carvalho et 

al. 2014, PelÃ  et al. 2014a, Castellazzi et al. 2017). 

The macro-modelling approach has been widely used for the analysis of large masonry 

structures during the last decades (LourenÃ§o 2002, Roca et al. 2010, Theodossopoulos 

2013). Their popularity bases mostly on the facility to simulate large and complex geom-

etries at a reasonable computational cost. FEM macro-modelling approaches can capture 

the structural response during the whole loading history, providing important information 

on the damage evolution and the subsequent collapse mechanism.  



- 5 - 

 

 

Notwithstanding the aforementioned advantages, macro-models have two important 

limitations. The first one concerns the representation of damage. Failure of masonry under 

tension, bending or shear, is characterized by localized discrete cracks. Contrary to that, 

the representation of damage in macro-modelling approaches is often smeared over large 

areas or volumes of the structure. This inconsistency with the real behaviour hampers the 

association of existing damage with the simulated one and may result to an inaccurate 

interpretation of the emerging collapse mechanism. Apart from this, the smeared crack 

approach in the standard irreducible formulation of the finite element method results to 

the erroneous damage localization that depends on the alignment of the used mesh. The 

problem of mesh-bias independent crack localization is an open topic within the research 

field of computational failure mechanics (see Cervera, Chiumenti, and Codina 2010,  

Rabczuk 2012), with, however, limited contributions to the issues related to the analysis 

of large masonry structures. 

To overcome the above limitations of the macro-modelling approach the authors have 

proposed the enhancement of the classical smeared crack approach with a local crack-

tracking algorithm. This approach was introduced in (Cervera et al. 2010) with the aim 

of simulating localized cracks under tension or bending stress-states in quasi-brittle ma-

terials. The algorithm has been validated through comparison with experimental and an-

alytical results on concrete and masonry structural elements (Cervera et al. 2010, Salou-

stros, PelÃ , and Cervera 2015). Aiming to account for the linear and non-linear properties 

of orthotropic materials, PelÃ  et al. (2014) coupled the algorithm with an orthotropic dam-

age model resulting to the realistic simulation of damage experienced by timber and ma-

sonry elements. Large-scale applications include the analysis of representative bays of 



- 6 - 

 

 

the Mallorca cathedral (Roca et al. 2013, PelÃ  et al. 2014b) and the Poblet monastery 

(Petromichelakis, Saloustros, and PelÃ¡ 2014).  

Despite the differences of the materials and the scale of the simulated structures, the 

above applications bear a common characteristic; the structural collapse is defined by 

cracks starting from the boundaries of the structure (e.g. wall sides, door/window open-

ings) and propagating along one direction. Apart from these, another common failure 

mechanism of masonry piers and spandrels is due to diagonal shear cracking emerging 

from the interior and propagating along two opposite directions. Existing tracking algo-

rithms, however, have been developed for the simulation of cracks with a single propa-

gation direction and starting only from the boundary of the structure or predefined mate-

rial perturbations. This important simplification inhibits the use of these localization ap-

proaches to the analysis of large-scale problems with diverse cracking. Aiming to extend 

the application field of tracking algorithms, the authors have recently proposed a novel 

tracking algorithm with capacity to simulate both shear and flexural cracks (Saloustros et 

al. 2016a, Saloustros et al. 2016b). The algorithm has been validated through comparison 

with an experimental result on a full-scale masonry frame. 

This work investigates the applicability of the macro-model presented in (Saloustros 

et al. 2016a, Saloustros et al. 2016b) to the analysis of large masonry structures with 

failure mechanism defined by a large number of diverse cracks. To this aim, the seismic 

capacity of a large masonry wall is investigated by using the equivalent non-linear static 

analysis. To the best of the authorsâ€™ knowledge, the presented analyses are the first appli-

cation of tracking algorithms to the simulation of large-scale structures with multiple in-

ternal and boundary cracks. Discussion includes both the structural response of the wall 

under different assumptions regarding the floorsâ€™ rigidity and the numerical performance 



- 7 - 

 

 

of classical smeared crack approach with and without the proposed crack-tracking algo-

rithm. Special focus is given on the effect of the size and alignment of the mesh used in 

the numerical simulations, a topic that is rarely addressed in the existing studies about the 

analysis of large structures exhibiting multiple cracking.  

The paper is structured as follows. Section 2 outlines the underlying continuum dam-

age model. The enhancement of the classical smeared crack approach with the tracking 

algorithm is presented in Section 3. Section 4 constitutes the core of this paper, i.e. the 

application of the proposed approach to the case study of a large masonry wall of an 

existing building. The same section covers the important issue of the mesh-dependency 

of the numerical simulations. The paper closes with some concluding remarks in Section 

5. 

2.  Continuum damage macro-model 

Damage models are appealing for large-scale computations because they do not re-

quire the costly return-mapping algorithms of plasticity models. Additionally, the use of 

complex failure surfaces or the combination of more than one is straightforward, as sharp 

changes do not affect the robustness of the computation. For these reasons, damage mod-

els have been widely used for the non-linear analysis of masonry structures (Papa 1996, 

Gambarotta and Lagomarsino 1997b, PelÃ¡, Cervera and Roca 2011).  

The material degradation is simulated in this work with the use of the continuum dam-

age macro-model proposed by Cervera et al. (1995). The particular constitutive model 

considers the material as isotropic up to the triggering of the damage. In the non-linear 

range, there is a damaged induced orthotropy in the principal stress directions.  This 



- 8 - 

 

 

model has been chosen due to its good balance between computational cost and effi-

ciency, as shown from the analysis of complex masonry structures such as the Mallorca 

cathedral (Roca et al. 2013) and the church of the Poblet monastery (Saloustros et al. 

2014). More sophisticated models that consider the anisotropy of masonry (Trovalusci 

and Masiani 2003, PelÃ¡ et al. 2011, Petracca et al. 2017) can be potentially used, at the 

price of a higher computational cost, in cases where the anisotropic properties of the com-

posite material are available. 

 In the following, the main components of the constitutive model are outlined using 

compact notation. Lowercase bold letters in italics stand for second order tensors (e.g. ğˆğˆ), 

uppercase bold letters in italics for fourth order tensors (e.g. ğ‘ªğ‘ªğŸğŸ) and lowercase bold let-

ters for vectors (e.g. ğ©ğ©ğ£ğ£). For the detailed formulation the reader is referred to (Cervera 

2003). 

2.1 Constitutive equation 

In a continuum damage model, the actual stresses of a damaged material are associated 

to the equivalent stresses of the intact material (i.e. the effective stresses (Chaboche 

1988)) with the use of a scalar variable representing the magnitude of the damage expe-

rienced by the material. In this work, the Cauchy stress tensor ğˆğˆ is a function of the pos-

itive and negative effective stress tensors, ğˆğˆï¿½+ and ğˆğˆï¿½âˆ’respectively, through the following 

constitutive equation  

ğˆğˆ = (1 âˆ’  ğ‘‘ğ‘‘+)ğˆğˆï¿½+ +  (1 âˆ’  ğ‘‘ğ‘‘âˆ’)ğˆğˆï¿½âˆ’ (1) 

This is a model with damage induced rotating orthotropic behaviour. The scalar dam-

age indices ğ‘‘ğ‘‘+ and ğ‘‘ğ‘‘âˆ’ represent the damage of the material due to tensile and compres-



- 9 - 

 

 

sive stress states. Their value varies from 0 for intact material to 1 for a completely dam-

aged material. The positive and negative parts of the effective stress tensor are obtained 

through the following expressions (Faria, Oliver and Cervera1998) 

ğˆğˆï¿½+ =  ï¿½âŒ©ğœğœï¿½ğ‘—ğ‘—âŒª
3

ğ‘—ğ‘—=1

ğ©ğ©ğ£ğ£ âŠ— ğ©ğ©ğ£ğ£ 
(2) 

ğˆğˆï¿½âˆ’ = ğˆğˆï¿½ âˆ’  ğˆğˆï¿½+ (3) 

ğˆğˆï¿½ =  ğ‘ªğ‘ªğŸğŸ: ğœºğœº (4) 

In the above equations, ğœğœï¿½ğ‘—ğ‘— is the effective principal stress corresponding to the normal-

ized eigenvector  ğ©ğ©ğ£ğ£, ğ‘ªğ‘ªğŸğŸ is the classical elastic constitutive tensor and ğœºğœº the strain tensor. 

Symbols âŠ— and âŒ©âˆ™âŒª stand for the tensor product and the Macaulay brackets (âŒ©ğ‘¥ğ‘¥âŒª = ğ‘¥ğ‘¥, if 

ğ‘¥ğ‘¥ â‰¥ 0, âŒ©ğ‘¥ğ‘¥âŒª = 0, if ğ‘¥ğ‘¥ < 0) respectively.  

2.2 Damage criteria 

The failure surfaces that determine the triggering of the ğ‘‘ğ‘‘+ and ğ‘‘ğ‘‘âˆ’ indices are defined 

through two scalar functions respectively ğœğœÂ± termed as the equivalent stresses 

ğœğœ+ = ğ»ğ»[ğœğœï¿½ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š]
1

1 âˆ’ ğ‘ğ‘
ï¿½ï¿½3ğ½ğ½2Ì… + ğ‘ğ‘ğ¼ğ¼1Ì… + ğ›½ğ›½âŒ©ğœğœï¿½ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘šâŒªï¿½

ğ‘“ğ‘“+

ğ‘“ğ‘“âˆ’
 (5) 

ğœğœâˆ’ = ğ»ğ»[âˆ’ğœğœï¿½ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š]
1

1 âˆ’ ğ‘ğ‘
ï¿½ï¿½3ğ½ğ½2Ì… + ğ‘ğ‘ğ¼ğ¼1Ì… + ğœ…ğœ…1ğ›½ğ›½âŒ©ğœğœï¿½ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘šâŒªï¿½ (6) 

ğ‘ğ‘ =
ï¿½ğ‘“ğ‘“ğ‘ğ‘

âˆ’ ğ‘“ğ‘“âˆ’â„ ï¿½âˆ’1
2ï¿½ğ‘“ğ‘“ğ‘ğ‘

âˆ’ ğ‘“ğ‘“âˆ’â„ ï¿½âˆ’1
  (7) 

ğ›½ğ›½ = (1 âˆ’ ğ›¼ğ›¼)
ğ‘“ğ‘“âˆ’

ğ‘“ğ‘“+
âˆ’ (1 + ğ›¼ğ›¼) (8) 

The above definitions show the dependence of the failure surfaces on the uniaxial ten-

sile ğ‘“ğ‘“+ and compressive ğ‘“ğ‘“âˆ’ strengths, as well as on the biaxial ğ‘“ğ‘“ğ‘ğ‘
âˆ’ compressive strength. 



- 10 - 

 

 

ğ¼ğ¼1Ì… denotes the first invariant of the effective stress tensor and ğ½ğ½2Ì… the second invariant of 

the effective deviatoric stress tensor and ğœğœï¿½ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š and ğœğœï¿½ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š stand for the maximum and min-

imum effective principal stresses respectively. The ğœ…ğœ…1 variable in Equation (6) has been 

introduced in (Petracca et al. 2015) to control the shape of the compressive failure surface 

in the shear quadrants. Its value ranges from 0 (leading to the Drucker-Prager criterion) 

to 1 (leading to the criterion proposed by Lubliner et al. (1989), see Fig. 1. Finally, ğ»ğ»[âˆ™] 

is the Heaviside step function (ğ»ğ»[ğ‘¥ğ‘¥] =  1, ğ‘–ğ‘–ğ‘“ğ‘“ ğ‘¥ğ‘¥ â‰¥ 0 ğ‘ğ‘ğ‘ğ‘ğ‘‘ğ‘‘ ğ»ğ»[ğ‘¥ğ‘¥] =  0, ğ‘–ğ‘–ğ‘“ğ‘“ ğ‘¥ğ‘¥ < 0). 

The damage criteria for tensile ğ›·ğ›·+ and compressive damage ğ›·ğ›·âˆ’ are simply 

ğ›·ğ›·Â±(ğ‘Ÿğ‘ŸÂ±, ğœğœÂ±) = ğœğœÂ± âˆ’  ğ‘Ÿğ‘ŸÂ±  â‰¤ 0 (9) 

 

The scalars ğ‘Ÿğ‘ŸÂ± represent the loading history of the material and are necessary to dis-

tinguish between loading and unloading conditions. Their initial values are equal to the 

tensile and compressive strength (ğ‘Ÿğ‘Ÿ0
+ = ğ‘“ğ‘“+, ğ‘Ÿğ‘Ÿ0âˆ’ = ğ‘“ğ‘“âˆ’) of the material and then vary ac-

cording to 

ğ‘Ÿğ‘ŸÂ± = max [ğ‘Ÿğ‘Ÿ0
Â±, max

ğ‘šğ‘šâˆˆ(0,ğ‘šğ‘š)
ï¿½ğœğœğ‘šğ‘š

Â±ï¿½] (10) 

 

with n representing the number of the current (load/displacement) increment. 

Finally, an exponential softening law is selected for the evolution of the damage vari-

ables 

ğ‘‘ğ‘‘Â± = 1 âˆ’  
ğ‘Ÿğ‘Ÿ0

Â±

ğ‘Ÿğ‘ŸÂ±
ğ‘’ğ‘’ğ‘¥ğ‘¥ğ‘’ğ‘’ ï¿½2ğ»ğ»ğ‘‘ğ‘‘

Â± ï¿½
ğ‘Ÿğ‘Ÿ0

Â± âˆ’ ğ‘Ÿğ‘ŸÂ±

ğ‘Ÿğ‘Ÿ0
Â± ï¿½ï¿½ 

(11) 

where ğ»ğ»ğ‘‘ğ‘‘ â‰¥ 0 is the discrete softening parameter taking into account the compressive 

and tensile fracture energy of the material ğºğºğ‘“ğ‘“
Â± and the characteristic finite element width 



- 11 - 

 

 

ğ‘™ğ‘™ğ‘‘ğ‘‘ğ‘šğ‘šğ‘‘ğ‘‘, ensuring mesh-size objective results according to the crack-band theory (Bazant and 

Oh 1983). Its value is defined with the following equations 

ğ»ğ»ğ‘‘ğ‘‘
Â± =

ğ‘™ğ‘™ğ‘‘ğ‘‘ğ‘šğ‘šğ‘‘ğ‘‘
ğ‘™ğ‘™ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š

Â± âˆ’ ğ‘™ğ‘™ğ‘‘ğ‘‘ğ‘šğ‘šğ‘‘ğ‘‘
 

(12) 

ğ‘™ğ‘™ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š
Â± = 2ğ¸ğ¸ğºğºğ‘“ğ‘“

Â± ğ‘“ğ‘“Â±â„  (13) 

The value of the characteristic element width is considered as ğ‘™ğ‘™ğ‘‘ğ‘‘ğ‘šğ‘šğ‘‘ğ‘‘ =  ï¿½2ğ´ğ´ğ‘’ğ‘’, where ğ´ğ´ğ‘’ğ‘’ 

is the surface of the triangular element.  

3.  The local crack-tracking algorithm 

The crack-tracking algorithm serves as an enhancement of the classical smeared crack 

approach. Its aim is to the ensure mesh-bias independency of the numerical results and 

the realistic representation of propagating cracks in the numerical simulation of fracture 

in quasi-brittle materials. The presented approach has been implemented in the finite el-

ement software COMET (2016) developed in the International Centre of Numerical 

Methods in Engineering (CIMNE) at the Technical University of Catalonia, Barcelona.  

All the functions of the crack-tracking algorithm are performed within a set of subrou-

tines that are executed before the computation of the stresses at the first iteration of each 

(load or displacement) increment of the numerical analysis. The purpose of the algorithm 

is to identify the propagation path of all new and existing cracks for the current increment. 

A flag system is used to distinguish between (a) damaged elements, (b) non-damaged 

elements within a crack-path and (c) non-damaged elements outside a crack-path. The 

stress-strain state of the elements within the aforementioned (a) and (b) groups is defined 

according to the constitutive law presented in Section 2. For the elements in group (c) a 



- 12 - 

 

 

linear-elastic relationship is maintained. The basic elements of the tracking algorithm are 

presented in Fig. 2. 

The first step of the crack-tracking algorithm consists in identifying new cracks. These 

originate at elements satisfying the damage criterion as defined in Equation 9. Since the 

damage condition can be satisfied for more than one element at the same increment, an 

â€œexclusion radius criterionâ€ is used to identify the origin of a crack. This defines that the 

â€œcrack rootâ€ element is the one with the highest ratio between the tensile effective stress 

and tensile strength of the material (i.e. ğœğœ+ ğ‘“ğ‘“+â„ ) within an area defined by an â€œexclusion 

radiusâ€ ğ‘Ÿğ‘Ÿğ‘’ğ‘’ğ‘šğ‘šğ‘’ğ‘’ğ‘’ğ‘’. The latter value represents the minimum distance between existing and new 

cracks and is determined by the user. The purpose of the exclusion radius criterion is two-

fold. The first one is to avoid the non-realistic spreading of damage over large areas, 

which typically occurs in smeared cracking problems with standard finite elements. This 

is a numerical pathology, not associated with the nature of the simulated material, leading 

in the later steps of the analysis to the erroneous and mesh-dependent localization of dam-

age. The problem of the mesh-independent strain localization is an ongoing challenging 

topic in the field of computational failure mechanics, with tracking algorithms being one 

of the current efficient alternatives (Cervera and Chiumenti 2006, JÃ¤ger, Steinmann and 

Kuhl 2008, Slobbe, Hendriks and Rots 2014, Saloustros et al. 2015). The second purpose 

of the exclusion radius is to account of the composite nature of the simulated material in 

a simplified and implicit way, when continuum finite element models are used for the 

numerical analysis. To illustrate this, consider the case of a historical masonry where 

cracking is mainly localized within the more vulnerable mortar joints, either due to the 

damage of the mortar or the debonding between the mortar and the (brick or stone) units. 

In such cases, the exclusion radius can be associated to the size of the units. A value of 



- 13 - 

 

 

the exclusion radius less or equal to the finite element size recovers the classical smeared 

crack approach. The effect of this parameter on the simulation of masonry structures has 

been presented in (Cervera et al. 2010, Roca et al. 2013, Saloustros et al. 2016a, Salou-

stros et al. 2016b). 

After recognising the new cracks for the current increment, the crack-tracking algo-

rithm proceeds to the identification of the propagation path for each crack. The crack 

propagation direction is defined to be orthogonal to the direction of the maximum princi-

pal stresses as calculated either at the crack origin for new cracks or at the crack-tip ele-

ment for existing ones. The crack-tip is the last element at the propagation front of a 

consolidated (at a previous increment) crack. For the case of internal crack origins, the 

crack path is sought along the two opposite orientations defined by the crack propagation 

vector. For crack origins lying on the boundary of the numerical domain or for crack-tips, 

the crack propagates to the single direction defined by the same vector.  

An important task of the algorithm is the opportune correction of sudden changes in 

the crack propagation direction. This situation occurs for high stress gradients at the prop-

agating front of flexural cracks. To alleviate this pathology a maximum curvature crite-

rion is used (Cervera et al. 2010) that identifies sudden changes in the crack propagation 

direction at the crack-tip comparing to the last part of the crack with length ğ‘Ÿğ‘Ÿğ‘šğ‘šğ‘’ğ‘’ğ‘šğ‘šğ‘›ğ‘›â„ and 

corrects it according to a minimum deviation angle (ğ‘ğ‘ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š) defined by the user. For further 

details, the interested reader is referred to (Cervera et al. 2010, Saloustros et al. 2016a).  

4.  Numerical Simulation of a large-scale wall 

In this section, the enhanced macro-model with the crack-tracking algorithm is applied 

for the first time to the analysis of a large-scale structure with multiple cracking. The case 



- 14 - 

 

 

study concerns the analysis of a five floor structural wall at the interior of a masonry 

building situated in Via Martoglio, Catania Italy. The wall has regular openings symmet-

rically distributed along its central axis. Two irregularities exist in the structure. The first 

one concerns an opening at the right corner of the top floor and the second is a large door 

opening at the middle of the base floor. Clay brick vaults supported on concrete girders 

comprise the floor structural system, while the roof is a timber structure. The masonry is 

of regular units with dimensions 250 Ã—  120 Ã—  55 ğ‘šğ‘šğ‘šğ‘š3  (brick UNI5628/65). All the 

lintels are made of masonry but that of the central door at the base, which is made of 

reinforced concrete. Figure 3a presents the geometry and dimensions of the analysed 

structure. 

The numerical simulation aims to investigate the structural response of the wall against 

seismic actions by means of a non-linear equivalent static analysis. Two stages of loading 

are considered. The first one corresponds to the application of the self-weight of the walls 

and floors and the live load as defined in (Brencich et al. 2000). In the second stage, the 

seismic actions are simulated as horizontal forces applied at the level of each floor. The 

loading pattern is proportional to the height and the vertical loading of each floor as sug-

gested by the Italian Code [D.M 14/01/2008]. 

As no information is available regarding the rigidity of the floors, two different models 

have been considered. In the first one (denoted hereafter as Model A), the same material 

parameters are used for both the masonry walls and floors assuming the existence of a 

flexible diaphragm (Material A in Table 1). In the second model (denoted hereafter as 

Model B), the floors are simulated as linear elastic with the double stiffness of the ma-

sonry aiming to consider the effect of a stiff diaphragm (Material B in Table 1). The latter 

material has been used in both models for modelling the lintel above the central opening 



- 15 - 

 

 

at the ground floor. The material properties have been taken from previous analyses on 

the same building (Brencich et al. 2000, Milani, LourenÃ§o and Tralli 2006). The ğœ…ğœ…1 pa-

rameter is taken equal to 0.45 which is equivalent to assume a shear strength of 0.15 MPa, 

which is the value used in the previous reference studies (Brencich et al. 2000, Milani, 

LourenÃ§o and Tralli 2006). The ratio between biaxial and uniaxial compression is equal 

to 1.15. As presented in (Saloustros et al. 2016a, Saloustros et al. 2016b), the exclusion 

radius can be associated to the size of units of the simulated masonry. This is because 

cracking usually localizes in the interface between the units and the mortar. For this rea-

son, an exclusion radius of 0.25 m is used in this case, which is equal to the bricks length, 

while the rest of the tracking parameters are ğ‘ğ‘ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š = 45Â° and ğ‘Ÿğ‘Ÿğ‘šğ‘šğ‘’ğ‘’ğ‘šğ‘šğ‘›ğ‘›â„ =  0.5 ğ‘šğ‘š. The last 

two are minimum values that prevent the overturning of cracks. For a detailed discussion 

of the effect of the tracking parameters, the reader is referred to (Saloustros et al. 2016a, 

Saloustros et al. 2016b). 

The structure is discretized using an unstructured mesh with two-dimensional constant 

strain triangles under plane stress conditions. The average size of the finite elements is 

0.15 m resulting in a total number of 51052 elements (Fig. 3b). The analysis is performed 

using an arc-length method along with a line-search procedure. Convergence is achieved 

for a ratio between the norm of residual forces against the norm of the total external forces 

less than 0.01. Calculations are performed using the finite element software COMET 

(2016), while pre- and post-processing with GiD, developed also in CIMNE, Barcelona 

(GiD 2016). 



- 16 - 

 

 

4.1 Model Aâ€“ Flexible Diaphragm 

The structural response of the Model A with flexible floors is presented in terms of 

base shear against top horizontal displacement in Figure 4. The structure has a maximum 

capacity of 635 kN. The post-peak response is characterized by a softening part leading 

to a residual strength of around 530 kN. 

The first drop in the stiffness occurs for a base shear of around 350 kN. This coincides 

with the occurrence of shear and flexural cracking at the spandrels of the second and third 

floor as shown in Figure 5a. The increase in the horizontal load results to the extension 

of damage to the great majority of the spandrels, see Figure 5b. Flexural cracks initiate 

from the corner of the openings and propagate vertically within the spandrels. Contrarily, 

shear cracks emerge from the interior of the spandrels, at their middle height, and continue 

their propagation diagonally in two directions. Figure 6 presents the evolution of this 

damage pattern for the spandrel at the 4th floor and second column of openings (counting 

from the right side). Cracking due to bending initiates at the two ends of the spandrel and 

propagates towards the interior (Figure 6a). At a later stage, shear cracks emerge at the 

interior (Figure 6b) of the spandrel and evolve diagonally towards the two ends of the 

spandrel (Figure 6c). This cracking is characteristic of a strong-pier weak spandrel con-

figuration (Beyer and Dazio 2012, Parisi & Augenti 2014). The presented tracking algo-

rithm can successfully simulate this common damage typology of masonry because it 

allows cracks to initiate at any location of the mesh and to propagate in one or two direc-

tions.  

 Figure 5c shows the tensile damage distribution just after the maximum capacity of 

the structure. The vertical piers of the right side start to behave as cantilevers owing to 

the extensive damage of the weak spandrels. The collapse mechanism is determined by 



- 17 - 

 

 

the rotation of the right corner after the progression of damage at the spandrels of all 

floors of the extreme right side at levels sufficient to allow its detachment from the rest 

of the structure. The rest of the analysis finds the right corner rotating around its base, 

resulting to important shear cracking at the base wall (Figure 5d). The analysis stops when 

the flexural cracks at the spandrels are entirely opened, resulting to their complete parti-

tion from their adjacent piers. 

4.2 Model B â€“ Stiff Diaphragm 

The assumption of a stiff and elastic diaphragm has an important effect in the response 

of the structure. The capacity increases around 80%, reaching a horizontal load of 1139 

kN (Figure 4). The displacement of the structure for the capacity load increases in the 

same order, being of 11 mm instead of 6.6 mm for Model A.  

The initiation of damage is similar to that of Model A, affecting the spandrels of the 

second and third floor at the fourth column of openings (counting from the left side) for 

a base shear of around 425 kN, see Figure 7a. Contrary to Model A, the increase of the 

horizontal force results in a more uniform distribution of damage at the spandrels. This 

can be observed in Figure 7b, showing the tensile damage contour for a base shear of 

around 750 kN. After the spreading of damage at the spandrels, shear cracks start affect-

ing the piers of the base floor. Important cracking seems to affect the pier next to the base 

door, which is probably due to a hammering effect of the rigid lintel above it. The tensile 

damage distribution after reaching the maximum capacity is shown in Figure 7c. The 

stiffer floors have restrained the rotation of the vertical piers despite the severe damage 

at the spandrels and mobilized the shear response of the piers. Flexural cracks start ap-

pearing at the lower left corner, while shear cracks are now evident in many piers of the 



- 18 - 

 

 

structure mostly at the right side and the base. The shear failure of these piers determines 

the capacity of the structure, which can be seen as the drop of the base shear after the 

peak in the graph of Figure 4. The shear capacity of the rest piers results to a residual 

strength of the structure as shown by the horizontal plateau in the post-peak response. 

This is followed by another sudden drop in the residual strength of the structure due to 

the shear failure of the rest of the piers at the left part of the structure as shown in Figure 

7d. The analysis stops when the shear capacity of all the base piers is exhausted.  

4.3 Discussion of the diaphragm effect on the structural response 

 The different assumptions regarding the rigidity and strength of the floors lead to sub-

stantial changes of the structural response. Stiff floors increase the integrity of the struc-

ture and the collaboration among the vertical piers even after the damage at the spandrels.  

The collapse mechanism in Model A is triggered by the flexural cracking at the span-

drels. This induces the cantilever behaviour of the last three vertical piers of the right side, 

which rotate around their base with almost no interaction among them. Failure of the 

structure is eventually determined by the collapse of the right side, as shown in Figure 8a. 

Contrarily, the stiff floor in Model B results in the mobilisation of the shear response of 

the piers, the strength of which determines the global capacity of the structure. Collapse 

in this case is due to the shear failure of the piers at the base of the structure Fig 8b. The 

capacity of the tracking algorithm to model internal cracks with two orientations, i.e. 

shear cracks, is crucial for the realistic simulation of the current case study. 

The different nonlinear response between the shear failure and the flexural one can be 

appreciated through a comparison of the base shear versus displacement graphs in Figure 

4. Flexural failure in Model A and rocking of the vertical piers is characterized by a 



- 19 - 

 

 

smooth post-peak response. Differently, in Model B the shear failure of the piers at the 

base results to sudden drops in the load-caring capacity of the structure after the peak-

strength. 

 A common characteristic of both models is the weakness of the spandrels. The most 

prone of them to fail are those with massive piers at their both sides. This is the case of 

the spandrels at the fourth column (counting from the left side), which are the first to 

experience damage during the loading history (see Figs 5a and 7a) for both models. Nev-

ertheless, the damage pattern at the spandrels seems to change from mainly vertical flex-

ural cracks to diagonal shear cracking when the floor has an increased stiffness compared 

to that of the masonry walls. 

4.4 Comparison with other approaches 

Figure 9 presents a comparison between the results obtained with the macro-model 

proposed in this work and three alternatives from the literature: a finite element model 

with inserted discontinuities (Brencich et al. 2000), a limit analysis software (Milani, 

LourenÃ§o and Tralli 2006) and an equivalent frame approach (Addessi, Liberatore and 

Masiani 2015).  

The capacity obtained using Model A (635 kN) is very similar to the one calculated 

using the lower bound approach (691 kN) in Milani et al. (2006) considering the case 

with flexible diaphragms. The small difference may be attributed to the different applica-

tion pattern of the masonryâ€™s self-weight, which was concentrated at the floor levels in 

(Milani, LourenÃ§o and Tralli 2006), while here the self-weight of the walls is applied at 

the masonry surfaces. This difference could explain the lower capacity of the present 

model since more load is actually located at higher levels of the structure.  



- 20 - 

 

 

Two models are reported from the work of Brencich et al. (2000). In the Model 1 the 

concrete floors were assumed to have the same properties as the masonry (as in Model A 

here), while in Model 2 they were modelled as elastic with an elastic modulus of 5 GPa 

(as in Model B here). In these models, damage could localize only along discontinuities 

distributed within the structure at horizontal layers and separated by quadrilateral finite 

elements. Vertical interfaces were positioned only at the location of the masonry lintels 

at each floor and for a single element height. The different treatment of damage and the 

above restrains in the propagation of vertical cracks resulted in an increased capacity 

comparing to the one estimated here for both models. This difference is more important 

for the case of Model 1 and Model A, where the analyses show that failure is characterized 

by vertical cracking due to bending at the spandrels.  Nevertheless, the damage distribu-

tion within the structure is equivalent in both approaches and for both models. In Models 

1 and A, damage is mainly localized at the spandrels, while in Models 2 and B significant 

damage affects the piers of the structure, and especially those of the lower floor. 

Finally, the maximum capacity obtained using Model B is very close to the one pre-

dicted in (Addessi, Liberatore and Masiani 2015) for a model with the assumption of 

elastic diaphragms and using an equivalent frame approach with force-based beam finite 

elements. The differences existing in the linear response are due to the use of a different 

value of elastic modulus for the walls of the structure.  

The obtained results using the proposed approach are in overall agreement with those 

existing in the literature. The enhanced capacity of the crack-tracking algorithm to simu-

late the propagation of damage within the structure results to a more detailed representa-

tion of the post-peak response, as shown especially for the case of Model B. The presented 

approach can be an efficient alternative for the analysis of large structures, especially 



- 21 - 

 

 

when the analyst necessitates information regarding the behaviour of the different struc-

tural members and the local collapse mechanisms occurring within the structure.  

4.5 Mesh dependency 

This section investigates the dependency of the proposed approach to the discretization 

size and structure of the mesh. The performed analyses consider the properties of Model 

A using two additional meshes, and the obtained results are compared with the reference 

mesh of Figure 3b. 

4.5.1 Mesh-size dependency 

The mesh-size dependency is investigated using a refined unstructured mesh with av-

erage element size equal to 75 mm. This increased refinement results in a total number of 

204729 elements, i.e. 4 times more than in the reference model. The difference of the 

refinement level is illustrated in Figure 10.  

Figure 11 shows the global response of the structure for the two unstructured meshes 

with the different element sizes. The two graphs almost coincide providing identical ca-

pacity for both cases and a very similar post-peak response. As illustrated in Figure 12a, 

the damage pattern is comparable for both cases. The same occurs for the obtained col-

lapse mechanism, shown with the contour of the maximum principal strains in Figure 

12b. The proposed enhanced macro-model gives results that are mesh-size independent. 

This is due to both the correct localization of the damage and the regularization of the 

constitutive law according to the finite elementâ€™s characteristic length as shown from 

Equations (11)-(13). 



- 22 - 

 

 

4.5.2 Mesh-bias dependency 

The mesh-bias dependency is investigated by comparing the results obtained with the 

mesh of Figure 3b, with a structured mesh presented in Figure 13. The sides of the or-

thogonal triangles make angles of 0Âº, 45Âº, 90Âº and 135Âº with the horizontal direction and 

have a mean length of 150 mm (44852 elements). Analyses with this mesh are carried-

out with both the classical smeared crack approach and the crack-tracking algorithm.  

The damage distribution as well as the localized strains for a horizontal displacement 

of approximately 21 mm using the two different meshes and the enhanced macro-model 

are presented in Figure 14. The obtained results are in good agreement. The damage ty-

pology at the spandrels is similar in both cases, with flexural cracks being present at the 

two corners of the openings and shear cracks at the middle of the spandrels. Good agree-

ment is found also for the localized cracks and the occurring collapse mechanism, deter-

mined by the overturning of the right corner as shown in Figure 14b and Figure 14d.  

The effectiveness of the crack-tracking technique to address the mesh-bias dependency 

is better demonstrated when compared with the numerical simulations carried-out without 

using the algorithm. To this aim, both meshes of Figure 3b and Figure 13 are analysed 

using the classical smeared crack approach. Figure 15a presents the contours of tensile 

damage using the unstructured mesh of Figure 3b, for a horizontal displacement at the top 

of the structure equal to 15.4 mm. Severe damage affects the spandrel walls resulting to 

their separation from the adjacent piers and the rotation of the vertical walls at the right 

side of the structure. Note the direction of the cracks that have opened during the loading 

history, but also the open cracks after reaching the capacity of the structure (Figure 15b); 

they are mostly diagonal, referring to a prevailing shear failure at the spandrels. Consider 

now the results of the numerical analysis using the structured mesh of Figure 13. Figure 



- 23 - 

 

 

15c presents the contour of the tensile damage for a displacement of 15.5 mm at the top 

of the structure. Cracking once again prevails at the spandrels, but this time the crack 

orientation is vertical in the great majority of the existing cracks. This is better observed 

with the contour of the maximum principal strains showing the localized cracks in Figure 

15d.  

It is obvious that the numerical solution is mesh-bias dependent for both the used dis-

cretizations when the proposed enhanced macro-model is not used. This numerical pa-

thology inhibits the assessment of the actual local collapse mechanisms. On the contrary, 

the proposed algorithm shows to be robust, even for the structured mesh with orientations 

that facilitate the opening of vertical cracks, as the case of the classical smeared crack 

approach has demonstrated. 

The different response of the structure for the two meshes is clear in the base shear 

against horizontal displacement graphs of Figure 16. The capacity of the structure without 

the use of the crack-tracking algorithm is lower by around 14% when the structured mesh 

is used, compared to the result with the structured one. This is due to the mesh-biased 

cracking at the spandrels, being vertical at the case of the structured mesh and diagonal 

for the unstructured one. Quite different response is also observed in the post-peak range 

with a sharper decrease of the residual capacity. Contrarily, the results using the crack-

tracking algorithm are in good agreement among them for both used meshes (Figure 16). 

The capacity is lower by around 2% for the case with the structured mesh. Despite this, 

the structural response is clearly similar for both cases, even in the post-peak response. A 

comparison between the graphs obtained with and without the tracking algorithm reveals 

the impact of the erroneous localization of damage with the smeared crack approach. 



- 24 - 

 

 

5.  Conclusions 

In this work, an enhanced continuum finite element model has been applied to the 

analysis of a large masonry structure. The model bases in the use of standard finite ele-

ments, a crack-tracking algorithm and a continuum damage model.  

The proposed enhanced continuum finite element model has been used for the nonlin-

ear analysis of a real case study consisting of a large masonry faÃ§ade of an existing build-

ing, for the combined gravitational loads and (earthquake equivalent) monotonically in-

creasing horizontal forces. The use of the proposed algorithm has given an important in-

sight on the alteration of the structural response of the simulated wall for the two different 

assumptions regarding the rigidity of the floor system. A flexible diaphragm results to a 

reduced capacity and to a collapse mechanism characterized by the cantilever response of 

the vertical continuous piers after flexural and shear damage in the weak spandrels. The 

horizontal loading finally evokes the complete separation of the right side of the structure. 

On contrary, a floor system with increased stiffness and strength (compared to the vertical 

walls) preserves the integrity of the structure after the shear damage of the spandrels. 

Failure in this case is characterized by shear cracking at the piers of the base floor. 

Numerical analyses carried out using various discretizations with different sizes and 

orientations demonstrate the mesh-size and mesh-bias independency of the proposed ap-

proach. For the mesh-bias dependency study, the enhanced model with the tracking 

method has been compared with the traditional smeared crack approach. The obtained 

crack pattern using the classical smeared crack approach has shown to depend notably on 

the orientation of the mesh, affecting considerably the structural response and the pre-

dicted capacity of the analysed wall. On the contrary, the results obtained with the crack-



- 25 - 

 

 

tracking algorithm have been very consistent for both meshes. The proposed approach 

has shown to be robust and suitable for the realistic simulation of multiple cracking in 

large structures.  

Acknowledgments 

This research has received the financial support from the MINECO (Ministerio de 

Economia y Competitividad of the Spanish Government) and the ERDF (European Re-

gional Development Fund) through the the MULTIMAS project (Multiscale techniques 

for the experimental and numerical analysis of the reliability of masonry structures, ref. 

num. BIA2015-63882-P) and the EACY project (Enhanced accuracy computational and 

experimental framework for strain localization and failure mechanisms, ref. num MAT 

2013-48624-C2-1-P). 

  



- 26 - 

 

 

6.  Figure Captions 

Figure 1. The damage surface as proposed in (Lubliner et al. 1989) 

Figure 2. The basic elements of the crack-tracking algorithm 

Figure 3. (a) Geometry of the analysed wall (in mm) and (b) the used unstructured 

mesh. 

Figure 4. Base shear versus horizontal displacement at the top right corner of the structure 

for the flexible diaphragm case (Model A) and for the stiff diaphragm case (Model B). 

Figure 5. Tensile damage contour of Model A for a horizontal displacement at the right 

top of: (a) 2 mm (point A1 in Figure 4), (b) 3.5 mm (point B1 in Figure 4), (c) 6.9 mm 

(point C1 in Figure 4) and (d) 37 mm (point D1 in Figure 4). 

Figure 6. Flexural and shear cracking evolution at the spandrel of the 4th floor, second 

column of openings (counting from the right side) for a displacement at the top of: (a) u 

= 2.9 mm (b) u = 4.0 mm (c) u = 11.9 mm. 

Figure 7. Tensile damage contour of Model B for a horizontal displacement at the right 

top of: (a) 2.2 mm (point A2 in Figure 4), (b) 4.8 mm (point B2 in Figure 4), (c) 11.4 

mm (point C2 in Figure 4) and (d) 25.1 mm (point D2 in Figure 4). 

Figure 8. Contour of the maximum principal strains on a deformed (Ã—30) mesh for (a) 

Model A and (b) Model B. 

Figure 9. Comparison of the global response of the Via Martoglio masonry wall as 

obtained by different numerical approaches.   

Figure 10. Part of the mesh used with average element size of (a) â„ğ‘’ğ‘’ = 150 ğ‘šğ‘šğ‘šğ‘š, (b) â„ğ‘’ğ‘’ =

75 ğ‘šğ‘šğ‘šğ‘š. 



- 27 - 

 

 

Figure 11. Base shear versus horizontal displacement at the top right corner of the struc-

ture using a mesh with different element size. 

Figure 12. Contours of (a) tensile damage, (b) maximum principal strains on a deformed 

(Ã—40) mesh for a displacement at the top right corner of 37 mm. Top row:  unstructured 

mesh with average element size of 150 mm, Bottom row: unstructured mesh with average 

element size of 75 mm. 

Figure 13. Structured mesh used in the mesh-bias sensitivity analysis. 

Figure 14. Simulation of Model A using the proposed crack-tracking algorithm. (a) Ten-

sile damage and (b) maximum principal strains using the unstructured mesh for a hori-

zontal displacement of 20.9 mm (Point 1 in Figure 11). (c) Tensile damage and (d) max-

imum principal strains using the structured mesh for a horizontal displacement of 21.2 

mm (Point 2 in Figure 11). 

Figure 15. Simulation of Model A using the classical smeared crack approach. (a) Tensile 

damage and (b) maximum principal strains using the unstructured mesh for a horizontal 

displacement of 15.4 mm (Point 3 in Figure 11). (c) Tensile damage and (d) maximum 

principal strains using the structured mesh for a horizontal displacement of 15.5 mm 

(Point 4 in Figure 11). 

Figure 16. Base shear versus horizontal displacement at the top right corner of the struc-

ture using two different meshes (structured and unstructured), with and without the pro-

posed crack-tracking algorithm. 

 

 

 



- 28 - 

 

 

7.  Tables 

 

Material 
ğ›¾ğ›¾  

(ğ‘˜ğ‘˜ğ‘˜ğ‘˜ ğ‘šğ‘š3)â„  

ğ›¦ğ›¦  

(ğ‘€ğ‘€ğ‘€ğ‘€ğ‘ğ‘) 

ğ‘£ğ‘£  

( âˆ’ ) 

ğ‘“ğ‘“+  

(ğ‘€ğ‘€ğ‘€ğ‘€ğ‘ğ‘) 

ğ‘“ğ‘“âˆ’  

(ğ‘€ğ‘€ğ‘€ğ‘€ğ‘ğ‘) 

ğºğºğ‘“ğ‘“
+ 

( ğ½ğ½ ğ‘šğ‘š2â„ ) 

ğºğºğ‘“ğ‘“
âˆ’ 

( ğ½ğ½ ğ‘šğ‘š2â„ ) 

Model A Model B 

A 1700 2500 0.2 3.00 0.1 100 50000 
Wall & 

Floors 
Walls 

B 1700 5000 0.2 - - - - Lintel 
Lintel & 

Floors 

Table 1 Material parameters adopted in the numerical simulations 

 

 

 

 

  



- 29 - 

 

 

8.  Figures 

 

Figure 1. The damage surface as proposed in (Lubliner et al. 1989) 

  



- 30 - 

 

 

 

Figure 2. The basic elements of the crack-tracking algorithm 

  



- 31 - 

 

 

 

Figure 3. (a) Geometry of the analysed wall (in mm) and (b) the used unstructured 

mesh. 

  



- 32 - 

 

 

 
 

Figure 4. Base shear versus horizontal displacement at the top right corner of the struc-

ture for the flexible diaphragm case (Model A) and for the stiff diaphragm case (Model 

B). 

  



- 33 - 

 

 

 

Figure 5. Tensile damage contour of Model A for a horizontal displacement at the 

right top of: (a) 2 mm (point A1 in Figure 4), (b) 3.5 mm (point B1 in Figure 4), (c) 6.9 

mm (point C1 in Figure 4) and (d) 37 mm (point D1 in Figure 4). 

  



- 34 - 

 

 

 

Figure 6. Flexural and shear cracking evolution at the spandrel of the 4th floor, sec-

ond column of openings (counting from the right side) for a displacement at the top of: 

(a) u = 2.9 mm (b) u = 4.0 mm (c) u = 11.9 mm. 

 

  



- 35 - 

 

 

 

Figure 7. Tensile damage contour of Model B for a horizontal displacement at the 

right top of: (a) 2.2 mm (point A2 in Figure 4), (b) 4.8 mm (point B2 in Figure 4), (c) 

11.4 mm (point C2 in Figure 4) and (d) 25.1 mm (point D2 in Figure 4). 



- 36 - 

 

 

 
Figure 8. Contour of the maximum principal strains on a deformed (Ã—30) mesh for 

(a) Model A and (b) Model B. 

 

 

 

 

 

 

 

 

 



- 37 - 

 

 

 

Figure 9. Comparison of the global response of the Via Martoglio masonry wall as 

obtained by different numerical approaches.   

 

  



- 38 - 

 

 

 
Figure 10. Part of the mesh used with average element size of (a) â„ğ‘’ğ‘’ = 150 ğ‘šğ‘šğ‘šğ‘š, (b) 

â„ğ‘’ğ‘’ = 75 ğ‘šğ‘šğ‘šğ‘š. 

  



- 39 - 

 

 

 
 

Figure 11. Base shear versus horizontal displacement at the top right corner of the 

structure using a mesh with different element size. 

 



- 40 - 

 

 

 
Figure 12. Contours of (a) tensile damage, (b) maximum principal strains on a de-

formed (Ã—40) mesh for a displacement at the top right corner of 37 mm. Top row:  un-

structured mesh with average element size of 150 mm, Bottom row: unstructured mesh 

with average element size of 75 mm. 

  



- 41 - 

 

 

 

 

Figure 13. Structured mesh used in the mesh-bias sensitivity analysis. 

  



- 42 - 

 

 

 

Figure 14. Simulation of Model A using the proposed crack-tracking algorithm. (a) 

Tensile damage and (b) maximum principal strains using the unstructured mesh for a 

horizontal displacement of 20.9 mm (Point 1 in Figure 11). (c) Tensile damage and (d) 

maximum principal strains using the structured mesh for a horizontal displacement of 

21.2 mm (Point 2 in Figure 11). 

 



- 43 - 

 

 

 

Figure 15. Simulation of Model A using the classical smeared crack approach. (a) Ten-

sile damage and (b) maximum principal strains using the unstructured mesh for a hori-

zontal displacement of 15.4 mm (Point 3 in Figure 11). (c) Tensile damage and (d) max-

imum principal strains using the structured mesh for a horizontal displacement of 15.5 

mm (Point 4 in Figure 11). 

  



- 44 - 

 

 

 

Figure 16. Base shear versus horizontal displacement at the top right corner of the 

structure using two different meshes (structured and unstructured), with and without the 

proposed crack-tracking algorithm. 

 

 

 

 

 

 

 

 

 

 

 



- 45 - 

 

 

9.  References 

Addessi, D, D Liberatore, and R Masiani. 2015. â€œForce-Based Beam Finite Element 

(FE) for the Pushover Analysis of Masonry Buildings.â€ International Journal of Architec-

tural Heritage 9 (3). Taylor & Francis: 231â€“43. doi:10.1080/15583058.2013.768309. 

Bazant, Z., and B. Oh. 1983. â€œCrack Band Theory for Fracture of Concrete.â€ Materials 

and Structures 16: 155â€“77. doi:10.1007/BF02486267. 

Beyer, K., and A. Dazio. 2012. â€œQuasi-Static Cyclic Tests on Masonry Spandrels.â€ 

Earthquake Spectra 28 (3). Earthquake Engineering Research Institute: 907â€“29. 

doi:10.1193/1.4000063. 

Block, P., and L. Lachauer. 2013. â€œThree-Dimensional (3D) Equilibrium Analysis of 

Gothic Masonry Vaults.â€ International Journal of Architectural Heritage 8 (3): 312â€“35. 

doi:10.1080/15583058.2013.826301. 

Brencich, A, L Gambarotta, and S Lagomarsino. 2000. â€œCatania Project: Research on 

the Seismic Response of Two Masonry Buildings. Chapter 6: Analysis of a Masonry 

Building in Via Martoglio.â€ CNR Gruppo Nazionale per La Difesa Dei Terremoti, 107â€“

43. 

Carvalho, J., J. Ortega, P. B. LourenÃ§o, L. F. Ramos, and H. Roman. 2014. â€œSafety 

Analysis of Modern Heritage Masonry Buildings: Box-Buildings in Recife, Brazil.â€ En-

gineering Structures 80. Elsevier Ltd: 222â€“40. doi:10.1016/j.engstruct.2014.09.004. 

Castellazzi, G., A. M. Dâ€™Altri, S. de Miranda, and F. Ubertini. 2017. â€œAn Innovative 

Numerical Modeling Strategy for the Structural Analysis of Historical Monumental 

Buildings.â€ Engineering Structures 132. Elsevier Ltd: 229â€“48. doi:10.1016/j.eng-

struct.2016.11.032. 



- 46 - 

 

 

Cervera, M., J. Oliver, and R. Faria. 1995. â€œSeismic Evaluation of Concrete Dams via 

Continuum Damage Models.â€ Earthquake Engineering & Structural Dynamics 24 (9): 

1225â€“45. http://onlinelibrary.wiley.com/doi/10.1002/eqe.4290240905/abstract. 

Cervera, M., and M. Chiumenti. 2006. â€œSmeared Crack Approach: Back to the Origi-

nal Track.â€ International Journal for Numerical and Analytical Methods in Geomechanics 

30 (12): 1173â€“99. doi:10.1002/nag.518. 

Cervera, M., L. PelÃ , R. Clemente, and P. Roca. 2010. â€œA Crack-Tracking Technique 

for Localized Damage in Quasi-Brittle Materials.â€ Engineering Fracture Mechanics 77 

(13). Elsevier Ltd: 2431â€“50. doi:10.1016/j.engfracmech.2010.06.013. 

Cervera, M., M. Chiumenti, and R. Codina. 2010. â€œMixed Stabilized Finite Element 

Methods in Nonlinear Solid Mechanics. Part II: Strain Localization.â€ Computer Methods 

in Applied Mechanics and Engineering 199 (37â€“40). Elsevier B.V.: 2571â€“89. 

doi:10.1016/j.cma.2010.04.005. 

Chaboche, J. L. 1988. â€œContinuum Damage Mechanics: Part Iâ€”General Concepts.â€ 

Journal of Applied Mechanics 55 (1). American Society of Mechanical Engineers: 59. 

doi:10.1115/1.3173661. 

COMET. 2016. â€œCoupled Mechanical and Thermal Analysis, 

Http://www.cimne.com/comet/.â€ Barcelona. http://www.cimne.com/comet/. 

D.M.14/01/2008. 2008. â€œApprovazione Delle Nuove Norme Tecniche per Le 

Costruzioni.â€ Rome, Italy. 

Faria, R., J. Oliver, and M. Cervera. 1998. â€œA Strain-Based Plastic Viscous-Damage 

Model for Massive Concrete Structures.â€ International Journal of Solids and Structures 

35 (14): 1533â€“58. doi:10.1016/S0020-7683(97)00119-4. 

http://onlinelibrary.wiley.com/doi/10.1002/eqe.4290240905/abstract
http://www.cimne.com/comet/


- 47 - 

 

 

Gambarotta, L., and S. Lagomarsino. 1997a. â€œDamage Models for the Seismic Re-

sponse of Brick Masonry Shear Walls. Part I: The Mortar Joint Model and Its Applica-

tions.â€ Earthquake Engineering and Structural Dynamics 26 (4): 423â€“39. http://www.sco-

pus.com/inward/record.url?eid=2-s2.0-0031126521&partnerID=tZOtx3y1. 

Gambarotta, L., and S. Lagomarsino. 1997b. â€œDamage Models for the Seismic Re-

sponse of Brick Masonry Shear Walls. Part Iâ€¯: The Mortar Joint Models and Its Applica-

tions.â€ Earthquake Engineering and Structural Dynamics 26 (March 1996): 423â€“39. 

doi:10.1002/(SICI)1096-9845(199704)26:4<441::AID-EQE651>3.0.CO;2-0. 

GiD. 2016. â€œThe Personal Pre and Post-Processor, Http://www.gidhome.com/.â€ Bar-

celona. http://www.gidhome.com/. 

JÃ¤ger, P., P. Steinmann, and E. Kuhl. 2008. â€œModeling Three-Dimensional Crack 

Propagation-A Comparison of Crack Path Tracking Strategies.â€ International Journal for 

Numerical Methods in Engineering 76 (9): 1328â€“52. doi:10.1002/nme.2353. 

Lagomarsino, S., A. Penna, A. Galasco, and S. Cattari. 2013. â€œTREMURI Program: 

An Equivalent Frame Model for the Nonlinear Seismic Analysis of Masonry Buildings.â€ 

Engineering Structures 56. Elsevier Ltd: 1787â€“99. doi:10.1016/j.engstruct.2013.08.002. 

Lemos, J.V. 2007. â€œDiscrete Element Modeling of Masonry Structures.â€ International 

Journal of Architectural Heritage 1 (2): 190â€“213. doi:10.1080/15583050601176868. 

LourenÃ§o, P. B., and J. G. Rots. 1997. â€œMultisurface Interface Model for Analysis of 

Masonry Structures.â€ Journal of Engineering Mechanics 123 (7): 660â€“68. 

doi:10.1061/(ASCE)0733-9399(1997)123:7(660). 

LourenÃ§o, P. B. 2002. â€œComputations on Historic Masonry Structures.â€ Progress in 

Structural Engineering and Materials 4 (3): 301â€“19. doi:10.1002/pse.120. 



- 48 - 

 

 

Lubliner, J., J. Oliver, S. Oller, and E. OÃ±ate. 1989. â€œA Plastic-Damage Model for 

Concrete.â€ International Journal of Solids and Structures 25 (3): 299â€“326. 

doi:10.1016/0020-7683(89)90050-4. 

Macorini, L., and B. A. Izzuddin. 2011. â€œA Non-Linear Interface Element for 3D 

Mesoscale Analysis of Brick-Masonry Structures.â€ International Journal for Numerical 

Methods in Engineering 85 (12): 1584â€“1608. doi:10.1002/nme.3046. 

Magenes, G., and G.M. Calvi. 1996. â€œProspettive per La Calibrazione Di Metodi 

Semplificati per Lâ€™analisi Sismica Di Pareti Murarie.â€ In Atti Del Convegno Nazionale 

â€œLa Meccanica Delle Murature Tra Teoria E Progetto,â€ edited by Pitagora Ed. Messina, 

Italy. 

McInerney, J., and M. DeJong. 2015. â€œDiscrete Element Modeling of Groin Vault Dis-

placement Capacity.â€ International Journal of Architectural Heritage 9 (8): 1037â€“49. 

doi:10.1080/15583058.2014.923953. 

Milani, G., P.B. LourenÃ§o, and A. Tralli. 2006. â€œHomogenised Limit Analysis of Ma-

sonry Walls, Part II: Structural Examples.â€ Computers & Structures 84 (3â€“4): 181â€“95. 

doi:10.1016/j.compstruc.2005.09.004. 

Milani, G.. 2013. â€œLesson Learned after the Emilia-Romagna, Italy, 20â€“29 May 2012 

Earthquakes: A Limit Analysis Insight on Three Masonry Churches.â€ Engineering Failure 

Analysis 34 (December). Elsevier Ltd: 761â€“78. doi:10.1016/j.engfailanal.2013.01.001. 

Molins, C., and P. Roca. 1998. â€œCapacity of Masonry Arches and Spatial Frames.â€ 

Journal of Structural Engineering 124 (6): 653â€“63. doi:10.1061/(ASCE)0733-

9445(1998)124:6(653). 



- 49 - 

 

 

Page, A. W. 1978. â€œFinite Element Model for Masonry.â€ Journal of the Structural Di-

vision 104 (8). ASCE: 1267â€“85. 1979. â€œA Model for the In-Plane Behaviour of Masonry 

and a Sensitivity Analysis of Its CriticaI Parameters.â€ In 5th International Brick Masonry 

Conference, 262â€“67. 

Page, Adrian W. 1979. â€œA Model for the In-Plane Behaviour of Masonry and a Sensi-

tivity Analysis of Its CriticaI Parameters.â€ In 5th International Brick Masonry Confer-

ence, 262â€“67. 

Papa, E. 1996. â€œA Unilateral Damage Model for Masonry Based on a Homogenisation 

Procedure.â€ Mechanics of Cohesive-Frictional Materias 1 (February): 349â€“66. 

Papastamatiou, D., and l. Psycharis. 1993. â€œSeismic Response of Classical Monu-

ments-a Numerical Perspective Developed at the Temple of Apollo in Bassae, Greece.â€ 

Terra Nova 5 (6): 591â€“601. doi:10.1111/j.1365-3121.1993.tb00309.x. 

Parisi, F., and N. Augenti. 2013. â€œSeismic Capacity of Irregular Unreinforced Masonry 

Walls with Openings.â€ Earthquake Engineering & Structural Dynamics 42 (1): 101â€“21.  

Parisi, F., N. Augenti, and A. Prota. 2014. â€œImplications of the Spandrel Type on the 

Lateral Behavior of Unreinforced Masonry Walls.â€ Earthquake Engineering & Structural 

Dynamics 43 (12): 1867â€“87. doi:10.1002/eqe.2441. 

PelÃ , L., M. Cervera, and Pere Roca. 2011. â€œContinuum Damage Model for Ortho-

tropic Materials: Application to Masonry.â€ Computer Methods in Applied Mechanics and 

Engineering 200 (9â€“12): 917â€“30. doi:10.1016/j.cma.2010.11.010. 

PelÃ , L., J. Bourgeois, P. Roca, M. Cervera, and M. Chiumenti. 2014a. â€œAnalysis of 

the Effect of Provisional Ties on the Construction and Current Deformation of Mallorca 

Cathedral.â€ International Journal of Architectural Heritage in press (doi: 



- 50 - 

 

 

10.1080/15583058.2014.996920). Taylor & Francis. 

doi:10.1080/15583058.2014.996920. 

PelÃ , L., M. Cervera, S. Oller, and M. Chiumenti. 2014b. â€œA Localized Mapped Dam-

age Model for Orthotropic Materials.â€ Engineering Fracture Mechanics 124â€“125: 196â€“

216. doi:10.1016/j.engfracmech.2014.04.027. 

Petracca, M., L. PelÃ , R. Rossi, S. Oller, G. Camata, and E. Spacone. 2015. â€œRegular-

ization of First Order Computational Homogenization for Multiscale Analysis of Ma-

sonry Structures.â€ Computational Mechanics, December. doi:10.1007/s00466-015-1230-

6. 

Petracca, M., L. PelÃ , R. Rossi, S. Oller, G. Camata, and E. Spacone. 2017. â€œMultiscale 

Computational First Order Homogenization of Thick Shells for the Analysis of out-of-

Plane Loaded Masonry Walls.â€ Computer Methods in Applied Mechanics and Engineer-

ing 315: 273â€“301. doi:10.1016/j.cma.2016.10.046. 

Petromichelakis, Y., S. Saloustros and L. PelÃ . 2014. â€œSeismic Assessment of Histor-

ical Masonry Construction Including Uncertainty.â€ In Proceedings of EuroDyn 2014, ed-

ited by Ãlvaro Cunha, Elsa Caetano, Pedro Ribeiro, Costas Papadimitriou, Carlos 

Moutinho, and Filipe MagalhÃ£es.  

Rabczuk, T. 2012. â€œComputational Methods for Fracture in Brittle and Quasi-Brittle 

Solidsâ€¯: State-of-the-Art Review and Future Perspectives.â€ ISRN Applied Mathematics 

2013: 1â€“61. doi:10.1155/2013/849231. 

Roca, P., M. Cervera, G. Gariup, and L. PelÃ . 2010. â€œStructural Analysis of Masonry 

Historical Constructions. Classical and Advanced Approaches.â€ Archives of Computa-

tional Methods in Engineering 17 (3): 299â€“325. doi:10.1007/s11831-010-9046-1. 



- 51 - 

 

 

Roca, P., M. Cervera, L. PelÃ , R. Clemente, and Michele Chiumenti. 2013. â€œContin-

uum FE Models for the Analysis of Mallorca Cathedral.â€ Engineering Structures 46. Else-

vier Ltd: 653â€“70. doi:10.1016/j.engstruct.2012.08.005. 

Saloustros, S., L. PelÃ , P. Roca, and J. Portal. 2014. â€œNumerical Analysis of Structural 

Damage in the Church of the Poblet Monastery.â€ Engineering Failure Analysis 48. Else-

vier Ltd: 41â€“61. doi:10.1016/j.engfailanal.2014.10.015. 

Saloustros, S., L.PelÃ , and M. Cervera. 2015. â€œA Crack-Tracking Technique for Lo-

calized Cohesive-Frictional Damage.â€ Engineering Fracture Mechanics 150: 96â€“114. 

doi:10.1016/j.engfracmech.2015.10.039. 

Saloustros, S., L PelÃ , M Cervera, and P Roca. 2016a. â€œA Macro-Modelling Finite 

Element Technique for the Realistic Simulation of Cracking in Masonry Structures.â€ 

Structural Analysis of Historical Constructions - Anamnesis, Diagnosis, Therapy, Con-

trols, no. 2010: 284â€“90. 

Saloustros, S., L. PelÃ , M. Cervera, and P. Roca. 2016b. â€œFinite Element Modelling of 

Internal and Multiple Localized Cracks.â€ Computational Mechanics. Springer Berlin Hei-

delberg. doi:10.1007/s00466-016-1351-6. 

Sarhosis, V., and Y. Sheng. 2014. â€œIdentification of Material Parameters for Low Bond 

Strength Masonry.â€ Engineering Structures 60. Elsevier Ltd: 100â€“110. doi:10.1016/j.eng-

struct.2013.12.013. 

Slobbe, A.T., M.a.N. Hendriks, and J.G. Rots. 2014. â€œSmoothing the Propagation of 

Smeared Cracks.â€ Engineering Fracture Mechanics 132 (December). Elsevier Ltd: 147â€“

68. doi:10.1016/j.engfracmech.2014.10.020. 



- 52 - 

 

 

Theodossopoulos, D., and B. Sinha. 2013. â€œA Review of Analytical Methods in the 

Current Design Processes and Assessment of Performance of Masonry Structures.â€ Con-

struction and Building Materials 41: 990â€“1001. doi:10.1016/j.conbuildmat.2012.07.095. 

Trovalusci, P., and R. Masiani. 2003. â€œNon-Linear Micropolar and Classical Continua 

for Anisotropic Discontinous Materials.â€ International Journal of Solids and Structures 

40 (5): 1281â€“97. doi:10.1016/S0020-7683(02)00584-X. 

 


	1.  Introduction
	2.  Continuum damage macro-model
	2.1 Constitutive equation
	2.2 Damage criteria

	3.  The local crack-tracking algorithm
	4.  Numerical Simulation of a large-scale wall
	4.1 Model Aâ€“ Flexible Diaphragm
	4.2 Model B â€“ Stiff Diaphragm
	4.3 Discussion of the diaphragm effect on the structural response
	4.4 Comparison with other approaches
	4.5 Mesh dependency
	4.5.1 Mesh-size dependency
	4.5.2 Mesh-bias dependency


	5.  Conclusions
	Acknowledgments
	6.  Figure Captions
	7.  Tables
	8.  Figures
	9.   References

