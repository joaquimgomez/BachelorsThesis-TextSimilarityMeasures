






























































Computational material design for acoustic cloaking


INTERNATIONAL JOURNAL FOR NUMERICAL METHODS IN ENGINEERING
Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
Published online 27 June 2017 in Wiley Online Library (wileyonlinelibrary.com). DOI: 10.1002/nme.5560

Computational material design for acoustic cloaking

Carlos Gustavo M√©ndez1, Juan Manuel Podest√°2, Oriol Lloberas-Valls3,4,
Sebasti√°n Toro2, Alfredo Edmundo Huespe2,3*,‚Ä† and Javier Oliver3,4

1CIMNE-Latinoam√©rica, Iturraspe 785 Santa Fe, CP 3000, Argentina
2CIMEC-UNL-CONICET, Predio Conicet Dr Alberto Cassano, Santa Fe, CP 3000, Argentina

3Centre Internacional de Metodes Numerics en Enyinyeria (CIMNE), Campus Nord UPC, Barcelona, Spain
4E.T.S dEnginyers de Camins, Canals i Ports, Technical University of Catalonia (Barcelona Tech) Campus Nord UPC,

M√≤dul C-1, c/ Jordi Girona 1-3 Barcelona, 08034, Spain

SUMMARY

A topology optimization technique based on the topological derivative and the level set function is utilized to
design/synthesize the microstructure of a pentamode material for an acoustic cloaking device. The technique
provides a microstructure consisting of a honeycomb lattice composed of needle-like and joint members.
The resulting metamaterial shows a highly anisotropic elastic response with effective properties displaying
a ratio between bulk and shear moduli of almost three orders of magnitude. Furthermore, in accordance
with previous works in the literature, it can be asserted that this kind of microstructure can be realistically
fabricated. The adoption of a topology optimization technique as a tool for the inverse design of metama-
terials with applications to acoustic cloaking problems is one contribution of this paper. However, the most
important achievement refers to the analysis and discussion revealing the key role of the external shape of
the prescribed domain where the optimization problem is posed. The efficiency of the designed microstruc-
ture is measured by comparing the scattering wave fields generated by acoustic plane waves impinging on
bare and cloaked bodies. Copyright ¬© 2017 The Authors. International Journal for Numerical Methods in
Engineering Published by John Wiley & Sons Ltd.

Received 29 December 2016; Revised 2 March 2017; Accepted 31 March 2017

KEY WORDS: transformation acoustic applications; acoustic cloak; pentamode material; topological
derivative; topology optimization; extremal material

1. INTRODUCTION

New methodologies to fabricate metamaterials open a wide range of interesting applications
in engineering and science. In this context, the goal is to design and manipulate architectured
microstructures to develop new materials with exotic mechanical, optical, acoustical, or thermal
properties [1‚Äì3]. These metamaterials are envisaged to satisfy specifically given requirements at the
macro-structure scale level.

For example, making an object invisible to sound waves can be achieved by covering it with an
appropriately designed layer of material having extreme and highly anisotropic elastic properties.
Following this kind of approach, one technique to get acoustic cloaking is based on the coordinate
transformation method, reported by Norris [4], whereby the material properties of the cloak copy
the geometrical coefficients of an adequate space (singular) transformation. Norris has generalized
the key observation of Pendry et al. [5] to acoustic wave problems. Pendry et al. have shown that

*Correspondence to: Alfredo Edmundo Huespe, CIMEC-UNL-CONICET, Predio Conicet Dr Alberto Cassano, CP 3000
Santa Fe, Argentina.

‚Ä†E-mail: ahuespe@intec.unl.edu.ar
This is an open access article under the terms of the Creative Commons Attribution License, which permits use,
distribution and reproduction in any medium, provided the original work is properly cited.

Copyright ¬© 2017 The Authors. International Journal for Numerical
Methods in Engineering Published by John Wiley & Sons Ltd.

http://orcid.org/0000-0001-7239-9805
http://creativecommons.org/licenses/by/4.0/


1354 C. MENDEZ ET AL.

metamaterials can be designed at will, by adopting singular coordinate transformations, to redirect
electromagnetic waves and, therefore, attaining optical cloaking devices.

According to Norris, metamaterials for cloaking systems based on transformation acoustic can be
categorized into two broad classes: materials requiring anisotropic inertial mass densities, identified
with inertial cloaking devices (see [6] for realizations of this type of metamaterial), and materials
requiring anisotropic bulk moduli. Realizations of this last type of metamaterials can be reached
through pentamode materials.

Pentamode materials have been initially proposed by Milton and Cherkaev [7]. These materials
are usually formed by truncated cones, similar to bars, and joints, which are spatially distributed as
a Bravais lattice.

Layman et al.[8] have developed a design methodology for pentamode materials employed in
acoustic cloaking devices. In their approach, these authors use a methodology where the microstruc-
ture topology is prescribed beforehand, that is, the microstructure has a pre-defined architecture.
The dimensions and geometrical position of each member constituting the microstructure are
parametrized. The most convenient set of parameters is then determined through a nonlinear pro-
gramming algorithm, such that the effective elastic properties are adjusted to those values required
by the analysis of Norris.

Additionally, pentamode materials have been fabricated and reported by Kadic et al. [9]. A number
of issues concerning the material processing are addressed in [9]. An important conclusion reported
in this paper, closely connected with the present work, is that in order to allow genuine pentamode
material realizations, the members constituting the microstructure have to be neither pin-jointed nor
rigid-jointed.

The main objective of the present paper is to contribute to computational design/synthesis of
pentamode material, constituted by highly heterogeneous microstructures, aiming to build acoustic
cloaking devices. The question that has to be solved is how to distribute and combine the material
within a prescribed domain to obtain the desired properties of the composite for building the cloaking
device.

To solve this inverse design problem, we use a technique based on a topology optimization algo-
rithm. Starting from the seminal paper of Bendsoe et al. [10] on topology optimization, there have
been a huge number of well-known and established inverse techniques for material microstructure
design based on topology optimization. The book of Bendsoe and Sigmund [11] and, more recently,
the review paper by Sigmund et al.[12] give excellent overviews of different approaches that can
be found in the literature. Furthermore, a more specific discussion of topics here addressed can be
found in the recent review by Osanov et al. [13] and the references cited therein. It is important to
mention that these kinds of techniques provide a detailed description of the material microstructure
without preconceiving beforehand any kind of micro-architecture.

In this work, we adopt the topology optimization algorithm previously presented by [14], which
uses a level set function and the topological derivative concept. This algorithm has been enhanced
in posterior contributions of Amstutz and co-authors and successfully applied to a series of topol-
ogy optimization problems, such as microstructure inverse design [15], structural design subjected
to stress constraints [16], and design of piezoelectric actuators [17]. Furthermore, based on the con-
tributions in [18], where an expression of topological derivatives in the three-dimensional space has
been presented, this kind of algorithm can be extended to solve 3D topology optimization problems.
Synthesis of 3D microstructures utilizing topological derivatives has been shown in [19].

The Amstutz‚Äôs algorithm is here adapted to seek the microstructure topology of a material which
effective elasticity tensor is equal to the target tensor given by Norris‚Äôs analysis. It is shown that the
Amstutz‚Äôs algorithm, with some minor modifications introduced in the present contribution, turns to
be an adequate technique for designing pentamode materials for acoustic cloaking.

Also, we analyze an important aspect of topology optimization techniques for designing metama-
terials, which has not been particularly discussed in the literature. It refers to the relationship between
the symmetry of the material to be synthesized and the external shape of the prescribed domain
where the optimization problem is posed. Our results demonstrate that the external shape plays an
important role in obtaining optimal micro-architecture designs. We propose a procedure to appro-
priately define this external shape. Conclusions extracted from this discussion can be extended to
more general metamaterial inverse design problems using these techniques; provided that the effec-

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1355

tive properties of the target material satisfy given symmetry requirements. Discussion of this point
is one of the main achievements of the present paper.

A brief description of the topics covered in this paper is the following. First, in Section 2, some
pentamode material properties are highlighted. These properties are subsequently utilized in the
context of Norris‚Äôs method. A reminder of this method is briefly presented in Appendix A. Also, in
the same Appendix, the elasticity tensors reported in [20] are described and briefly summarized in
sub-Section 2.1. These elasticity tensors are the target ones adopted in this work for the pentamode
material inverse design.

In Section 3, a sketch of the topology optimization problem utilized for the microstructure syn-
thesis of the acoustic cloaking device is presented. A more detailed description of this procedure is
shown in Appendix B.

The topology optimization algorithm described in Appendix B is validated in Section 4. The val-
idation test consists of synthesizing an extremal metamaterial having a high ratio between the bulk
and shear moduli.

The procedure for designing the microstructure of the acoustic device is addressed in Section 5.
The so-designed microstructure is virtually tested through computational simulation of the scattered
wave field produced by means of a cloaked object immersed in a fluid. The result is compared with
the field produced by the same bare object.

Finally, in Section 6, some conclusions are addressed.

2. A PENTAMODE MATERIAL

A Pentamode material is a class of extremal material having five easy (compliant) modes of defor-
mation in a three-dimensional space, and having only one non-easy (hard) mode of deformation.
The elasticity tensor of this material has one non-null eigenvalue and five null eigenvalues (hence
the name of pentamode given to this class of material). For example, a compressible inviscid fluid
(ideal gas) is a pentamode material, where shear strains in any directions represent easy modes of
deformations, while volumetric strains represent hard modes of deformation. Milton and Cherkaev
[7] have coined the name of pentamode materials in the context of linear elasticity, see also [21]
where additional properties of this type of materials are analyzed.

Pentamode materials are a special class of linear anisotropic elastic solids. They can be character-
ized through elasticity tensors represented by:

CÃÇ = ùúÖ‚ãÜS‚äó S ; (1)

where ùúÖ‚ãÜ is a pseudo-bulk modulus with the dimensions of stress and S is an adimensional symmetric
second order tensor with norm not necessarily equal to one. As usual, the symbol ‚äó denotes the
tensorial product.

Pentamode materials are useful for constructing acoustic cloaking devices. These devices require
a particular heterogeneous distribution of properties characterized by ùúÖ‚ãÜ and S. In particular, for

Figure 1. Acoustic cloaking problem. (a) Polar coordinate system; (b) domain of analysisBwith a cylindrical
object immersed in the fluid; and (c) cylindrical object with a cloaking device.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1356 C. MENDEZ ET AL.

cylindrical acoustic cloaking devices, it can be considered a rotationally symmetric pattern of mate-
rial properties in the plane (X1,X2), schematized in Figure 1-(a)‚Ä°, where the tensor S could be defined
in a rather general context by:

S =
‚àö

ùúÖr

ùúÖ‚ãÜ
(er ‚äó er) +

‚àö
ùúÖùúÉ

ùúÖ‚ãÜ
(eùúÉ ‚äó eùúÉ); (2)

er and eùúÉ being the radial and circumferential unit vectors related to the polar coordinate system.
The material properties, ùúÖr(X) and ùúÖùúÉ(X) are seen as the radial and circumferential bulk moduli,
respectively. Additionally, S satisfies a self-equilibrium condition: divXS = 0¬ß(note, however, that S
is not a stress).

By adopting Voigt ¬∂ notation for describing tensors of second and fourth order in the coordinate
system defined by the basis {er, eùúÉ}, the strain and stress tensors in this case, removing the out-of-
plane component, result in ùú∫ = [ùúÄr, ùúÄùúÉ, 2ùúÄrùúÉ]T and ùùà = [ùúér, ùúéùúÉ, ùúérùúÉ]T, while the elasticity tensor CÃÇ
defined in Equation (1) (S given by Equation (2)) is represented in the same basis by the matrix:

CÃÇ =
‚é°‚é¢‚é¢‚é£

ùúÖr
‚àö
ùúÖrùúÖùúÉ 0‚àö

ùúÖrùúÖùúÉ ùúÖùúÉ 0
0 0 0

‚é§‚é•‚é•‚é¶ . (3)
The equation of motion in a solid composed of this particular pentamode material is derived as

follows. The constitutive equation and the momentum balance equation for the solid are given by:

ùùà = CÃÇ ‚à∂ ùú∫ = ùúÖ‚ãÜ(S ‚à∂ ùú∫)S = ‚àípÃÇS , (4)

ùùÜ‚ãÜ ¬∑ uÃà = divXùùà = ‚àíS ¬∑ ‚àáX pÃÇ , (5)

where u, ùú∫ and ùùà are the displacements, strain and stress fields, respectively, and

pÃÇ = ‚àíùúÖ‚ãÜ(S ‚à∂ ùú∫) (6)

is a pseudo-pressure scalar term. In (4), the trace of the tensorial product between the two second
order tensors is denoted by the symbol (‚à∂), while the symbol (¬∑) indicates the contraction of one
index of the tensorial product. In accordance with (4), only stresses proportional to S, with the pro-
portionality factor given by pseudo-pressures, can be held by this material. The momentum balance
Equation (5) is written assuming that the inertial mass density, ùùÜ‚ãÜ, is a generalized second order
tensor, not necessarily a spherical one.

After replacing the conventional kinematical compatibility condition ùú∫ = 1
2
(‚àáX(u) + ‚àáTX(u)) in

Equation (4), deriving in time and replacing (5) into (4), a wave propagation equation in terms of the
pseudo-pressure field pÃÇ can be derived as follows:

ÃàÃÇp ‚àí ùúÖ‚ãÜ S ‚à∂ ‚àáX
(
(ùùÜ‚ãÜ)‚àí1 ¬∑ S ¬∑ ‚àáXpÃÇ

)
= 0 . (7)

2.1. Pentamode material for acoustic cloaking devices

Next, let us consider a cylindrical object of radius r = a immersed in a fluid occupying the infinite
domainB. The object is subjected to an incident plane wave propagating from left to right, as sketched

‚Ä°In the following, we preserve the name of pentamode material for plane (two-dimensional) problems. Removing the
third dimension and the out-of-plane field components, the elasticity tensor has only three eigenvalues. Particularizing
the same concept of pentamode material, two of these eigenvalues are related to compliant modes of deformation and
only one is related to a hard mode. Strictly, this material should be called bi-mode material.

¬ßIn this work, the gradient and divergence operators are denoted by‚àáX(¬∑) and divX(¬∑), respectively. Subindex X emphasizes
the coordinate system where they are evaluated.

¬∂Voigt or tensorial notation are used indistinctly in this paper. The proper context of every equation determines which
specific notation is used.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1357

in Figure 1-(b). The fluid is characterized by a bulk modulus ùúÖ0 and density ùúå0. We address the
problem of designing the pentamode material placed in the circular ring Œ©, with exterior radius r = b
and thickness b‚àía, acting as the acoustic cloaking device for the cylindrical object, see Figure 1-(c).

Equation (7) is utilized in the transformation acoustic analysis by Norris and co-authors ([4] and
[20]) to define the properties ùúÖ‚ãÜ, ùùÜ‚ãÜ and S of a pentamode material which is used to built an acoustic
cloaking device adapted for a cylindrical object. Appendix A briefly summarizes Norris‚Äôs analysis
by which the pentamode material parameters for solving this problem are determined. The princi-
pal equations being necessary for the following development of the paper are also summarized in
Appendix A and have been taken from [20].

Considering the large set of possible maps defining a useful coordinate transformation for this
problem, the contribution in [20] defines one transformation preserving the isotropy of the inertial
mass density, while keeping the elastic anisotropic properties to a bare minimum (see Appendix
A). According to these authors, by adopting this particular transformation map and then copying
the elastic coefficients of the pentamode material to the geometrical parameters induced by the
transformation, the bulk moduli and the inertial mass density of this material result in:

ùúÖ
‚ãÜ = ùúÖ0

1
f ‚Ä≤(r)

(
r

f (r)

)
, ùúÖr = ùúÖo

1
f ‚Ä≤(r)

(
f (r)

r

)
, ùúÖùúÉ = ùúÖof ‚Ä≤(r)

(
r

f (r)

)
(8)

ùùÜ‚ãÜ = ÔøΩÃÇÔøΩ1 , ÔøΩÃÇÔøΩ = ùúåof ‚Ä≤(r)
(

f (r)
r

)
, (9)

where r is the radial coordinate as shown in Figure 1-(b). The function f(r), defining the coordinate
transformation map, is given by:

f (r) =

{(
b2‚àíaŒ¥
b2‚àía2

r ‚àí a‚àíŒ¥
b2‚àía2

b2 a
r

)
; a ‚©Ω r ‚©Ω b

r; r ‚©æ b
(10)

with Œ¥ being a geometrical parameter whose meaning is discussed in Appendix A. Note that, defin-
ing 1 as the unit tensor, ùùÜ‚ãÜ results in a spherical tensor retrieving the concept of an isotropic inertial
mass density. Figure 2-(a) plots the function f(r) for Œ¥ = 0.333a and b = 2a, while Figure 2-(b)
plots the corresponding normalized material properties described in Equations (8) and (9) as a
function of the radial coordinate.

Figure 2. (a) Plot of the function f(r) taken from [20]. This function defines the coordinate transforma-
tion which is adequate for designing a cylindrical acoustic cloaking layer with minimal elastic anisotropy.
(b) Normalized material properties of expressions (8) and (9), derived from the coordinate transformations
(A.4)- (A.6) (Appendix A) and the parameter Œ¥ = 0.333a. The normalization factors are the fluid properties.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1358 C. MENDEZ ET AL.

Figure 3. Multiscale material model of a composite with two phases: M1 and M2. Computational homoge-
nization approach to determine ùùà(ùú∫).

Then, from expression (3), the elasticity tensor of a pentamode material, whose properties are
given by (8) and (9), is defined by:

CÃÇ = ùúÖo

‚é°‚é¢‚é¢‚é¢‚é£
1

f ‚Ä≤(r)

(
f (r)

r

)
1 0

1 f ‚Ä≤(r)
(

r
f (r)

)
0

0 0 0

‚é§‚é•‚é•‚é•‚é¶
. (11)

3. TOPOLOGY OPTIMIZATION PROBLEM

The design of the material microstructure required by Norris‚Äôs analysis is carried out by defining an
appropriate optimization problem which is described in this Section.

Also in this Section, we study the selection of an adequate external shape of the unit cell in where
the topology optimization problem is placed. Finally, in sub-Section 4, the whole procedure for
solving the topology optimization problem is assessed and validated.

3.1. Synthesis of microstructures as a topology optimization problem

Let us consider a two-phase composite with a periodic microstructure occupying the macro-scale
domain Œ©, such as schematized in Figure 3. One phase is assumed to be very stiff and is denoted
by M1. The other one is assumed to be very compliant and is denoted by M2. It is assumed that
the microstructure characteristic length, ùìÅUC, is much smaller than the characteristic length of the
body ùìÅ‚Äñ.

The effective properties of this composite, subjected to elastic loading regimes, are computed
via a conventional homogenization technique from a unit-cell denoted by Œ©ùúá. This homogenization
technique is briefly explained in Appendix B. The effective elasticity tensor Chom obtained through
this homogenization technique relates the macro-stress field ùùà(x) with the macro-strain field ùú∫(x), as
follows:

ùùà = Chom(Œ©1ùúá) ‚à∂ ùú∫ . (12)

Denoting Œ©1ùúá and Œ©2ùúá the micro-cell domains occupied by phases M1 and M2, respectively, the
argument of Chom remarks its dependence with the material distribution within the unit cell.

‚ÄñIn relation to the acoustic cloaking problem here addressed, ùìÅ can be taken as the cylinder radius.
Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1359

Figure 4. a) Crystal system with orthorhombic symmetry D2. The associated centered rectangular Bravais
lattice has the primitive orthogonal vectors a1 and a2; b) Wigner-Seitz cells (V-Cells) inspiring the selection
of the external boundary shape Œìùúá of the unit-cell used for designing the pentamode material. The vectors

indicating the periodicity directions are depicted.

Let us now consider a unit-cell, with domain Œ©ùúá, defined by its external boundary Œìùúá. The mate-
rial distribution within this domain is determined by solving the following topology optimization
problem:

min
Œ©1
ùúá

J(Œ©1ùúá) = min
Œ©1
ùúá

(||Chom(Œ©1ùúá) ‚àí CÃÇ||2); (13)
where the target tensor CÃÇ is a data of the problem **, while the conventional Frobenius norm || ¬∑ ||
computes the distance between Chom and CÃÇ. In problem (13), minimization of the objective function
J(Œ©1ùúá) is attained by changing the placement of material M1 within the domain delimited by Œìùúá.

The optimal distribution of M1 is found with the topology optimization algorithm proposed by
Amstutz et al. [14] and its extended version [15] particularly adapted to solve inverse material design
problems.

Here, the Amstutz‚Äôs algorithm has been slightly modified to solve the specific problem (13). Some
details of this algorithm are presented in Appendix B, while a more fundamental description of the
original version can be found in the mentioned bibliography.

The algorithm is implemented with linear triangular finite elements. Therefore, linear polynomials
are used to interpolate the level set functions as well as the topological derivative in Œ©ùúá.

3.2. Selecting an appropriate shape of the boundary Œìùúá
The mathematical problem associated with the topology optimization algorithm is defined in a two-
dimensional domain delimited by an external boundary Œìùúá which has to be known in advance. The
selection of an adequate shape of Œìùúá is a particularly important issue whenever composites with
periodic microstructures and showing specific symmetries have to be designed.

In this sub-Section, a guideline for solving this issue is given. The idea is inspired by concepts
taken from crystallography, Bravais lattices and elastic properties of crystals and also exploits the
symmetry shown by the pentamode material.

In 2D problems, it has been demonstrated that there are only four different symmetry classes
for describing any arbitrary elasticity tensors (see [22] and the references cited therein, as well as
[23]). The elasticity tensor CÃÇ of a plane pentamode material, defined in Equation (1), has orthotropic
(orthorhombic) symmetry denoted by D2 in Aufray et al. This kind of symmetry is also a char-
acteristic of the elasticity tensors associated with crystalline structures [24] that have an atomic
distribution placed on the vertices of a (centered rectangular) Bravais lattice having orthogonal prim-
itive vectors a1 and a2, such as shown in Figure 4-(a). The lattice parameter ùúÇ = ||a1||‚àï||a2|| governs
approximately the ratio between the coefficients C11 and C22 of the crystal effective elasticity tensor.

**As it is shown in sub-Section 5.2, the target tensor CÃÇ in the acoustic cloaking design problem is given by equation (11)

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1360 C. MENDEZ ET AL.

Figure 5. Wigner-Seitz cell (V-Cell) for different shape parameters ùúÇ.

We conjecture that the external boundary Œìùúá coincides with the boundary of a unit-cell utilized in
crystallography. In the present case, the unit-cell is taken from a Bravais lattice having orthorhom-
bic symmetry. Figure 4-(b) shows the Wigner-Seitz unit-cell denoted V-Cell (by Voronoi cell) of a
Bravais lattice having this kind of symmetry. It is a non-regular hexagon containing one lattice point
(point 0 in Figure 4-(a)) in the center. The hexagon is built around this point and its sides are the
perpendicular bisectors of the segments joining the central point 0 and all other six closest points in
the lattice (A, B, C, D, E and F in Figure 4-(a)).

According to this conjecture, we use V-Cells to represent the boundaries Œìùúá of generic unit-cells
associated with pentamode materials. The V-Cell external boundary can be described with only one
parameter, such as the lattice parameter ùúÇ. In Figure 5 are shown several Wigner-Seitz unit-cells for
different lattice parameters ùúÇ, denoted from now on as the shape parameter. For ùúÇ =

‚àö
3, the unit-cell

is a regular hexagon, while for ùúÇ = 1, it is a square.
From the previous consideration, an isotropic pentamode material should be represented by a

regular hexagon defined for the shape parameter ùúÇ =
‚àö

3.

4. VALIDATION OF THE DESIGN METHODOLOGY BASED ON TOPOLOGY
OPTIMIZATION

The algorithm presented in Appendix B is validated and assessed through analytical and numerical
solutions taken from Sigmund [25]. The proposed problem for this assessment consists in designing
the microstructure topology of an extremal isotropic two-phase material displaying the maximum
ratio ÔøΩÃÇÔøΩ‚àïGÃÇ, where ÔøΩÃÇÔøΩ and GÃÇ are the effective bulk and shear moduli of the composite. Sigmund has
solved this problem and obtained several microstructures using a topology optimization tool based
on SIMP.

Before presenting the results, a-priori analytical estimations of the bounds for the effective elastic
properties of an isotropic composite are discussed. The analyzed composite is constituted by two-
phases, and the corresponding bounds have been determined by Hill and successively improved by
Hashin-Shtrikman, [26] and [27]. According to the notation utilized by Cherkaev et al., the effective
elasticity tensor of a plane strain elastic isotropic material (using Voigt notation for tensors) can be
written as:

CÃÇ
e
=
‚é°‚é¢‚é¢‚é£

KÃÇ + GÃÇ KÃÇ ‚àí GÃÇ 0
KÃÇ ‚àí GÃÇ KÃÇ + GÃÇ 0

0 0 GÃÇ

‚é§‚é•‚é•‚é¶ , KÃÇ = ÔøΩÃÇÔøΩ + GÃÇ‚àï3 , (14)
where, as indicated above, ÔøΩÃÇÔøΩ and GÃÇ are the effective bulk and shear moduli of the material, and KÃÇ
is the plane strain effective bulk modulus. The Hashin-Strikman bounds for a plane elastic isotropic
composite with two phases, identified in the following with the numbers 1 and 2, having volume
fractions f1, f2 and being characterized by the bulk moduli ùúÖ1 and ùúÖ2 and shear moduli G1 and G2,
respectively, satisfying ùúÖ1 > ùúÖ2 and G1 > G2, are:

KlowHS = K2 +
f1

1
K1‚àíK2

+ f2
K2+G2

; Kupp
HS

= K1 +
f2

1
K2‚àíK1

+ f1
K1+G1

; (15)

GlowHS = G2 +
f1

1
G1‚àíG2

+ f2(K2+2G2)
2G2(K2+G2)

; Gupp
HS

= G1 +
f2

1
G2‚àíG1

+ f1(K1+2G1)
2G1(K1+G1)

. (16)

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1361

Figure 6. Bounds of effective properties for a two-phase isotropic composite according to Hashin-Shtrikman
and Cherkaev et al. Properties of phases 1 and 2 are K1 = 5‚àï7; K2 = K1‚àï20; G1 = 5‚àï13; G2 = G1‚àï20 (units
of moduli in GPa). Volume fraction of phase 1 is f1 = 0.5. The Walpole point is denoted by Wp. Symbols
indicate the effective properties of five microstructures obtained with the topology optimization algorithm.

Then, the effective plane strain bulk and shear moduli, KÃÇ and CÃÇ, of the composite satisfies the
following:

KlowHS ‚©Ω KÃÇ ‚©Ω K
upp
HS

; GlowHS ‚©Ω GÃÇ ‚©Ω G
upp
HS
. (17)

Next, let us consider the case studied by Sigmund consisting in finding the microstructure that pro-
vides the maximum possible ratio ÔøΩÃÇÔøΩ‚àïGÃÇ, agreeing with the analytical estimations of these bounds. In
the analysis of Sigmund, here reproduced, both phases are characterized by K1 = 5‚àï7; K2 = K1‚àï20;
G1 = 5‚àï13; G2 = G1‚àï20 (units of moduli are given in GPa), with the volume fraction f1 = 0.5.
Then, the bounds (15)‚Äì(16) result in Klow

HS
= 0.0830, Kupp

HS
= 0.2235, Glow

HS
= 0.0439, Gupp

HS
= 0.1157.

These bounds are represented in Figure 6(a) coinciding with the green external box. In the same
figure, the curve corresponding to the improved lower limit bound, found by [27], has been plotted.
The Walpole point is denoted by Wp and has also been plotted in the same figure. In accordance with
these improved bounds, the Wp point determines the maximum ratio ÔøΩÃÇÔøΩ‚àïGÃÇ that can be attained with
this type of two-phase composite. For the considered composite, the coordinates of the Wp point are
KÃÇWp = KÃÇ

upp
HS

= 0.2235 and

GWp = G2 +
f1

1
G1‚àíG2

+ f2(K1+2G2)
2G2(K1+G2)

= 0.0503 . (18)

Therefore, from (14), the effective elasticity tensor of the two-phase composite associated to the Wp
point is as follows:

CWp =
‚é°‚é¢‚é¢‚é£

0.2738 0.1732 0
0.1732 0.2738 0

0 0 0.0503

‚é§‚é•‚é•‚é¶ . (19)

4.1. Procedure for designing the extremal material

The problem (13), constrained by the condition f1 = 0.5, determines the optimal microstructure
topology whose homogenized elasticity tensor, Chom, matches the target elasticity tensor: CÃÇ = CWp
of expression (19). This topology optimization problem is solved with the algorithm described in
Boxes 1 and 2 of Appendix B. The constraint fixing the volume fraction is imposed to the problem
(B.9) through an augmented lagrangian technique reported in [28] and [29].

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1362 C. MENDEZ ET AL.

Figure 7. (a) The material distribution within a unit cell has reflection symmetry with the symmetry axes
being 1-1‚Äô, 2-2‚Äô, and 3-3‚Äô. (b) Microstructures obtained with the algorithm of Boxes 1 and 2 (Appendix B).
Elements with negative values of the level set function are in black and show the position where phase M1

is placed.

Because the target elasticity tensor is isotropic (symmetry O(2) according to [22]), the original
domain where the topology optimization algorithm is computed is the regular hexagon shown in
Figure 7. Note that the Wigner-Seitz unit cell of a Bravais lattice with symmetry O(2) is also a
regular hexagon. Additionally, symmetry of the material distribution within the hexagonal unit cell is
imposed by forcing a reflection symmetry of the level-set function with respect to the symmetry axis
1-1, 2-2, and 3-3 shown in Figure 7(a). The symmetry is forced in every iteration of the algorithm,
after computing (B.10) in Loop A of Box 2 in Appendix B and before the normalization of ùúì i+1.

4.2. Results and discussion

Figure 7 shows microstructures 1 to 5 that have been obtained with this methodology, using different
initializations procedures.

Let us consider the obtained homogenized elasticity tensor corresponding to structure 5:

Chom5 =
‚é°‚é¢‚é¢‚é£

0.279 0.161 0.000
0.161 0.279 0.000
0.000 0.000 0.059

‚é§‚é•‚é•‚é¶ . (20)
The effective parameters GÃÉ = C33 and KÃÉ = C11‚àíGÃÉ, computed from (20), are plotted in Figure 6. The
present approach gives a relative difference of 17% between CWp(3, 3) and C

hom
5 (3, 3). Microstructure

5 is notoriously similar to that obtained by Sigmund utilizing the SIMP technique.

5. DESIGN OF THE PENTAMODE MATERIAL FOR ACOUSTIC CLOAKING

By adopting the analytical results of [20], shown in Appendix A, we design the microstructure of
a highly anisotropic pentamode metamaterial used as a layer for diminishing the acoustic wave
scattering caused by a cylinder immersed in fluids.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1363

Figure 8. Scattering reduction layer.

5.1. Problem description

A sketch of the addressed problem is shown in Figure 8. The layer covering the cylinder of radius
r = a has a thickness that is identical to the cylinder radius (b = 2a). The mapping f(r), defining the
coordinate transformation in the analysis of Norris, is given by Equation (10) (see also Appendix A)
with the parameter Œ¥ = 0.333a. With this parameter, the effective scattering cross-sectional area of
the cloaked object has to be similar to that produced by a bare cylinder of radius ar = Œ¥ = 0.333a.

We design 20 unit cells of the graded layer in correspondence with the same quantity of radial
points equally spaced between r = a and r = b = 2a. We assume that the graded layer is composed
of 20 uniform sub-layers, which microstructures are designed with those 20 cells.

The stiff phase of the synthesized material (material M1) is assumed to be aluminum with proper-
ties ùúÖAl = 70.GPa, GAl = 25.5GPa and ùúåAl = 2700.Kg‚àïm3. The soft phase (material M2) is assumed
to be a flexible polymer foam characterized by an isotropic material whose elastic modulus has a
contrast factor ùõæ = 0.00001 times the elastic modulus of the aluminum (taken from [30], pp.51).

5.2. General design procedure

The procedure guiding the design of the microstructures of each sub-layer aims to satisfy point-wise
the following two conditions:

(i) The effective elasticity tensor Chom of the synthesized composite matches the target tensor
CÃÇ defined in (11) for the corresponding sub-layer. Note that this tensor is described in the
coordinate system whose basis is (er, eùúÉ).

(ii) The effective inertial mass density ùúåhom of the same unit cell matches the target inertial mass
density ÔøΩÃÇÔøΩ defined by Equation (9).

Both goals can be attained in two sequential steps. The first step searches the optimal distribution
of phase M1 satisfying the objective described in task (i) without imposing the density constraint.
This problem is formulated as a topology optimization problem and solved with the algorithm of
Appendix B. The solution provides a homogenized density ùúåOT, which is assumed to satisfy ùúåOT < ÔøΩÃÇÔøΩ.
This is a reasonable assumption, which can be satisfied by taking an enough high ratio E1‚àïùúå1 of the
material M1 (aluminum in this case).

In a second step, the micro-cell density is adjusted to ÔøΩÃÇÔøΩ. This objective is attained by filling the
holes (soft phase) with a composite constituted by phase M1 dispersed in phase M2. In this case,
the disperse dense material does not work as a structural component and the effective elasticity is

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1364 C. MENDEZ ET AL.

not substantially modified. We assume that the second step can be easily solved. Therefore, in the
following, we only address the topology optimization problem associated with the first step.

A similar design procedure in two sequential steps has been reported by [9]. To build a pentamode
material, these authors have independently adjusted the effective bulk moduli in a first stage and then
the effective inertial mass density. Additionally, they have proven the fabricability of the so-designed
metamaterial by manufacturing small samples.

5.3. Technique for adjusting the anisotropic bulk moduli

The external boundary Œìùúá delimiting the domain Œ©ùúá, in where the topology optimization problem
is posed, has to be known in advance. Because of the symmetry of the target tensor CÃÇ (orthotropic
symmetry D2), V-Cells with given shape parameters ùúÇ are chosen. In each case, ùúÇ is adjusted for
each sub-layer of the 20 designed cells.

5.4. Influence of the shape parameter ùúÇ on the resulting microstructures

To better understand the role played by the selection of Œìùúá and the shape parameter ùúÇ in the present
design technique, we study the influence of this parameter on the obtained microstructure solution.

Sub-layer number 15 of the acoustic cloaking device is chosen to perform this study. For this
sub-layer, the target elasticity tensor CÃÇ is given by the following expression (Equation (11)):

CÃÇ =
‚é°‚é¢‚é¢‚é£

5.893 2.250 0
2.250 0.859 0

0 0 0

‚é§‚é•‚é•‚é¶ . (21)
V-Cell geometries, as shown in Figure 4, are tested. Then, the optimal solutions of problem (13) are
sought by varying the parameter ùúÇ in the range: 1 ‚©Ω ùúÇ ‚©Ω 8.

In Figure 9(a), the optimal value of J attained for different parameters ùúÇ are plotted. Two finite
element meshes are solved. Results obtained with the coarse mesh (with mmax = 3 and he0 = ùìÅUC‚àï32)
are denoted by (CM), while those obtained with the finest one, mmax = 4, are denoted by (FM). We
recall that mmax defines the number of mesh refinements and h

e
0

is the initial finite element mesh size.
Both parameters have been defined in Box 1 (Appendix B). The finite element size of the finest mesh
is half of that of the coarse mesh.

In the same figure, the effective elasticity tensor component Chom
33

and the homogenized inertial
mass density ùúåOT of the designed cell (Figure 9(b) and (c), respectively) are also plotted. We recall
that the effective densities plotted in Figure 9(c) are the results of the topology optimization problem
(13) without imposing a density constraint.

Figure 9. Two set of solutions attained with finite element mesh refinement, CM and FM, denote coarse and
fine mesh, respectively. V-Cells are characterized with the shape parameter ùúÇ: (a) optimal attained value of J
defined in problem (13); (b) Shear stiffness C33 of the effective attained elasticity tensor; (c) effective attained

inertial mass density ùúåOT .

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1365

Results in Figure 9 show a rather sensitive response with respect to changes of the shape parameter
ùúÇ. The minimal shear modulus Chom

33
and the minimal objective function value J are attained in the

range 3 ‚©Ω ùúÇ ‚©Ω 5. Also, note that in the same range of ùúÇ, the effective inertial mass density is almost
constant around ùúåOT = 0.5.

It is noted that the correct capturing of the effective shear modulus of the sub-layer, represented
by the term Chom

33
, is crucial to get a good response of the cloaking device. According to the analysis

of Norris, this term has to be zero.
Figure 10 displays the microstructures and the corresponding effective elasticity tensors obtained

as solution of the topology optimization problem computed with four V-Cell geometries. In all cases,
except in the result with ùúÇ = 2, we have obtained good agreement between Chom and the target tensor
defined in expression (21).

Figure 10. Microstructures for sub-layer number 15 obtained with V-Cells , fine finite element mesh (FM)
and varying the shape parameter ùúÇ. The first column displays the unit cells and the solutions provided by the
topology optimization algorithm. The second column displays the resulting microstructures obtained by the
spatial repetition of the computed unit-cell. The third column (cases with ùúÇ = 3, 5, and 7) displays details of
the joints between needle-like members. The last column shows the computed effective elasticity tensors.

Figure 11. Two possible microstructures for sub-layer 15 obtained with V-Cells characterized with the shape
parameters: (a) ùúÇ = 3 and b) ùúÇ = 7.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1366 C. MENDEZ ET AL.

Figure 12. Solutions obtained with the topology optimization algorithm for several sub-layers of the acoustic
cloaking device. Chom and ùúåOT are the effective elasticity tensors and homogenized densities of the micro-
cells obtained with the topology optimization algorithm. CÃÇ and ÔøΩÃÇÔøΩ are the target effective elasticity tensors and

densities according to the analysis of Norris.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1367

Conclusions of the study about the influence of ùúÇ on the microstructure design are summarized as
follows:

‚Ä¢ As the finite element mesh is refined (mmax is increased), better solutions to problem (13) are
obtained. However, the crucial conclusion is that the shape of Œìùúá is of paramount importance
to obtain good solutions. Tests conducted with rectangular unit-cell shapes, using different
slenderness ratios, yield unsatisfactory results.

‚Ä¢ From Figure 9, the range of parameters 3 ‚©Ω ùúÇ ‚©Ω 5 provides good approaches to the solution
of the topology optimization problem. Notably, however, geometries defined with ùúÇ < 2.5 that
correspond to squares or regular hexagons are excluded from the admissible configurations and
must be avoided.

‚Ä¢ There are several microstructure architectures providing effective elasticity tensors Chom

approaching the target one. It is the case of the microstructures depicted in Figure 11. Then,
it can be concluded that problem (13) is not a unique solution and that several material
architectures are admissible for the present acoustic cloaking device.

‚Ä¢ In most cases observed in Figures 10, the external boundaries of the V-Cells do not coincide
well with the hexagonal cells displayed by the obtained honeycomb-like microstructures. For
example, for the microstructures depicted in Figure 11, we have detected that for ùúÇ ‚âà CÃÇ11‚àïCÃÇ22 ‚âà 7
(Figure 11(b)), the V-Cell captures almost exactly the geometry of the basic cell. However, this
configuration does not lead to the better solution. The best solution is obtained for ùúÇ ‚âà 3.75
(Figure 11(a)).

5.5. Results of the designed acoustic cloaking device

From the exposed conclusions in the previous sub-section and in order to avoid a similar study for the
20 sub-layer designs, we solve these topology optimization problems by adopting V-Cell geometries

Figure 13. Normalized effective properties of the 20 sub-layers obtained with the topology optimization
algorithm, bulk moduli ùúÖhomr and ùúÖ

hom
ùúÉ

, inertial mass densities ùúåhom and shear moduli Chom
33

, are shown in
symbols. Curves in line are the analytical expression taken from Figure 2.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1368 C. MENDEZ ET AL.

whose shape parameters are defined through a relation depending on the coefficients of the target
elasticity tensor, as follows:

ùúÇ =
‚àö

3

(
1 + 0.2

CÃÇ11 ‚àí CÃÇ22
CÃÇ22

)
.

This criterion is taken by considering the following empirical rules: for an isotropic pentamode mate-
rial, with CÃÇ11‚àïCÃÇ22 = 1, the V-Cell should be a regular hexagon defined by ùúÇ =

‚àö
3. While for

CÃÇ11‚àïCÃÇ22 ‚âà 6.9 that corresponds to the sub-layer 15 studied in the previous sub-section, the V-Cell
should be defined by ùúÇ = 3.75, which has proven to give the most optimal solution.

Figure 12 shows the microstructures of sub-layers 1, 5, 10, 15, and 20, obtained with this proce-
dure. The second column displays details of the synthesized microstructures such as the needle-like
members and joints. The third column shows the effective elasticity tensors Chom and densities ùúåOT

compared with the target elasticity tensors CÃÇ and target densities ÔøΩÃÇÔøΩ for these sub-layers.
As commented earlier, the solutions for the 20 cells provide homogenized mass densities, which

are lower than the ones required by the analysis of Norris. Therefore, in the validation test of the
next section, we assume that these densities could be exactly adjusted to the target values.

Figure 13 plots the effective properties ùúÖhomr , ùúÖ
hom
ùúÉ

, and Chom
33

for the synthesized 20 sub-layers.

Figure 14. Pressure maps (real part) of an incident plane wave problem. Domain size: 10 √ó 10 m, wave
angular frequency: œâ = 1.3e4rad‚àïs. (a) Solution of the cylinder with radius a = 1m and perfect cloaking
(parameter Œ¥ = 0m). The material properties of the cloak are given by the analysis of Norris in Appendix A;
(b) solution with a bare cylinder of radius a = 1m; c) cylinder of radius a = 1m with the designed acoustic

cloaking using parameter Œ¥ = 0.333m; (d) solution with a bare cylinder of radius ar = 0.333m.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1369

5.6. Scattering performance assessment of the designed layer

The performance of the metamaterial designed with the technology of the previous section, whose
properties are plotted in Figure 13, is next assessed in the following examples.

This performance is evaluated by studying the scattering wave field produced by a plane wave
impinging on a cloaked cylindrical object immersed in an infinite fluid medium. The cloaking device
being designed with parameter Œ¥ = 0.333m has to affect the external wave field, outside the cloak
region, as much as a bare cylindrical object of radius ar = 0.333m. Then, the goal of the present
validation test consists in comparing the scattered wave field for both cases.

Considering the excessively high computational cost required by a detailed DNS simulation of
this problem including the modeling of the material microstructure and its interaction with the fluid,
we simulate a simplified verification test. The acoustic cloaking device is modeled with 20 layers
perfectly connected made of elastic materials whose properties are identical to the effective ones
determined with the design methodology of the previous section.

Figure 14 displays the pressure maps (real part) for several cases of the mentioned problem com-
puted with an in-house finite element code. This code solves the wave equation problem in the
frequency domain and utilizes a perfectly matched layer technique for modeling the infinite domain
of the fluid. Pressure maps in the figure are the results of an incident plane wave, from the left. The
wave frequency is 2.07Khz (angular frequency: œâ = 1.3e4rad‚àïs) and the medium, across which the
wave propagates, is water with density ùúå0 = 1000.Kg‚àïm3 and a volumetric modulus ùúÖ0 = 2.25GPa.
The wave speed in this medium is c0 = 1500.m‚àïseg and the wave number for this frequency is
k = œâ‚àïc0 = 8.67rad‚àïm with a wavelentgth ùúÜ = 2ùúã‚àïk = 0.72m. The analyzed domain has a size of
10 √ó 10 m.

Solutions are computed and compared for different cases:

(i) object with perfect cloak designed according to analytical results of Norris;
(ii) bare object of radius a = 1m;

(iii) object of radius a = 1m with the cloaking device designed in accordance with the topology
optimization technique and the parameter Œ¥ = 0.333m;

(iv) bare object of radius: ar = 0.333m.

We recall that the external domain solution of case (iii) should mimic the solution of case (iv).
In order to quantitatively compare the solutions presented in Figure 14, the effective cross-

sectional areas are computed in the last three cases. Let us consider again a plane wave traveling
from left to right in a free infinite medium with a vertical wavefront. The pressure response in the
time domain (X, t) can be expressed by the following:

pi(X, t) = p0 exp(i(k ¬∑ X ‚àí ùúît)), (22)

where recalling that k is the wave number, k = kex is the wave vector, and ex is the unit vector in
the horizontal direction. The rigid cylindrical object of radius a = 1m is placed at X = 0. The cloak
occupies the space Œ© = {X | 1m ‚©Ω ||X|| ‚©Ω 2m}. The object produces a scattered wave field, which,
at large distances from the cylinder, can be assumed as spherical wave field centered at X = 0. The
pressure field, p(X, t), resulting from the incident and scattered waves is computed in the frequency
domain with the finite element code. By considering that pw(X) denotes the amplitude of the pressure
field in the frequency domain, the effective cross-sectional area (per unit of thickness) of the object
is evaluated as follows:

ùúé
eff = ‚à´S

(Œîpw)(Œîpw)

piwp
i
w

dS ; Œîpw(X) = pw(X) ‚àí piw(X), (23)

where the integration curve S is a circle of radius r = 4.5m and the symbol (¬∑), over both terms in
the integrand, represents the complex conjugate of the magnitude.

Figure 15(a) depicts, in a polar plot, the integrand value of expression (23) along curve S as a
function of the angular position ùúÉ. Three curves corresponding to cases (ii), (iii), and (iv) are shown.
Figure 15(b) depicts a zoom of the polar plot in where only the case (iii) and (iv) are shown. Note that
the cloaked cylinder of radius a = 1 generates a scattered wave field, with notably lower values of the

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1370 C. MENDEZ ET AL.

Figure 15. (a) Polar plots of the integrand in (23) corresponding to cases (ii), (iii), and (iv); (b) zoom of the
polar plot shown in (a) displaying cases (iii) and (iv); (c) effective cross-sectional areas (per unit of thickness)

for cases (ii), (iii), and (iv) computed for different wave numbers of the incident wave.

integrand term if compared with the bare cylinder of the identical radius. Furthermore, the integrand
value distribution is qualitatively identical to that produced by a significantly smaller object.

Figure 15(c) plots the effective cross-sectional areas (per unit of thickness of the object) for the
three cases: (ii), (iii), and (iv) and different frequencies of the incident plane wave. These results
quantify the capability of the designed cloak at different wave frequencies. They confirm that, in a
wide range of frequencies, the cloaking device is almost insensitive to this variable.

5.7. Modal analysis of a micro-cell

Considering that the microstructure of the designed material consists of slender bars with a filler
polymer possessing a very low stiffness and a dense disperse phase, it is necessary to guarantee that
the lower eigenfrequencies of the unit cell are much higher than the frequency of the sound wave.
This requirement should be satisfied to guarantee that the static homogenization analysis, implicitly
considered in this paper, is a valid assumption of the model and that the natural frequencies of the
cloak do not interfere the sound wave.

The unit-cell eigenfrequencies increase with the inverse of the cell size. Therefore, it can be guar-
anteed that the previous requirement is satisfied for small enough cell sizes. The maximum cell size
of the designed pentamode material is limited by the acoustic wavelength and by the thickness of the

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1371

Figure 16. Modal analysis of the unit cell taken from layer 1 of the cloaking device. (a‚Äìb) Finite element
model. (c) Eigenmode corresponding to the lower eigenfrequency when polymer and disperse phase effects

are neglected.

layers in which the cloaking device is divided. The shortest wavelength in the analysis of Figure 15
is 0.25m and the layer thickness, by assuming an identical value for all layers, is 0.05m.

In view of the previous discussion, the modal analysis of the unit cell of layer 1 is subsequently
performed. In the context of evaluating minimal eigenfrequencies of the designed microstructures,
this layer is the most compromised one. Figure 16(a) and (b) shows the finite element model of
the analyzed cell and the adopted geometrical dimensions. A characteristic cell size of 0.01m is
arbitrarily chosen. Two cases are solved. In the first one, the polymer, as well as the dynamical effect
of the disperse phase, is neglected. In the second case, all the components are considered.

In accordance with the cell designed for layer 1, in Figure 16, the density provided by the
solution of the topology optimization algorithm is ùúåOT = 389.kg‚àïm3. The target density is ÔøΩÃÇÔøΩ =
1442.kg‚àïm3. Therefore, by taking a polymer density ùúåPol = 20.Kg‚àïm3 and the aluminum density
ùúåAl = 2700.kg‚àïm3, the target density ÔøΩÃÇÔøΩ is obtained by dispersing a volume fraction fAl = 0.2642 of
aluminum into the polymer. The disperse aluminum phase is modeled by assigning the aluminum
properties to finite elements randomly placed into the space, which is originally occupied by the
polymer, until the required volume fraction is reached. Therefore, due to the fact that the cell volume
is 1.06e(-4)m2 and the number of finite elements is 11911, the mean size of the aluminum particles
used in the analysis is 8.9e(-9)m2.

Periodic boundary conditions are imposed to the finite element model of the unit cell. Note that
the acoustic wavelengths are much larger than the cell size.

The obtained results in both cases are as follows: (a) the lower eigenfrequency when the polymer
and disperse phase is neglected is 79kHz; (b) the lower eigenfrequency when the polymer and dis-
perse phase is taken into account is 75kHz. Then, both frequencies result much higher than the sound
wave frequencies considered in the analysis of the previous sub-section.

The eigenmode related to the lower eigenfrequency for case (a) is depicted in Figure 16(c).
These results confirms that, for cell sizes smaller than 0.01m, the homogenization static analysis

followed in this paper is a valid assumption.

6. CONCLUSIONS

The results presented in this work show the viability of using topology optimization techniques
based on topological derivative to design the microstructures of a graded layer for acoustic cloak-
ing devices. The manufacturing feasibility of such layers, employing available materials, has been
already proven.

To attain such results, it has been imperative to properly select a unit-cell geometry where the
topology optimization problem is posed. In this sense, it has been shown that the material symmetry
can be properly exploited to solve this issue. The presented study has provided additional ingredients
to understand the influence of the unit-cell external shape on the results obtained with the optimiza-

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1372 C. MENDEZ ET AL.

tion algorithm. From this study, it has been proven that solutions strongly depend on this variable
and that square or regular hexagonal shapes have to be discarded in several cases.

The validation test proves the effectiveness of the synthesized composite for satisfying the target
proposed for the cloaking device. This virtual test shows a significant decrease of the scattered wave
power produced by the immersed cloaked object. The pattern of the scattered wave agrees acceptably
well with the ideal case of an immersed bare object with reduced dimensions.

An additional conclusion refers to the wide range of metamaterial design problems in which this
type of framework can be applied. The most promising application field is related to metamaterial
design problems whose microstructure architecture cannot be conjectured beforehand. Typical cases
are the design of the following: (i) extreme materials with large negative Poisson ratios; (ii) ultra-
light and ultra stiff metamaterials; and (iii) material for thermal flux manipulation, between others.
Progress in the synthesis of ultralight and ultra stiff structures using this type of computational design
tool has been presented by the authors in [31].

Finally, a potential improvement of this technology can be identified by introducing the notion
of topological derivatives of anisotropic elastic materials. Some of the authors of this paper have
recently published a work with contributions in this topic; see [29]. This derivative, within the context
of topology optimization, opens the possibility to design metamaterials through several length scales.

APPENDIX A: LINEAR ACOUSTIC THEORY AND FIELD TRANSFORMATION ANALYSIS

Let us consider a conventional acoustic wave problem propagating in a fluid medium at rest and
placed in an homogeneous domain BÃÉ; see Figure 1. In this medium, ùúÖ0 denotes the time-averaged bulk
modulus and ùúå0 denotes the time-averaged density. The disturbance produced by the wave motion
superposed to the time-averaged fields are assumed small. Then, the linear acoustic wave equation
in terms of the pressure field P(XÃÉ, t) can be written as follows [32]:

PÃà ‚àí ùúÖ0 divXÃÉ(ùúå
‚àí1
0 ‚àáXÃÉP) = 0 . (A.1)

In the present description, BÃÉ refers to the homogeneous space because the wave propagate with
null scattering strength. It is also assumed as the reference space for the transformation to be defined
in the following.

Following to [4], the form-invariance property of Equation (A.1) is next exploited. Let us consider
the physical space B, where some object is immersed in the fluid, and the coordinate system X in
B. The physical space is mapped from the reference space through a coordinate transformation,
X = ùùì(XÃÉ), sketched in Figure A1. The map ùùì is assumed to be one-to-one and invertible, except at
possibly one point in the domain Œ© ‚äÇ BÃÉ. The deformation gradient of ùùì (ùùì ‚à∂ BÃÉ ‚Üí B) is F = ‚àáXÃÉùùì.

Then, Equation (A.1) can be re-written in the physical frame X by introducing the tensorial trans-
formations of the differential operators: divX(¬∑) and ‚àáX(¬∑), in terms of divXÃÉ(¬∑) and ‚àáXÃÉ(¬∑). These

Figure A1. Radially symmetric deformation map. Homogeneous (BÃÉ) and physical (B) spaces.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1373

tensorial transformations can be derived by introducing the deformation analysis, within the context
of finite elasticity, described in the book of Ogden [33]. The resulting wave propagation equation in
the physical domain is given as follows:

pÃà ‚àí ùúÖ0J divX
(
(ùúå0J)‚àí1V2 ¬∑ ‚àáXp

)
= 0 (A.2)

where V2 = FFT, J = det(F) and the pressure in the physical space is denoted by p(X, t).
However, and following to Norris, a more general and adequate expression of the acoustic wave

Equation (A.1) in the physical space can be defined by introducing a second-order symmetric tensor
field ùö∫, such that divXùö∫=0. In this case, Equation (A.2) can be equivalently rewritten as follows:

pÃà ‚àí ùúÖ0JŒ£ ‚à∂ ‚àáX
(
(ùúå0JŒ£)‚àí1 ¬∑ V2 ¬∑ ‚àáX p

)
= 0 (A.3)

At every point of B, the similar form displaying the pseudo-pressure wave Equation (7), which
represents an acoustic wave propagating across a pentamode material, and the acoustic wave
Equation (A.3) in the transformed space can be recognized. Both equations can be made identi-
cal under the condition that the parameter of the geometrical transformations, given by the map ùùì
in (A.3), is reinterpreted as being the heterogeneous properties of the pentamode material defined
in Section 2. This condition is satisfied if the following constraints on the material properties are
imposed point-wise:

i) S ‚â° Œ£,
ii) ùúÖ‚ãÜ = ùúÖ0J, and

iii) ùùÜ‚ãÜ = ùúå0JŒ£ ¬∑ V‚àí2 ¬∑ Œ£.

With this redefinition of the pentamode material properties in X, the wave equation in B‚àñŒ© mimics
the wave equation in the reference empty space BÃÉ‚àñŒ©ÃÉ.

A.1 . A radially symmetric deformation map for cylindrical object cloaking

Let us consider an acoustic wave propagating in a medium where a cylindrical object of radius a
is immersed, as shown in Figure 1(b). Our goal is to design the properties of the metamaterial filling
the circular ring domain Œ©, of thickness b ‚àí a, around the cylinder such that it acts as a cloaking for
the object. In this way, the wave propagating at the exterior domain B‚àñŒ© is not affected by the object.

This goal can be reached by exploiting the results of the previous sub-section. Let a radially
symmetric deformation map be given by the following:

X = ùùì(XÃÉ) =
r(R)

R
XÃÉ, (A.4)

where R and r are the radial coordinates of two points: XÃÉ and X (R = XÃÉ and r = X ) in the reference
and physical spaces, respectively, related through the map (A.4). The radial unit vectors in both
spaces are defined by the following:

X
r
= er = eR =

XÃÉ
R
. (A.5)

The radial coordinate r(R) is defined by the inverse function:

R = f (r) =

{(
b2‚àíaŒ¥
b2‚àía2

r ‚àí a‚àíŒ¥
b2‚àía2

b2 a
r

)
; a ‚©Ω r ‚©Ω b

r; r ‚©æ b
(A.6)

The interpretation of this deformation map is sketched in Figure A1. This function transforms the
circular ring domain Œ©ÃÉ, of thickness b ‚àí Œ¥, in another circular ring Œ©, of thickness b ‚àí a, while the
exterior domain B‚àñŒ© is identically mapped.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1374 C. MENDEZ ET AL.

By considering a null parameter Œ¥ for this transformation, maps (A.4)‚Äì(A.6) are singular at the
origin, and the cylinder acoustic cloaking, associated with this transformation, is perfect. To avoid
the singularity, we assume a value: Œ¥ > 0. In this case, the effective cross section of the immersed
object is reduced if compared with that of the bare cylinder. Therefore, the device built with the so-
idealized pentamode material works as a scattering reduction layer instead of as a perfect cloaking
device.

The function (A.6) is taken from [20] and, according to these authors, satisfies the criteria by
which the cloaking material properties show minimal elastic anisotropy.

Further identities involving the gradient of deformation of ùùì and the associated right stretch tensor
are derived from (A.5) and (A.6) as follows:

F = 1
f ‚Ä≤(r)

Ir +
r

f (r)
I‚üÇ ; Ir = er ‚äó er ; I‚üÇ = ùüè ‚àí er ‚äó er;

J = det(F) = 1
f ‚Ä≤(r)

(
r

f (r)

)(nd‚àí1) (A.7)
where we consider a two-dimensional space, with nd = 2.

Furthermore, we choose

ùúÖ
‚ãÜ = ùúÖ0J = ùúÖ0

1
f ‚Ä≤(r)

r
f (r)

, (A.8)

and:

S =
(

f (r)
r

)(
Ir +

rf ‚Ä≤(r)
f (r)

I‚üÇ

)
. (A.9)

Note that the divergence-free condition of the field S follows from Equation (A.9).
From expressions (A.8), (A.9), and (1), the moduli of the elastic constitutive tensor ùúÖr and ùúÖùúÉ in

Equation (3) result in

ùúÖr = ùúÖo
1

f ‚Ä≤(r)

(
f (r)

r

)
; ùúÖùúÉ = ùúÖof ‚Ä≤(r)

(
r

f (r)

)
(A.10)

and therefore:

CÃÇ =
‚é°‚é¢‚é¢‚é¢‚é£

1
f ‚Ä≤(r)

(
f (r)

r

)
1 0

1 f ‚Ä≤(r)
(

r
f (r)

)
0

0 0 0

‚é§‚é•‚é•‚é•‚é¶
. (A.11)

Also, the inertial mass density is given by the following:

ùùÜ‚ãÜ = ùúåof ‚Ä≤(r)
(

f (r)
r

)
1 (A.12)

In this case, ùùÜ‚ãÜ results in a spherical tensor, and therefore,

ùúår = ùúåùúÉ = ùúå = ùúåof ‚Ä≤(r)
f (r)

r
. (A.13)

With these definitions of the material parameters at the cloak and the condition f(r = b) = b,
the radial impedance and the circumferential wave speed at the interface separating both domains,
medium, and cloak, are identical

Zcloackr (r = b) =
‚àö
ùúÖrùúå =

‚àö
ùúÖoùúåo = Zmediumr (r = b); (A.14)

ccloack
ùúÉ

(r = b) =
‚àö
ùúÖùúÉ‚àïùúå =

‚àö
ùúÖo‚àïùúåo = cmediumùúÉ (r = b) . (A.15)

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1375

APPENDIX B: TOPOLOGY OPTIMIZATION ALGORITHM FOR INVERSE DESIGN OF THE
MICROSTRUCTURE

In this Appendix, the most salient points of topology optimization algorithm utilized for microstruc-
ture inverse design are discussed. These points include the computational homogenization technique
(sub-Section B.1 ), which is used to evaluate the effective properties of the composite, the topological
derivative of the homogenized elasticity tensor described in sub-Section B.2 , and the optimization
algorithm summarized in Boxes 1 and 2 in sub-Section B.3 . Also, the modification of some key
aspects of the topology optimization algorithm is included in order to adapt this algorithm to the
acoustic cloaking design problem.

B.1 . Computational homogenization

Let us consider the two-phase composite schematized in Figure 3 with a periodic microstructure
represented through a unit cell denoted by Œ©ùúá.

The macro-strain and macro-stress fields described at Œ© are denoted by ùú∫ and ùùà, respectively. The
same fields observed at the micro-scale Œ©ùúá are denoted by ùú∫ùúá and ùùàùúá. These terms are represented
in Figure 3(a), where the homogenization procedure is also sketched.

A linear elastic response for every phase of the composite at the micro-scale is assumed. It is
expressed by the following:

ùùàùúá(y) = Cùúá(y) ‚à∂ ùú∫ùúá(y) , (B.1)

where Cùúá(y) is the elasticity tensor of the corresponding phase at point y. Then, a macroscopic linear
constitutive relation, ùùà = Chom ‚à∂ ùú∫, is inherited, whose effective elasticity tensor is denoted by Chom.
The tensor Chom is evaluated by following conventional computational homogenization techniques
imposing periodic boundary conditions at Œìùúá; see [34]. Because of the assumed linearity of the
relationùùà(ùú∫), we compute the homogenized constitutive tensor evaluating three homogenized macro-
stresses, ùùà1 , ùùà2, and ùùà3 for specific macro-strains ùú∫1, ùú∫2, and ùú∫3. The three strains {ùú∫1, ùú∫2, ùú∫3}, given
by: ùú∫1 = er ‚äó er, ùú∫2 = eùúÉ ‚äó eùúÉ and ùú∫3 = 1‚àï2(er ‚äó eùúÉ + eùúÉ ‚äó er), define a canonical basis of the
macro-strain space. In Voigt notation, the j-th basis of these strain tensors can be written as follows:
ùú∫j = [(ùúÄj)rr, (ùúÄj)ùúÉùúÉ, 2(ùúÄj)rùúÉ]T.

Then, the matrix of the elasticity tensor is given by the following:

Chom = [ùùà1(ùú∫1),ùùà2(ùú∫2),ùùà3(ùú∫3)] . (B.2)

So the j-th column of Chom is the macro-stress ùùàj(ùú∫j) computed as the volumetric average of the
micro-stress (ùùàùúá)j:

ùùàj(ùú∫j) =
1|Œ©ùúá|‚à´Œ©ùúá (ùùàùúá)j dŒ©ùúá . (B.3)

Figure B1. Multiscale material model of a composite with two phases: M1 and M2. The topological derivative
DTC

hom(y) of the homogenized elasticity tensor Chom(y) gives its sensitivity to material distribution changes
within the micro-cell.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1376 C. MENDEZ ET AL.

The micro-stress (ùùàùúá)j results from solving the unit-cell boundary value problem briefly defined
as follows:

(i) the macro-strain ùú∫j is uniformly distributed into the unit-cell domain Œ©ùúá. This term operates as
the driving force of the mechanical problem formulated at the unit cell;

(ii) the micro-strain field, (ùú∫ùúá)j, in Œ©ùúá is the addition of two terms: (ùú∫ùúá)j = ùú∫j +(ÔøΩÃÉÔøΩùúá)j. The last term,
(ÔøΩÃÉÔøΩùúá)j, is a kinematically compatible micro-strain fluctuation field;

(iii) micro-stress (ùùàùúá)j is a self-equilibrated stress field satisfying anti-periodic traction boundary
conditions and the elastic constitutive relation (B.1).

Additional details of this homogenization procedure can be obtained in the reference works [34].
The rule of mixtures is the homogenization technique adopted for evaluating the effective inertial

mass density ùúåhom.

B.2 . Topological derivative of the homogenized elasticity tensor

The unit-cell domainŒ©ùúá considered in the previous sub-section is separated in two disjoint domains:
Œ©1ùúá and Œ©2ùúá, occupied by phase M1 and M2, respectively

(
Œ©ùúá = Œ©1ùúá ‚à™ Œ©2ùúá

)
; see Figure B1.

Phase M1 is an isotropic elastic material whose elastic modulus and Poisson‚Äôs ratio are denoted
by E1ùúá and ùúà

1
ùúá. Phase M2 is also an isotropic elastic material whose elastic modulus and Poisson‚Äôs

ratio are defined by E2ùúá = ùõæE1ùúá and ùúà2ùúá = ùúà1ùúá, where parameter ùõæ is the stiffness contrast ratio between
phases M1 and M2.

For a given distribution of phases, let us consider the homogenized constitutive tensor Chom. The
topological derivative of Chom, denoted by DTC

hom, at point y occupied by phase M1, is the fourth-
order tensor representing the sensitivity of Chom to the nucleation of a circular perturbation around
y. The perturbation consists in substituting a ball of material M1 and radius ùúâ by an identical ball
constituted of material M2. The ball area |Œ©ùúâ| is the perturbation parameter. Alternatively, if y refers
to a point occupied by phase M2, the topological derivative indicates the sensitivity of nucleating a
circular perturbation of material M1.

The mathematical meaning of the topological derivative can be illustrated through the asymptotic
expansion of the effective elasticity tensor Chompert , which is the homogenized tensor after introducing
the perturbation. This asymptotic expansion is developed in terms of the area |Œ©ùúâ| and is written as
follows:

Chompert = C
hom +

|Œ©ùúâ||Œ©ùúá|DTChom(y) +O
(|Œ©ùúâ||Œ©ùúá|

)
. (B.4)

The last term in (B.4) is an infinitesimal of order two in the argument. Further details about the
meaning of (B.4) can be found in [15] and [35].

Using Voigt notation for fourth-order tensors, the (i, j)-th component of the topological derivative
matrix (i, j = 1, ‚Ä¶ , 3), denoted by [DTChom]ij, is computed through the following expression:

[DTChom]ij = ‚àí
ùúí1

E1ùúá

(
4(ùùàùúá)i ‚à∂ (ùùàùúá)j ‚àí ùúí2tr((ùùàùúá)i)tr((ùùàùúá)j)

)
, (B.5)

where

ùúí1 =
1 ‚àí ùõæ

1 + ùúèùõæ
, ùúí2 =

1 ‚àí ùõæ(ùúè ‚àí 2ùúÅ )
1 + ùúÅùõæ

, ùúè =
1 ‚àí ùúà1ùúá
1 + ùúà1ùúá

, ùúÅ =
3 ‚àí ùúà1ùúá
1 + ùúà1ùúá

,

while (ùùàùúá)i and (ùùàùúá)j are the micro-stress fields utilized in the integrand of Equation (B.3). These
stresses are the solution of the micro-cell problem defined in the previous sub-section.

Equation (B.5) has been derived by implicitly assuming that a ball of material M2 is introduced
into the domain M1. Alternatively, if the perturbation consists of introducing a small ball of material
M1 into the domain M2, the role of E1ùúá, E

2
ùúá, and ùõæ in Equation (B.5) should be interchanged to

compute DTC
hom in that position (E2ùúá takes the role of E

1
ùúá and ùõæ is redefined as ùõæ = E2ùúá‚àïE1ùúá).

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1377

B.3 . Topology optimization algorithm based on the procedure of Amstutz

The algorithm for solving the problem (13) relies on two ingredients:

(a) A continuous function ùúì(y) (with ùúì ‚àà L2(Œ©ùúá)), which zero level set represents the geometry
of the interface M1-M2. It is called the level set function and is defined by

ùúì(y) ‚à∂=
{
< 0 ; ‚àÄ y ‚àà Œ©1ùúá ;
> 0 ; ‚àÄ y ‚àà Œ©2ùúá ,

(B.6)

where sub-domains Œ©1ùúá and Œ©2ùúá have been previously defined.
(b) The topological derivative g(y), which is defined as follows:

g(y) ‚à∂=
{

‚àíDTJ(y); if: y ‚àà Œ©1ùúá ;
DTJ(y); if: y ‚àà Œ©2ùúá .

(B.7)

The topological derivative of the objective function (13), considering the Frobenius norm,
results in the following:

DTJ(y) = 2
(
Chom ‚àí CÃÇ

)
‚à∂ DTChom(y) , (B.8)

and this functions can be computed after replacing DTC
hom by the term defined in (B.5).

In the approach of Amstutz, the function ùúì of the optimal solution of a topology optimization
problem is found through a fixed point iteration and the topological derivative, providing a descent
direction of the objective function.

This algorithm has been slightly adapted to dealt with the objective function described in the
problem (13). It is described in Boxes 1 and 2.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1378 C. MENDEZ ET AL.

Description of Box 1: The procedure consists of two nested loops:

(1) (LOOP 1) The external loop handles a finite element mesh refinement sequence. The parameter
mmax identifies the maximum number of times that the mesh is refined during the solution
process. Then, each finite element mesh, in the refinement sequence, is identified by a char-
acteristic mesh size: hem where sub-index m denotes the m-th loop. The level set function ùúì is
defined in each node of the finite element mesh. Then, the dependence of the level set function
ùúì with the finite element mesh is remarked using the notation ùúì(hem), where hem represents the
finite element mesh size at loop m.

(2) The field ùúì(hem) is determined by solving the problem (13) with the target elasticity tensor CÃÇ.
This field is found through a sequence of nc sub-problems solved in the inner loop (LOOP 2).
The level set function solution of every sub-problem (ùúìùìÅ) is identified with a sub-index coin-
ciding with the inner loop index. So ùúì0(hem) represents the trial level set function for the mesh
of size hem, while ùúìnc(h

e
m) is the solution obtained after solving nc sub-problems. In the inner

loop, each sub-problem is similar to (13) but with a redefined target elasticity tensor. For each
sub-problem, the target elasticity tensor is taken from a convex combination of Chom(ùúì0(hem))
and CÃÇ as follows:

CÃåùìÅ =
(

nc ‚àí ùìÅ
nc

)
Chom(ùúì0(hem)) +

(
ùìÅ
nc

)
CÃÇ . (B.11)

The notation adopted in this equation emphasizes the fact that Chom depends on the level set
function determining the topology of the cell Œ©ùúá.
The tensor CÃåùìÅ is utilized to compute the objective functionJ, and the corresponding topological
derivative, of the ùìÅ-th sub-problem in the inner loop as follows:

J = (||Chom(ùúì) ‚àí CÃåùìÅ||)2 , (B.12)
which is solved with the algorithm presented in Box 2. Observe that for ùìÅ = nc is CÃånc = CÃÇ.
Then, the last internal loop solves the original problem (13).

Description of Box 2: The iterative algorithm for solving the level set functionùúìùìÅ(hem), of the sub-
problem (B.9), utilizes a fixed point iteration. The topological derivative g(ùúì) is used as a feasible
descent direction to optimize J(Œ©1ùúá) in problem (13) (additional details about this important point
can be found in [14] and [15]). The normalization factor ùõº is chosen to avoid the ill-conditioning
happening in points close to the solution of problem (B.9). Note that ||g||L2 ‚Üí 0 as Chom(ùúì) ‚Üí CÃåùìÅ .
The value ùõº is selected as the average of ||g||L2 in the initial iterations of the loop in Box 2.

Step length selection (ùõΩ) and convergence criterion in Box 2
The step length ùõΩ is found through a line search defined by the following:

ùõΩ = arg ( min
ùõΩ ‚àà IùõΩ

J(ùúì i+1
ùõΩ

)) (B.13)

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



COMPUTATIONAL MATERIAL DESIGN FOR ACOUSTIC CLOAKING 1379

with

ÔøΩÃÇÔøΩ
i+1
ùúâ

= ùúì i + ùõΩ
g(ùúì i)
ùõº

, ùúì
i+1
ùõΩ

=
ÔøΩÃÇÔøΩ i+1
ùõΩ||ÔøΩÃÇÔøΩ i+1
ùõΩ

||L2
and the parameters ùõΩ are taken from the set of numbers defined by the following:

IùõΩ ‚à∂= [ùõΩmin ‚à∂ ŒîùõΩ ‚à∂ ùõΩmax] ; ŒîùõΩ =
ùõΩmax ‚àí ùõΩmin

10

where ùõΩmin and ùõΩmax are the minimum and maximum allowed step lengths, which are taken as ùõΩmin ‚â™
1 and ùõΩmax = 1, respectively, and ŒîùõΩ is a pre-defined increment of the step length.

The stop criterion is given by the following:

|J(ùúì i+1) ‚àí J10| < tol (B.14)
where J10 is the average of J in the last 10 iterations and tol is an absolute tolerance.

The initialization of the algorithm is performed through the sequential procedure defined in Box
1. With the internal loop 2, the results gradually change, from the trial solution to the original one,
by solving a sequence of closely related optimization problems. Each problem of this sequence is
defined by a modified target tensor, which is adjusted till reaching the original target value CÃÇ.

Following the idea introduced by [14], the external loop 1 handles a sequence of finite element
mesh refinements. The initial loop starts with a rather coarse mesh. After convergence, the mesh
is refined and the level set function is projected onto the new mesh. This process is repeated until
reaching a given accuracy. According to [14], the objective pursued with this mesh mapping strategy
is to improve the algorithm response with respect to local minimum. In the present version, they
are tested with the coarser meshes, by fixing the step length to ùõΩ = 0.1 in Equation (B.10). Once
the finest mesh is solved, the activation of the line search provides a more controlled approach to a
specific local minimum.

ACKNOWLEDGMENTS

The authors acknowledge the financial support from CONICET and ANPCyT (grants PIP 2013-
2015 631 and PICT 2014-3372) and from the European Research Council under the European
Unions Seventh Framework Programme (FP/2007-2013) / ERC grant agreement no. 320815 (ERC
Advanced Grant Project Advanced tools for computational design of engineering materials COMP-
DES-MAT). Oriol Lloberas-Valls gratefully acknowledges the funding received from the Spanish
Ministry of Economy and Competitiveness through the Juan de la Cierva Postdoctoral Junior Grant:
JCI-2012-13782 and the National Research Plan 2014: MAT2014- 60919-R.

REFERENCES

1. Zheng X, Lee H, Weisgraber TH, Shusteff M, DeOtte J, Duoss EB, Kuntz JD, Biener MM, Ge Q, Jackson JA. et al.
Ultralight, ultrastiff mechanical metamaterials. Science. 2014;344(6190): 1373‚Äì1377.

2. Kadic M, B√ºckmann T, Schittny R, Wegener M. Metamaterials beyond electromagnetism. Reports on Progress in
Physics. 2013;76(12): 126501.

3. Narayana S, Sato Y. Heat flux manipulation with engineered thermal materials. Physical Review Letters.
2012;108(21): 214303.

4. Norris AN. Acoustic cloaking theory. Proceedings of the Royal Society of London A: Mathematical, Physical and
Engineering Sciences, vol. 464, The Royal Society;2008:2411‚Äì2434.

5. Pendry JB, Schurig D, Smith DR. Controlling electromagnetic fields. Science. 2006;312(5781): 1780‚Äì1782.
6. Cheng Y, Yang F, Xu JY, Liu XJ. A multilayer structured acoustic cloak with homogeneous isotropic materials.

Applied Physics Letters. 2008;92(15): 151913.
7. Milton GW, Cherkaev AV. Which elasticity tensors are realizable?. Journal of Engineering Materials and Technology.

1995;117(4): 483‚Äì493.
8. Layman CN, Naify CJ, Martin TP, Calvo DC, Orris GJ. Highly anisotropic elements for acoustic pentamode

applications. Physical Review Letters. 2013;111(2): 024302.
9. Kadic M, B√ºckmann T, Schittny R, Gumbsch P, Wegener M. Pentamode metamaterials with independently tailored

bulk modulus and mass density. Physical Review Applied. 2014;2(5): 054007.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme



1380 C. MENDEZ ET AL.

10. Bends√∏e MP, Kikuchi N. Generating optimal topologies in structural design using a homogenization method.
Computer Methods in Applied Mechanics and Engineering. 1988;71(2): 197‚Äì224.

11. Bendsoe MP, Sigmund O. Topology Optimization: Theory, Methods, and Applications. Heidelberg: Springer Science
& Business Media; 2013.

12. Sigmund O, Maute K. Topology optimization approaches. Structural and Multidisciplinary Optimization. 2013;48(6):
1031‚Äì1055.

13. Osanov M, Guest JK. Topology optimization for architected materials design. Annual Review of Materials Science.
2016;46: 211‚Äì233.

14. Amstutz S, Andr√§ H. A new algorithm for topology optimization using a level-set method. Journal of Computational
Physics. 2006;216(2): 573‚Äì588.

15. Amstutz S, Giusti SM, Novotny AA, de Souza Neto EA. Topological derivative for multi-scale linear elasticity models
applied to the synthesis of microstructures. International Journal for Numerical Methods in Engineering. 2010;84(6):
733‚Äì756.

16. Amstutz S, Novotny AA, de Souza Neto EA. Topological derivative-based topology optimization of structures sub-
ject to Drucker‚ÄìPrager stress constraints. Computer Methods in Applied Mechanics and Engineering. 2012;233:
123‚Äì136.

17. Amigo R, Giusti SM, Novotny AA, Silva ECN, Sokolowski J. Optimum design of flextensional piezoelectric actuators
into two spatial dimensions. SIAM Journal on Control and Optimization. 2016;54(2): 760‚Äì789.

18. Novotny AA, Soko≈Çowski J. Topological derivatives in shape optimization: Springer-Verlag, Heidelberg, 2013.
19. √ñzdemir IÃá.. Topological derivative based optimization of 3D porous elastic microstructures. Computational Materials

Science. 2014;81: 319‚Äì325.
20. Gokhale NH, Cipolla JL, Norris AN. Special transformations for pentamode acoustic cloaking. The Journal of the

Acoustical Society of America. 2012;132(4): 2932‚Äì2941.
21. Milton GW. The Theory of Composites. Cambridge, UK: Cambridge University Press; Cambridge, 2002:748.
22. Auffray N, Ropars P. Invariant-based reconstruction of bidimensional elasticity tensors. International Journal of

Solids and Structures. 2016;87: 183‚Äì193.
23. Ting TC. Anisotropic Elasticity: Theory and Applications, vol. 45, New York: Oxford University Press; 1996.
24. Landau LD, Lifshitz EM. Course of theoretical physics vol 7: Theory of Elasticity Elsevier , 3rd Edition. Burlington,

USA; 2007.
25. Sigmund O. A new class of extremal composites. Journal of the Mechanics and Physics of Solids. 2000;48(2):

397‚Äì428.
26. Walpole LJ. On bounds for the overall elastic moduli of inhomogeneous systems. Journal of the Mechanics and

Physics of Solids. 1966;14(3): 151‚Äì162.
27. Cherkaev AV, Gibiansky LV. Coupled estimates for the bulk and shear moduli of a two-dimensional isotropic elastic

composite. Journal of the Mechanics and Physics of Solids. 1993;41(5): 937‚Äì980.
28. Ferrer A, Oliver J, Cante JC, Lloberas-Valls O. Vademecum-based approach to multi-scale topological material design.

Advanced Modeling and Simulation in Engineering Sciences. 2016;3(1): 23.
29. Giusti SM, Ferrer A, Oliver J. Topological sensitivity analysis in heterogeneous anisotropic elasticity problem.

Theoretical and computational aspects. Computer Methods in Applied Mechanics and Engineering. 2016;311:
134‚Äì150.

30. Ashby MF. Materials Selection in Mechanical Design. 3rd ed.: Elsevier, Butterworth-Heinemann; Burlington, USA,
2005.

31. Podest√° JM, Huespe AE, M√©ndez C, Fachinotti V. Dise√±o computacional de metamateriales ultrar√≠gidos y ultrali-
vianos. Mec√°nica Computacional. 2016; XXXIV:2243‚Äì2461.

32. Banerjee B. An Introduction to Metamaterials and Waves in Composites: CRC Press; Boca Raton, USA, 2011.
33. Ogden RW. Non-Linear Elastic Deformations: Dover Publications, Mineola, USA; 1997.
34. de Souza Neto EA, Feij√≥o RA. Variational foundation on multi-scale constitutive models of solids: small and large

strain kinematical formulation. LNCC Research & Development Report No 16, 16; 2006.
35. Giusti SM. An√°lise de sensibilidade topol√≥gica em modelos constitutivos multiescalas. Ph.D. Thesis, Laboratrio

Nacional de Computao Cientfica, LNCC, Brasil, 2009.

Copyright ¬© 2017 The Authors. International Journal for
Numerical Methods in Engineering Published byJohnWiley&SonsLtd.

Int. J. Numer. Meth. Engng 2017; 112:1353‚Äì1380
DOI: 10.1002/nme


	Computational material design for acoustic cloaking
	Abstract
	Introduction
	A pentamode material
	Pentamode material for acoustic cloaking devices

	Topology optimization problem
	Synthesis of microstructures as a topology optimization problem
	Selecting an appropriate shape of the boundary 

	Validation of the design methodology based on topology optimization
	Procedure for designing the extremal material
	Results and discussion

	Design of the pentamode material for acoustic cloaking
	Problem description
	General design procedure
	Technique for adjusting the anisotropic bulk moduli
	Influence of the shape parameter  on the resulting microstructures
	Results of the designed acoustic cloaking device
	Scattering performance assessment of the designed layer
	Modal analysis of a micro-cell

	Conclusions
	Appendix
	A radially symmetric deformation map for cylindrical object cloaking

	Appendix
	Computational homogenization
	Topological derivative of the homogenized elasticity tensor
	Topology optimization algorithm based on the procedure of Amstutz

	References


