






























































Multi-TID detection and characterization in a dense Global Navigation Satellite System receiver network


Journal of Geophysical Research: Space Physics

Multi-TID detection and characterization
in a dense Global Navigation Satellite
System receiver network

Heng Yang1 , Enrique Monte-Moreno1 , and Manuel HernÃ¡ndez-Pajares2

1Department of Signal Theory and Communications, TALP, Universitat PolitÃ¨cnica de Catalunya, Barcelona, Spain,
2Department of Applied Mathematics IV, IonSAT, Universitat PolitÃ¨cnica de Catalunya, Barcelona, Spain

Abstract The medium-scale traveling ionospheric disturbances (MSTIDs) constitute the most frequent
ionospheric wave signatures. We propose a method for detecting the number of simultaneous MSTIDs from
a time series of high-pass-filtered Vertical Total Electron Content (VTEC) maps and their parameters. The
method is tested on the VTEC map corresponding to a simulated realistic scenario and on actual data from
dual-frequency Global Positioning System (GPS) measurements gathered by +1200 GPS receivers of the
GPS Earth Observation Network (GEONET) in Japan. The contribution consists of the detection of the
number of independent MSTIDs from a nonuniform sampling of the ionospheric pierce points. The problem
is set as a sparse decomposition on elements of a dictionary of atoms that span a linear space of possible
MSTIDs. These atoms consist of plane waves characterized by a wavelength, direction, and phase on a
surface defined, the part of the ionosphere sounded by the GEONET (i.e., 25âˆ˜N to 50âˆ˜N of latitude and 125âˆ˜E
to 155âˆ˜E of longitude). The technique is related to the atomic decomposition and least absolute shrinkage
and selection operator. The geophysical contribution of this paper is showing (a) the detection of several
simultaneous MSTIDs of different characteristics, with a continuous change in the velocity; (b) detection
of circular MSTID waves compatible by time and center with a specific earthquake; (c) simultaneous
superposition of two distinct MSTIDs, with almost the same azimuth; and (d) the presence at nighttime
of MSTIDs with velocities in the range 400â€“600 m/s.

1. Introduction

The ionosphere is the region of the Earthâ€™s atmosphere defined by its free electron population and located
between approximately 50 to 1000 km altitude. The most frequent wave-like structures of the electron density
are called medium-scale traveling ionospheric disturbances (MSTIDs), presenting variations up to a few total
electron content units (TECUs) of amplitudes in solar cycle maximum conditions (1 TECU = 1016 el/m2 which
correspond to a â‰ˆ16 cm delay in L1 GPS signal). The MSTIDs have different properties in relation to the
temporal and spatial variation. Typically, the MSTIDs occurring in midlatitude are roughly characterized by
periods between 15 and 60 min, horizontal wavelengths between 50 and 300 km, and velocities between
100 and 300 m/s, with propagation toward the equator at daytime in local fall and winter seasons and
toward the west at night in local spring and summer seasons [see Hunsucker, 1982; HernÃ¡ndez-Pajares et al.,
2006]. Their origins include the response to atmospheric gravity waves [Hocke and Schlegel, 1996], the Solar
Terminator [HernÃ¡ndez-Pajares et al., 2006], the Perkins instability [Kelley, 2011], the interhemispheric cou-
pling effect [Otsuka et al., 2004], and others. Although the MSTID perturbation may be small compared
to background electron densities, significant effects are observed in electromagnetic waves propagating
through the affected ionospheric region. In particular, the Global Navigation Satellite System (GNSS) sig-
nals, like the Global Positioning System (GPS) signals, are affected by the time-varying and space-varying
delays of the electron fluctuation densities associated with the MSTIDs. This effect can be exploited to use
the GNSS system as a global ionospheric sensor (or â€œionoscopeâ€) for detecting and characterizing the MSTIDs
[see HernÃ¡ndez-Pajares et al., 2012]. The use of the GNSS for studying the ionosphere has the benefit of using
a large-scale, preexisting observation network, which contrasts with other techniques that are more specific
and local, such as the Low-Frequency Array [Mevius et al., 2016], OI 630.0 nm all-sky images [Stefanello et al.,
2015] and AM radio transmissions [Chilcote et al., 2015].

RESEARCH ARTICLE
10.1002/2017JA023988

Key Points:
â€¢ We introduce a new method that

estimates both the number of
unknown traveling ionospheric
disturbances and its parameters
from GNSS data

â€¢ The method has been successfully
assessed with simulated data (on real
pierce point locations) and real data
from GEONET in Japan

â€¢ This new approach can be applied
to other regions with dense GNSS
networks and can be extended
to study seismic-related
ionospheric waves

Correspondence to:
H. Yang,
h.yang@upc.edu

Citation:
Yang, H., E. Monte-Moreno, and
M. HernÃ¡ndez-Pajares (2017), Multi-TID
detection and characterization
in a dense Global Navigation
Satellite System receiver network,
J. Geophys. Res. Space Physics,
122, 9554â€“9575,
doi:10.1002/2017JA023988.

Received 3 FEB 2017

Accepted 26 JUL 2017

Accepted article online 31 JUL 2017

Published online 5 SEP 2017

Â©2017. American Geophysical Union.
All Rights Reserved.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9554

http://publications.agu.org/journals/
http://onlinelibrary.wiley.com/journal/10.1002/(ISSN)2169-9402
http://orcid.org/0000-0002-1583-2307
http://orcid.org/0000-0002-4907-0494
http://orcid.org/0000-0002-9687-5850
http://dx.doi.org/10.1002/2017JA023988


Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Prior GNSS MSTID studies include Hunsucker [1982], Hocke and Schlegel [1996], and HernÃ¡ndez-Pajares et al.
[2006], which use a horizontal planar wave model over a fixed-height ionospheric thin shell around the earth.
Also, Lee et al. [2008], Ssessanga et al. [2015], and Chen et al. [2016] estimate a three-dimensional (3-D) struc-
ture of electron density for modeling the MSTID at variable heights by means of computerized ionospheric
tomography from the large dense GNSS network. Using as source data a GNSS network, Saito et al. [1998] and
Tsugawa et al. [2006, 2007a, 2007b] show a high-resolution 2-D mapping of the typical daytime and nighttime
MSTID waves with their properties. The above mentioned 2-D mappings have been validated by other obser-
vational techniques, for instance, the OI 630.0 nm all-sky imagers [Shiokawa et al., 2003] and the Super Dual
Auroral Radar Network HF radars [Ogawa et al., 2009]. An additional method is proposed in Ding et al. [2011]
and Huang et al. [2016], where they use a cross-spectra method to obtain the MSTID parameters from the GPS
TEC series. An alternative is Deng et al. [2013] where the parameters of a unique MSTID plane wave are com-
puted by spectrum analysis techniques from one-dimensional (1-D) space of detrended VTEC profiles from
the 2-D maps.

Another method for characterizing the MSTIDs using GNSS was proposed in HernÃ¡ndez-Pajares et al.
[2006, 2012, 2017] where the authors introduce the comprehensive GNSS ionospheric interferometry (cGII)
method that estimates the characteristics of the MSTIDs, assuming a unique planar wave from the received
signal of several neighboring GNSS receivers. This method computes the instantaneous wave parameters (i.e.,
velocity, azimuth, and wavelength) at every epoch, at the line-of-sight paths through the ionosphere from
moving satellites to permanent receivers. One limitation in common with the previous methods is that this
method only estimates the parameters of the dominant MSTID wave. In addition to the detection of the dom-
inant MSTID, in this paper, we are interested in detecting and characterizing multiple simultaneous MSTIDs,
which might have different origins and parameters.

In this work, we propose a multiwave parameter estimation model for detecting simultaneously the number
of MSTIDs present and corresponding parameters of each disturbance. This method, which we refer to as the
Atomic Decomposition Detector of MSTIDs (ADDTID), comprises the following:

1. The construction of a time series of detrended VTEC maps. This is done from observational data of dense
and nonuniform distributed receivers of the GNSS network, such as the GPS Earth Observation Network
(GEONET) in Japan or the California GPS Network in America.

2. The method also comprises the construction of a redundant dictionary, i.e., a set of elements that span
the space of possible MSTID waves traveling on the VTEC maps. The cardinality of the dictionary will be
much higher than the dimensionality of the space and will be used to reconstruct the observed detrended
VTEC maps. The elements of the dictionary will consist of snapshots of planar waves at a realistic range of
parameters.

3. The method performs a sparse reconstruction of the observed detrended VTEC map from a small subset of
elements of the redundant dictionary. This is done by solving an optimization problem based on the norms
ğ“1 and ğ“2. The number of selected elements of the dictionary will give the estimated number of MSTIDs
present and the properties of each MSTID, i.e., amplitude, propagation azimuth, wavelength, and velocity.
The technique for the sparse reconstruction is based on ideas of atomic decomposition [Chen et al., 2001]
and the Least Absolute Shrinkage and Selection Operator (LASSO) [Tibshirani, 1996].

2. Description of the Experimental Data

To test the Atomic Decomposition Detector of MSTIDs (ADDTID) method, we will use data from a dense
network of receivers for constructing a time series of detrended VTEC maps. The data come from the GPS
Earth Observation Network (GEONET), which consists of over 1200 GPS stations densely distributed in Japan
(see Figure 1, left) [Sagiya, 2004].

2.1. Generation of the VTEC Maps From the GNSS Measurements
The ionospheric combination (also called geometry-free combination) LI is computed from the carrier phase
difference between L1 and L2 in length units, which is an affine function of the slant total electron content
(STEC), i.e., the integrated electron density of the line-of-sight path in the ionosphere from the satellite j to
the ith receiver, at each sample epoch t [see HernÃ¡ndez-Pajares et al., 2002], given as

LI
j
i
(t) = L1

j
i
(t) âˆ’ L2

j
i
(t) = ğ›¼Sj

i
(t) + BI

j
i
(t) + wj

i
(t) (1)

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9555



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 1. (left) Distribution of GPS receivers in the Japan GEONET network and (right) IPPs distribution in the
ionospheric map for different satellites.

where the linear coefficient ğ›¼ has the approximate value ğ›¼ â‰ˆ 0.105 m/TECU and the wind-up term wj
i
(t),

originating from the relative rotation between the satellite and receiver antennas, is typically at centimeter
level and supposed to be corrected. BI

j
i
(t), is the time-variable bias, encompassing the carrier phase ambi-

guities (the unknown integer number of carrier wavelengths and the noninteger satellite and receiver-
dependent terms) due to receiver losses of lock, i.e., cycle slips. The bias BI

j
i
(t) remains almost constant when

no new losses of lock occur, so we split LI
j
i
(t) into independent subseries defined by the cycle slips. Sj

i
(t) rep-

resents trends such as diurnal variations and elevation angle variation, which are characterized by extremely
low frequencies and very high energies. This contrasts typical MSTID waveform characteristics, which consist
of higher-frequency components with lower energies. The separation of the component related to the MSTID,
from other components, is done by a double difference of the time series (i.e., band-pass filter) of measured
LI

j
i
(t), which we will denote as SÌƒj

i
(t) [see HernÃ¡ndez-Pajares et al., 2006]. In the intervals between cycle slips,

the term BI
j
i

can be considered constant and thus can be eliminated by the double time difference,

SÌƒj
i
(t) â‰ˆ LI

j
i
(t) âˆ’ 1

2

[
LI

j
i
(t + Î”t) + LI

j
i
(t âˆ’ Î”t)

]
(2)

where Î”t is the detrending time interval, set to 300 s, and enhances the frequency band of the MSTIDs. When
the corresponding line-of-sight path in the ionosphere is long enough, we can compute VTEC from the STEC
by means of a mapping function M(t) approximation, assuming that a thin spherical layer is placed at a mean
effective height [see HernÃ¡ndez-Pajares et al., 2009]. Also, we discarded observations with an elevation angle
of less than 30âˆ˜ to reduce the effect of any mapping function error. We define the detrended and projected
VTEC, VÌƒ j

i
(t), as the projection of the SÌƒj

i
(t) by means of the mapping function M(t) [see HernÃ¡ndez-Pajares et al.,

2011], that is, VÌƒ j
i
(t) =

SÌƒ
j
i
(t)

M(t)
.

2.2. Model of the Ionospheric Maps
In our model, the detrended VTEC VÌƒ j

i
(t) (satellite j and station i) contains the MSTIDs signal at the ionospheric

pierce points (IPPs) located on a shell with the mean effective height where we assume that the MSTID occurs.
In contrast with the global ionospheric maps (GIMs) of VTEC on a worldwide scale [Dow et al., 2009], we recon-
struct the ionospheric activity maps at a smaller scale, with a higher resolution of space-time, and generate a
localized time series of snapshots of the maps (for a similar precedent, see Tsugawa et al. [2007a, 2007b]).

We will denote the set of observed detrended VTECs VÌƒm
i
(t) as VÌƒm

i
(ğœ™, ğœ†, t) (see equation (3)), i.e., a function

of IPP geocentric latitude ğœ™, longitude ğœ†, and sample epoch t. The construction of this variable is as follows:
for each satellite m and for each station i, we create a list of measurement VÌƒm

i
(ğœ™, ğœ†, t) at the IPP. Only satellites

with elevations of >30âˆ˜ are used. Another selection filter includes only MSTID activity maps with more than
1000 IPPs (i.e., with more than 80% of the potential measurements available). Thus,

VÌƒm (ğœ™, ğœ†, t) =
[

VÌƒm1 (ğœ™, ğœ†, t) , .., VÌƒ
m
i (ğœ™, ğœ†, t) , .., VÌƒ

m
N (ğœ™, ğœ†, t)

]
(3)

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9556



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

In Figure 1 (right), we show the detrended VTEC {VÌƒm(ğœ™, ğœ†, t),m = 1, 2,â€¦ ,M} for all the observable satellites.
Note that the set of IPPs due to each satellite will be different and is the source of the difficulty of the esti-
mation problem. This is because the estimation must be performed from a nonuniform 2-D distribution of
the observations, with variable spatial density. In addition, the different elevations of the satellites will give a
different signal-to-noise ratio.

The range of the measured detrended VTEC by each satellite is different; thus, to improve the estimation
process, the map VÌƒm (ğœ™, ğœ†, t) of each satellite was normalized, assigning the value 1.0 to the 95% quantile and
0.0 to the 5% quantile. The upper and lower trimming was done so as not to bias the scale because of the
outliers. Each satellite is scaled independently of the other. To not clutter the notation, henceforth, the MSTID
activity map VÌƒm (ğœ™, ğœ†, t) at epoch t of satellite m will be denoted as VÌƒ (ğœ™, ğœ†).

The variable VÌƒ(ğœ™, ğœ†) is a 2-D map, of the local time variation of the detrended VTEC. This map can be
expressed in more convenient coordinates as VÌƒ (x, y) by the transformation of the pierce points from
latitude-longitude-height coordinates (ğœ™, ğœ†, h) to east-north-up coordinates (x, y, z). These east-north-up
coordinates (x, y, z) are projected to the plane, i.e., horizontal coordinates (x, y). The approximation of the
spherical section by a plane introduces a negligible error which is minimized by assuming the center of mass
of the pierce points set as the reference point of east-north-up coordinates. The map size is set from 25âˆ˜N to
50âˆ˜N of latitude and 125âˆ˜E to 155âˆ˜E of longitude, which covers GEONET. The distortion gives an error on sizes
of less than 0.16%.

From Figure 1 (right), at a given epoch t, the image consists of a nonuniform 2-D sampled representation of
the IPPs at the effective height, which we will model as a linear combination of Kronecker deltas located at
the set of pierce points coordinates,

VÌƒ (x, y) =
âˆ‘

(xi ,yj)âˆˆIx,y

ğ›¼i,jğ›¿
(

x âˆ’ xi, y âˆ’ yj
)

(4)

where Ix,y is the set of coordinates (xi, yj) of the IPP, i.e., the coordinates of effective height (i.e., at the average
MSTID activity height) of the line of sight that joins the base station and the satellite, and ğ›¼i,j is proportional
to the detrended VTEC at the coordinates (xi, yj) in the set Ix,y . The sampling is not uniform, as the samples are
originated by the pierce points of the satellites, and each satellite is associated with a set of points that mimics
the shape of the projection of the stations to the effective height, as can be seen in Figure 1 (right). Another
effect is that the SNR depends on the elevation of the satellite line of sight with respect to the receivers.
The satellites are selected by an elevation mask of 30âˆ˜.

3. Justification of the Planar Wave Model

The problem to be solved consists of detecting and characterizing an unknown set of simultaneous MSTIDs
and their properties, from a detrended VTEC map with nonuniform sampling, and spatially varying SNR. In
addition to an irregular and nonuniform spatial sampling, the model should deal with the directional bias
associated with the geographical distribution of the stations. This directional bias is because the samples are
aligned in directions that follow the underlying geography of the Japanese network (SW to NE). The model
MSTID should consider the following:

1. The fact that by visual inspection, the underlying structure of the MSTID signal sometimes appears as
a superposition of several plane waves [see HernÃ¡ndez-Pajares et al., 2006]. Figures 2aâ€“2d show the
interference pattern due to several waves of similar amplitude.

2. The complexity of the estimation process. As shown in Appendix A1, each additional parameter of the
model entails an increase in the size of the optimization problem, which is proportional to the product
of the number of possible values of the parameters that define the atoms of the dictionary. Therefore, we
have limited the model to plane waves. The inclusion of the terms that allow for modeling circular waves
(this will be considered in future research) would make the problem more difficult from the computational
point of view.

3. The GEONET set of receivers is located in a region that is elongated, which introduces a bias in the estimation
of the parameters of the waves. For instance, in Figures 2eâ€“2h, the number of cycles observed for a given
wave depends on the azimuth.

In this paper, we will limit our model to the estimation of superposition of planar waves.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9557



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 2. Wavefront propagation directly seen in the detrended VTEC maps (in TECUs) that illustrate daytime and nighttime MSTIDs, from GEONET, on the 80th
day of 2011. (aâ€“d) The detrended VTEC maps near local noon (10:57â€“11:06 LT) for satellite PRN 5 (four sampling GPS time epochs 5820, 6000, 6180, and 6360 s).
(eâ€“h) The detrended VTEC maps near local midnight (2:09â€“2:18 LT) for satellite PRN 7 (four sampling GPS time epochs 60540, 60720, 60900, and 61080 s).

4. Justification of the Estimation Method

Before developing the ADDTID method, we attempted to solve the problem of nonuniform sampling by
transforming the maps into regular grids of points on which the estimation of the MSTIDs was conducted.
The following techniques were attempted: interpolation by means of 2-D low-pass filtering, the Fourier
transform of the smoothed 2-D sampled data, the Hough transformation, and kriging. All of which gave
unsatisfactory results.

The approach that we propose is based on both the atomic decomposition of signals [Chen et al., 2001] and
the LASSO [Tibshirani, 1996], which allows for extracting a sparse signal representation from highly over-
complete dictionaries. Each atom of the dictionary represents a possible MSTID. Note that although both
of the approaches are equivalent, the former emphasizes the structure of the dictionary, while the later the
estimation aspects of the problem.

The approach consists of the decomposition of a signal in the span over an overdetermined dictionary and
introducing a penalty in the norm of the weights of the span to obtain a sparse solution. The formal spec-
ification of the method is described in detail in section 5.2. The loss function consists of a mean-square
reconstruction error term and a regularization term on the norm of the parameters.

The reconstruction of the observation from a sparse linear combination of the elements of the dictionary can
be expressed as a convex optimization problem, where the sparseness on the solution is achieved by the
regularization term. The amplitudes of the elements of the dictionary will be mostly zero, except the weights
ğ›¼i,j of the atoms (see equation (4)) that best approximate the value of the VTEC at the pierce points.

The dictionary does not need to be composed of orthogonal elements but can be any arbitrary set of ele-
ments, in particular, a set of elements that is adapted to the problem at hand. The atomic decomposition
has several additional properties that are useful, namely, (a) in addition to dealing with Gaussian noise, one
can also deal with noise of other origins that might introduce a large distortion on some of the samples
(see Appendix A2); (b) allows for a natural way of dealing with the nonuniform sampling process; and (c) pro-
vides an objective criterion for determining the number of MSTIDs. The formal model of the MSTIDs (i.e., the
parametric description) is presented in section 5, equations (5) and (7).

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9558



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

5. Construction of the Dictionary and Estimation Criteria

In this section, we will present (a) the model of the MSTID and the design of the dictionary (see section 5.1),
(b) the definition of the loss function and regularization criteria (see section 5.2), and (c) the method that
computes the sparse decomposition and implementation aspects (see section 5.3).

The dictionary is designed from a model that assumes that the pierce point observations V(x, y) at epoch
t can be expressed as a linear combination of several MSTID waves Ti(x, y), as in equation (5). The parameters
ğ›¼i for epoch t are estimated from the reconstruction error only at the set of pierce points Ix,y . Thus, for a map
containing M MSTIDs we have

V(x, y) =
Mâˆ‘

i=0
ğ›¼iTi(x, y) + n(x, y) (5)

The coordinates x and y are coordinates on the map (note that although the model is for the whole region,
only the IPP coordinates are used in the estimation process), the dictionary atom Ti(x, y)models the wavefront
snapshot of one MSTID wave at epoch t. The term n(x, y) is an additive random noise, and ğ›¼i is the parameter
to be estimated, which represents the amplitude of the ith MSTID.

We will define the vector of amplitudes at epoch t, as ğ›¼t = [ğ›¼1, ğ›¼2, ğ›¼3,â€¦ , ğ›¼N], where N is the size of the
dictionary. The number M of MSTIDs is much smaller than the number of elements of the dictionary N.

5.1. Design of the Dictionary
The model consists of the superposition of several planar monochromatic waves from a dictionary of elements
Ti(x, y). We will model the MSTID A(x, y, t) as a 2-D monochromatic planar wave such as

A(x, y, t) = A0 cos
(

kâƒ— â‹… (x, y) âˆ’ ğœ”(t âˆ’ t0) + ğœ‘0
)

(6)

where kâƒ— is the 2-D angular wave number vector, with the module
|||kâƒ—|||= 2ğœ‹ğœ† ; ğœ† is the wavelength and the nor-

mal vector kâƒ—|||kâƒ—||| = (cos ğœƒ, sin ğœƒ) points in the direction of propagation of the wave. The wave amplitude is A0.
The terms ğœ”, t0, and ğœ‘0 are the angular frequency, the starting epoch, and initial phase of the MSTID wave,
respectively. The ith dictionary element Ti(x, y) at epoch t is defined as follows:

Ti(x, y) = cos
(

2ğœ‹
ğœ†i

(
x cos ğœƒi + y sin ğœƒi

)
+ ğœ‘i

)
(7)

The element Ti(x, y) of the dictionary is characterized by ğœ†i wavelength, ğœ‘i phase, and ğœƒi wave azimuth. The
parameters of each element of the dictionary (ğœƒ,ğœ†, andğœ‘) are quantized as real numbers, with values restricted
to realistic ranges.

The dictionary D is constructed by the concatenation of the set of N elements Ti(x, y), reshaped as vectors,
giving an array D, defined as D = [T1, T2, T3,â€¦ , TN]. The elements Ti(x, y) are generated by assigning to the
parameters {ğœ†, ğœƒ, ğœ‘}, all possible feasible values in a quantized range. Each element Ti(x, y) consists of a grid
of Pv rows and Ph columns, i.e., a uniform sampling of the geographical region of interest. Then, the array is
reshaped to a vector Ti of dimension Pv Ã— Ph. Note that the observations correspond to the IPPs; hence, in the
estimation of the vector, ğ›¼t will be done only with the coordinates (x, y) corresponding to measured IPPs.

5.2. Loss Function and Regularization
Here we will analyze the criterion for estimating the parameters ğ›¼t , by means of a trade-off between a loss
function (i.e., how well we approximate the observations by means of the model) and a regularization term
(i.e., constraints on the possible solutions).

The loss function term implicitly expresses our assumptions about the statistics of the estimation error.
We define our loss function as the logarithm of the likelihood function, i.e., the logarithm of the joint prob-
ability of the observations given the parameters to be estimated. We assume that the probability of the
model depends exponentially on the norm ğ“p of the difference between the observed values and the values
generated by our model. Also, we introduce in the model a regularization term which allows for expressing
desirable properties of the solution. In our case, as we want sparsity on the solution; we will penalize certain

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9559



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

distributions of values of the estimated vector of parameters ğ›¼t by means of a norm ğ“q. Therefore, the general
form of the problem to solve can be expressed as

min
ğ›¼t

â€–V âˆ’ Dğ›¼tâ€–ğ“p , subject to â€–ğ›¼tâ€–ğ“q < ğœ (8)
where V consists of the IPP observations, D is the dictionary for reconstructing the observation at the pierce
points, ğ›¼t is the vector to be estimated at time t, and ğ“p and ğ“q define the norms that are applied to each term
of the optimization problem. Note that the norm of the reconstruction error ğ“p is different from the norm ğ“q
of the regularization term. The above expression can be written in the Lagrangian form as

ğ›¼â‹†t = arg minğ›¼t
1
2
â€–V âˆ’ Dğ›¼tâ€–ğ“p + ğœŒâ€–ğ›¼tâ€–ğ“q (9)

There is a one-to-one correspondence between the parameter ğœ in (8) and ğœŒ in (9); see Hastie et al. [2009] for
details. The arguments for selecting the values of each norm are discussed in detail in sections 5.2.1 and 5.2.2.
5.2.1. Loss Function
The metric ğ“p in the loss function is equivalent to assuming a particular probability distribution of the recon-
struction error in equation (8). In particular, the term â€–V âˆ’ Dğ›¼tâ€–ğ“p can be interpreted as the logarithmic
likelihood of an exponential distribution. The metrics that we considered were the following:

1. ğ“p = ğ“2 assumes a multivariate Gaussian distribution; thus, the logarithmic likelihood function is the sum
of the squares of reconstruction errors. Note that this criterion penalizes quadratically the error, so sample
points where the reconstruction error is significant will have a large impact on the estimation of the
parameters ğ›¼t . That is, the solution will be very sensitive to values far from the mean.

2. ğ“p =ğ“1 assumes a multivariate Laplacian; thus, the logarithmic likelihood function is the sum of the absolute
values of the errors on the data. The key point is that this distribution assumes that important deviations in
the reconstruction error are more likely than the case of a Gaussian distribution; therefore, the penalization
is lower, and the impact of large errors in the estimation of the parameters ğ›¼t is lower.

For the selection of the norm ğ“p, we considered the following fact. The solution to the problem posed by
equation (8) is especially sensitive to the normğ“p, because of the geometry of the pierce points. This is because
as the points are not uniformly distributed over the plane, the IPPs follow a pattern that consists of the pro-
jection of the ground stations to the effective height viewed from the satellite. The consequence is a bias in
the detection of the directions of the waves imposed by the geography of the network. This bias is a conse-
quence of the elongated distribution of receivers and the regions with the highest density of receivers, which
make the outliers dependent on the azimuth of the MSTID.

As a result, the contribution to the reconstruction error of the receivers located on the border of the network
will be larger than those in the central part of the network. This is because small errors in the estimation of
the propagation azimuths will be enhanced over long distances (i.e., NE and SW extremes). That is, a leverage
effect will appear due to the geometry and distribution of the receivers.

If we assume a ğ“1 penalty for the reconstruction error, the outliers have a lower impact in the estimation
compared to the case of ğ“2. Therefore, as we want an estimator that is sensitive to the small deviations of the
estimated angle of the MSTID (i.e., leverage effect), we selected ğ“2 for the loss function. In this way, a small
error in the estimation of the angle will result in a larger contribution to the total error of the IPP located at
the extreme points of the network and therefore will have a high influence in the final estimation. Another
aspect of the estimation of the data is that we would like to impose sparsity in the solution by means of the
regularization term; in this case, the requirements on the norm are inverted.
5.2.2. Regularization Term
The dictionary D is designed to be redundant and with highly correlated elements, in order to detect a specific
family of waveforms. We would like to solve the approximation problem summarized in equation (8) using the
least number of elements of the dictionary, i.e., a sparse solution in the space of the parameters ğ›¼t . This can
be done in principle by means of the pseudometric ğ“0, which minimizes the number of elements different
from zero regardless from their value. For a discussion about why ğ“0 is a pseudometric, see Hastie et al. [2015].
The problem to be solved can be stated as follows:

min
ğ›¼t

â€–ğ›¼tâ€–0, subject to â€–V âˆ’ Dğ›¼tâ€–2 â©½ ğœ€ (10)
YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9560



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

where ğœ€ represents the permissible deviation of the representation Dğ›¼t from the global IPP measurements
of the VTEC map V(x, y). Unfortunately, this problem is not convex and can only be solved by combinatorial
methods, which for the number of unknowns in the problem at hand is computationally unfeasible.

In this section, we argue that the most adequate norm for the regularization term is ğ“1. The objective is to
select the smallest subset of uncorrelated elements of the dictionary while minimizing the reconstruction
error on a dictionary of redundant and nonorthogonal elements that spans the space of possible solutions.

The use of norm ğ“1 gives rise to sparse solutions in the linear regression (see Hastie et al. [2015] for a geometri-
cal explanation) and under certain situations is a good approximation of the pseudonorm ğ“0, which explicitly
minimizes the number of terms different from zero. The use of normsğ“p, with p < 1, increases the sparsity, but
the resulting problem is not convex any more, and therefore, the techniques of convex programming cannot
be used. Consequently, for this problem, we will use the ğ“1 norm as a regularizer on the parameters. Note that
in Appendix A3, we introduce an iterative solution using ğ“1 that indirectly approximates the norm ğ“p, with
p < 1, in order to obtain a more sparse solution.

The technique that fulfills all the requirements is the LASSO [see Hastie et al., 2015] which is stated as an opti-
mization problem that minimizes the square of the reconstruction error, with a regularization norm on the
weights based on ğ“1. This is the technique that was selected for the estimation of the MSTIDs.

A related technique is the elastic net [see Hastie et al., 2015, chap. 4], which is a convex combination of the ğ“1
and ğ“2 norms on the regularization term. In contrast to LASSO, this technique assigns nonzero values to cor-
related elements of the dictionary. But in our case, the dictionary consists of highly correlated atoms, because
the elements consist of a fine-grained enumeration of the parameters of the wavefronts. In our preliminary
experiments, we found that the elastic net yielded poor performance; therefore, it was discarded. On the other
hand, the use of only the ğ“1 norm on the regularization term gives a crisp solution assigning the resources
to only clearly distinct elements, which is compatible with our initial hypothesis that there is only a limited
number of distinct MSTIDs.

Finally, to solve an ambiguity that might arise in the estimation coefficients ğ›¼t , we impose the solution to be
in the first quadrant, that is that all the elements of the vector ğ›¼t should be positive. This is justified by the
interpretation of coefficients ğ›¼t as amplitudes for each existing MSTID and by the fact that changing the sign
of an element of the vector ğ›¼t that multiplies the elements of the dictionary Ti(x, y) (see equation (7)) equals
a change in the phase ğœ‘i of 180

âˆ˜.

5.3. Parameter Estimation: The LASSO Solution
Finally, the components of the MSTIDs are obtained by solving an optimization problem with a term on ğ“2 for
the reconstruction error and a term on ğ“1 for the regularization term. This can be stated as the following:

ï¿½Ì‚ï¿½t = arg min
ğ›¼t

1
2
â€–V âˆ’ Dğ›¼tâ€–22 + ğœŒâ€–ğ›¼tâ€–1 (11)

The sparseness of the solution will depend on an independent parameter ğœŒ which has to be adjusted as
explained in Appendix A1. Empirically, we have found a low sensitivity of the sparseness with respect to the
parameter ğœŒ, since the number of active elements of the dictionary is piecewise constant for wide margins of
ğœŒ. Also note that in the final implementation, we iterated the above equation as shown in Appendix A3.

5.4. MSTID Detection and Velocity Estimation
For a given snapshot, the solution to equation (11), even if no MSTIDs are present, will always find a set of
parameters ğ›¼t that minimize the approximation of the VTEC map V in terms of the dictionary D. Therefore, to
decide the presence of MSTIDs, we used two criteria, (a) continuity of the parameters in a sliding window of
20 snapshots (600 s) and (b) the value of ğœŒ.

The continuity of parameters was decided inside the window of 20 snapshots (i.e., 600 s) to reduce the rate of
false detections. Additionally, this allowed for having enough samples of phase ğœ‘ for computing the velocity.
The continuity criterion consisted of setting the variation of parameters between the snapshots within the
following ranges: azimuth Î”ğœƒ = Â±5âˆ˜ and wavelength Î”ğœ† = Â±10 km. To decide that a MSTID was present,
the length of continuity had to be greater than 600 s. Thus, the tracking of the MSTID between consecutive
snapshots allowed for a slow drift in the parameters with time.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9561



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

The value of ğœŒ is crucial for making the method work. A property of the LASSO that arises from the use of
ğ“1 in the regularization term of equation (11) is that the number of elements in ğ›¼t that are different from
zero is constant for a large margin of variation of ğœŒ [see Hastie et al., 2015, chap. 1]. Therefore, the number
of elements of ğ›¼t different from zero is constant inside large margins of the value of ğœŒ. Empirically, we have
determined that values of ğœŒ in the low margin are associated with the absence of MSTIDs. This was determined
by visual inspection of the maps and by a lack of continuity of the parameters of the MSTID. The strategy
that we followed for determining the number of distinct MSTIDs was to solve equation (11) for an initial value
that detects no MSTIDs and reduce the value of ğœŒ iteratively by 0.8 at each step. Once a set of several MSTIDs
were determined in a stable subrange of the margin, we applied the reweighting method that determines
an approximation to a ğ“0 solution, i.e., minimizing explicitly the number of elements different from zero that
yield the best approximation (see Appendix A3).

The estimation of the velocity is dependent on the continuity tracking of each MSTID, because it is derived
from the slope of the phase ğœ‘ (see Appendix A1). Note that phase ğœ‘ from each snapshot is in a different hor-
izontal coordinate system, taking the center of mass of the pierce point set as the origin. This center of mass
varies from one snapshot to the next (see section 2.2); therefore, the phase ğœ‘ has to be updated by changing
into a unified coordinate system. Moreover, the noise estimation of the phase ğœ‘ translates into higher uncer-
tainty in the estimate of the slope. Also, when the continuity in the tracking is broken, even in small gaps, the
error on the estimate of the slope can be extremely high. Dealing with issues of the increase of the estima-
tion errors and outliers is critical for the correct estimation of the velocity. Thus, the estimate of the velocity is
performed from the slope of the phases ğœ‘ of each MSTID, by means of the regression method that is robust
to the presence of outliers, such as the Random Sample Consensus (RANSAC) method [see Fischler and Bolles,
1981]. The use of the RANSAC method is key for obtaining good estimates of the velocity.

The details of the implementation and design choices of the algorithm are discussed in Appendices A1â€“A3.
The details are important to be able to reproduce the experiments and also to understand some implemen-
tation choices that make the method more accurate and less computationally expensive.

6. Experiments

In this section, we test the performance of the algorithm in two situations, (a) simulated data in a realistic
scenario, i.e., GNSS data, which are a superposition of several preset modeled MSTID waves and noise and
distortions of different origins, and (b) actual dual-frequency carrier phase GNSS measurements on a given
representative day for all the stations, i.e., GNSS data from GEONET on the 80th day of 2011. For comparison
purposes, we will present as benchmarks the estimated MSTIDs with the comprehensive GNSS Ionospheric
Interferometry (cGII) technique [see HernÃ¡ndez-Pajares et al., 2012].

6.1. Evaluation of the ADDTID Algorithm on a Simulated Scenario
To test the ADDTID algorithm, we simulated three simultaneous MSTIDs at real IPP locations, measured on
the 80th day of 2011. The simulation was based on the measurements of the detrended VTEC maps in
HernÃ¡ndez-Pajares et al. [2006] and were generated following the model in equation (7) in section 5.1, using a
realistic set of parameters.

The experiment consists of a temporal sequence of the detrended VTEC maps affected by three different
MSTID waves which are occurring at the same height (250 km, to make the experiment compatible with the
estimate with real data; for justification, see the beginning of section 6.2). The parameters of the three waves
are summarized in Table 1. The values of the azimuths and amplitudes were selected to generate a pessimistic
scenario, i.e., similar azimuths, one of them almost 180âˆ˜ with respect to the others, and a ratio of amplitudes of
1âˆ•3 between the main MSTID and the smallest. To simulate the parameter drift as a function of time in the real
waves, we fixed an initial value which was perturbed cumulatively by a random percentage at each snapshot;
that is, we created Brownian motion of the parameters. This drift percentage was 0.1% for the wavelength,
0.5% for the velocity, and 0.5% for the azimuth and was selected following a subjective criterion of visual
similarity between the simulated evolution of the maps and the real maps.

In addition, it should be remarked that the introduction of this drift allows for testing the performance of
the system, when the parameters of the MSTID do not correspond exactly to the values of the elements of
the dictionary. This last point should be emphasized for two reasons. The first is related with modeling real-
istic drifts in time in the features of the maps, while the second is related with the methodology. It is highly

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9562



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Table 1. Parameters of the MSTID in the Simulated Experiment

TID Amplitude Wavelength Velocity Azimuth

Waves (TECU) (km) (m/s) (deg)

T1(x, y) 0.3 91.58 150.50 76
T2(x, y) 0.6 156.71 90.77 275
T3(x, y) 0.9 254.85 200.21 124

improbable that the dictionary will contain
parameters that match exactly the parameters
of a real MSTID. This methodological aspect is
important, because we have checked experi-
mentally that when the parameters of the dic-
tionary coincide with the values of the wave to
be estimated, the ambiguity with the value of ğœ‘
is much lower, which would show unrealistically
good performance.

To simulate a multiplicative distortion, which could be related among other reasons to the elevation angle
and loss of measurements from one station and cycle slips, we decided to take the most pessimistic approach,
which consisted of the substitution of the value at the partial pierce points of a given satellite with Gaussian
noise, as shown in equation (12).

Therefore, using the same locations of the measured IPPs Ix,y at each epoch t, the time series of the detrended
VTEC Vs(x, y) was created as follows:

Vs(x, y) =
â§âªâ¨âªâ©

3âˆ‘
k=1

Tk(x, y) + n(x, y) , if (x, y) âˆ‰ Rx,y
n(x, y) , if (x, y) âˆˆ Rx,y

(12)

where n(x, y) is the random Gaussian noise term set at SNR = 0 dB. In addition, 10% of the IPPs of each satellite
(set denoted as Rx,y) are left with no MSTID activity to account for the above mentioned multiplicative dis-
tortion. The MSTID activity maps were constructed from the simulated GNSS data Vs(x, y), and the estimation
of the number of MSTIDs and the parameters of each MSTID at a given snapshot was done by means of the
method presented in Appendices A1â€“A3.

The resulting scatterplot in polar coordinates (azimuth versus velocity) is shown in Figure 3. The simulation
spanned a 24 h period, using real IPPs of all satellites, i.e., comprising the same IPPs and elevations as the real
data. Figure 3 shows that three MSTIDs are detected. The value of the azimuth corresponding to each MSTID
is estimated almost exactly; nevertheless, the velocity estimate has a higher variability. For the simulation we
selected a SNR = 0 dB, which explains that the variability of the velocity is higher than that estimated from the

Figure 3. (left) Polar plot (velocity versus azimuth) of the estimated MSTIDs (histogram of the velocity module
superimposed on the plot) and histograms of the estimated (top right) wavelengths and (bottom right) amplitudes;
the GNSS observation data were simulated from GEONET, for all the satellite PRNs, on the 80th day of 2011.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9563



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

real data. This SNR was selected to test the robustness of the method in adverse conditions. Also, the low SNR
in the simulation affected all satellites equally, while for the real data, the SNR depends on the elevation of
the satellite. In the same Figure 3, we present the histogram of the velocities, and the mode of the histograms
is near the real value. Note that even though the T1(x, y) MSTID had the lowest amplitude and the angle was
selected so that it was almost 180âˆ˜ with respect to the T2(x, y), its parameters could be estimated correctly.
On the other hand, the variability in the estimation of the velocity of T3(x, y) had a much lower variability in
the estimation.

The histograms of the wavelength and amplitude estimations are presented in Figure 3 (right column).
The estimate of the wavelength was as accurate as the estimate of the azimuth. On the other hand, the value of
the estimated amplitude presented a systematic downward bias, preserving the relative ranking. This down-
ward bias on the estimation of the detrended VTEC is due to the regularization term in equation (11) and is
inherent to the algorithm. Note that in both cases, the variability of the estimation is small. The number of
MSTIDs is determined correctly, in the sense that there were no false MSTIDs. The determination of the number
of MSTIDs present was conducted using the reweighted LASSO (see Appendix A3 for details and justification).
The initial estimate of the LASSO gives several candidates that might be very similar, and the process of renor-
malization combines the candidates that are compatible with the hypothesis of a unique wave. Also, it should
be emphasized that the number of MSTIDs to be detected is a free parameter, and the algorithm finds the
total number of MSTIDs along with their parameters.

6.2. MSTID Estimation From Real Dual-Frequency Carrier Phase GNSS Data: Results and Discussion
In this section, we test the method on real GNSS data from the GEONET in Japan. We selected the 80th day
of 2011 (i.e., 21 March, the first day after the vernal equinox), because it exhibits a rich typology of MSTIDs
that might show the frequent winter-like daytime characteristics [Kotake et al., 2007], nighttime propaga-
tion excited by solar terminator [Afraimovich et al., 2009], and summer-like propagation in the whole day
[Oinats et al., 2015]. There were no disturbances originated by phenomena such as major geomagnetic
storms, solar flares, significant earthquakes, tsunamis (no corresponding ionospheric disturbances in the
GEONET-observing region recorded in U.S. Department of Commerce [2011a, 2011b, 2011c]), or strong geo-
magnetic activities (the planetary 3 h range index kp â‰¤ 3) [see U.S. Department of Commerce, 2011d].
Moreover, the hourly height distribution of peak electron density (hmF2) on this day was from 250 km to
350 km (the hmF2 data of the International Reference Ionosphere 2012 model (IRI-2012) [see Bilitza et al.,
2014], obtained from National Aeronautics and Space Administration/Goddard Space Flight Center (NASA/GSFC)
[2012]). According to HernÃ¡ndez-Pajares et al. [2006], the maximum MSTID generation occurs at the height
below hmF2 because the MSTIDs are generated by the interaction between the neutral and ion particles. We
assumed that the most frequent dominant MSTIDs are generated below hmF2, so we took 250 km as the mean
effective height of the MSTIDs, which is lower than the average hmF2 of 290 km.

In the following sections, we apply the ADDTID algorithm to real dual-frequency carrier phase GNSS data of
GEONET, and for the March equinox we present the following results: (a) the detection and estimation of the
parameters of simultaneous MSTIDs at daytime and nighttime (see 6.2.1), (b) the detection of several MSTIDs
that propagate in the same direction but with different wavelengths and velocities (see 6.2.2), (c) the detection
of several MSTIDs that propagate in opposite directions (see 6.2.3), and (d) the detection of circular waves
(see 6.2.4).
6.2.1. Characterization of Multiple MSTIDs at Daytime and Nighttime
In this section, we present the estimation results in two scenarios, (a) performance of the ADDTID method at
noon, and at midnight for a single satellite, and (b) MSTID characteristics throughout the day, in intervals of
24 h, for all the satellites. In each case, we give a discussion of the results.

In the first scenario we examine the performance at the two periods of the day, i.e., between 10:00â€“12:00 LT
(for satellite PRN 5) and 1:00â€“3:00 LT (for satellite PRN 7). Satellite PRN 5 was selected because it presented
several simultaneous MSTIDs with similar amplitudes, while satellite PRN 7 was selected to illustrate the
case of the detection of simultaneous MSTIDs when one MSTID had an amplitude significantly higher than
the other.

By visual inspection, one can see in Figures 2aâ€“2d that the maps (at around 11:00 LT for satellite PRN 5) show
the interference pattern of several simultaneous 2-D MSTID waves. In these maps, one can measure two dom-
inant MSTIDs that propagate in the equator-east and equator-west directions, with wavelengths of about

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9564



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 4. Time evolution of the MSTID estimates of azimuths, wavelengths, velocities, and amplitudes at local noon
and midnight from the GEONET network, on the 80th day of 2011. (aâ€“d) The time evolution of the MSTID estimates at
the local noon (10:00â€“12:00 LT) for satellite PRN 5. (eâ€“h) The time evolution at the local midnight (1:00â€“3:00 LT) for
satellite PRN 7.

135 km and 180 km and velocities of 150â€“200 m/s and 200â€“250 m/s, respectively. The maps in Figures 2eâ€“2h
show a predominant MSTID wave that propagates in the northwest direction with wavelength between 250
and 300 km and a velocity between 125 and 200 m/s. In the daytime case, the MSTID waves had similar ampli-
tudes, which gave rise to the interference pattern, but in the nighttime case, at a given time one MSTID had
an amplitude significantly higher than the others. The results given by the ADDTID algorithm are compatible
with the visual analysis. In Figure 4, we show the time evolution of the estimates by means of the ADDTID
algorithm of the MSTID parameters for satellite PRN 5 (Figures 4aâ€“4d) and satellite PRN 7 (Figures 4eâ€“4h).
Each individual MSTID is identified by a color code. Figures 4aâ€“4d show the evolution of several MSTIDs during
the time interval from 10:00 to 12:00 LT. The azimuth time series shows the overlap and continuity of differ-
ent MSTIDs, having up to three different MSTIDs at different moments. Figures 4eâ€“4h show the evolution at
nighttime for satellite PRN 7. The ADDTID algorithm, in addition to detecting the predominant MSTIDs, also
detects at times two or three different MSTIDs. The predominant MSTIDs is consistent with the azimuth seen
visually at Figures 2eâ€“2h. Also, note that the algorithm is able to follow drifts in the parameters of the MSTIDs
as a function of time.

The second scenario is summarized in Figure 5, where we show the time evolution (0:00â€“24:00 LT) of the
MSTID parameters: azimuth, wavelength, velocity, and period, estimated by the ADDTID method. Each MSTID
is identified by a different color code, and the amplitude is coded by the size of the points (i.e., the larger
the size, the higher the amplitude). In Figure 5 we show the time evolution of the velocity of each MSTID.
The algorithm is able to track the slow changes of the velocity with continuity. Likewise, the period of the
MSTIDs shows also a slow continuous change for each individual MSTID, but during nighttime the different
MSTIDs show a collective high variability in the range of 500â€“2700 s.

In Figure 6 we compare the results of the ADDTID method with the cGII method for the case of the azimuth.
The MSTID estimates by means of the cGII method were performed from eight subsets of GEONET stations,
which are indicated by blue dots in Figure 1 (left). Note that the ADDTID method allows the detection of indi-
vidual MSTIDs by introducing continuity constraints, which greatly reduces the estimation noise. The MSTIDs
time series can also be characterized by means of the azimuth versus velocity polar plots at intervals of 1 h,
as shown in Figures 7 (ADDTID) and 8 (cGII). The results of both models are consistent in terms of directions
and intensities. The main difference was that the ADDTID detects the azimuths of each MSTID with a much
lower dispersion and that MSTIDs with similar azimuths can now be distinguished. A difference between the
intensities shown in the figures resides in the fact that the ADDTID estimates individual amplitudes, which
are coded by the color intensity of the dots. In the case of cGII, the information related to the intensity of
the MSTID is the root-mean-square of the detrended VTEC of all satellites, i.e., Single Receiver Medium-scale

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9565



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 5. Time evolution (0:00â€“24:00 LT) of the (top left) estimates of azimuth, (top right) wavelength, (bottom left)
velocity, and (bottom right) period of the MSTID propagation estimated by means of ADDTID. The individual MSTIDs are
color coded, and the amplitude is represented by the size of the points, from the GEONET network for all GPS satellites,
on the 80th day of 2011.

Traveling Ionospheric Disturbance (SRMTID) index (see for details HernÃ¡ndez-Pajares et al. [2012]), which is
coded by the color intensity of the dots. The apparent dispersion of velocity seen in the two figures is due to
the fact that the velocity of the MSTIDs changes in a continuous way during the time interval corresponding
to the plots.

Discussion. The distribution of the MSTID estimates follow typical daytime and nighttime patterns of the March
equinox. During the daytime, especially near local noon (8:00â€“16:00 LT; see Figures 2aâ€“2d, 5, and 7), the iono-
spheric activity is at the maximum level. More than 10 simultaneous MSTIDs were detected by the ADDTID
method. These MSTIDs presented amplitudes in the range of 0.02â€“0.1 TECU, with azimuth directions from

Figure 6. Time evolution (00:00â€“24:00 LT) of the estimates of azimuth, for the GEONET network. (left) ADDTID and
(right) cGII. GEONET network for all GPS satellites, on the 80th day of 2011.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9566



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 7. Intensity polar plots of the MSTIDs, velocities (in m/s), and azimuths (in degree) for the whole day detected by
ADDTID; the color intensity is weighted by the MSTID amplitude (in TECUs), by local hour, from the GEONET network for
all GPS satellites, on 80th day of 2011.

north to the equator/equator-east, velocities in the range from 100 m/s to 300 m/s, the wavelengths in the
range of 120â€“250 km, and periods in the range of 600â€“2000 s. The daytime behavior of the MSTIDs in the
March equinox agree with the daytime MSTID behavior in the winter, as mentioned in HernÃ¡ndez-Pajares et al.
[2012]. These similarities are also mentioned in Otsuka et al. [2011] (GEONET) and Kotake et al. [2007] (California
GPS network).

In contrast with the daytime, the MSTID activity is weaker and more irregular during the rest of the day. This
is due to the smaller overall intensity of the MSTIDs at nighttime and during the morning/evening solar ter-
minator as shown in Figure 5. During nighttime (i.e., 00:00â€“04:00 LT and 20:00â€“24:00 LT), the amplitudes
of the dominant MSTIDs are in the range of 0.005â€“0.13 TECU. From the features of the distribution of the
parameters of the MSTID shown in Figure 5, one can categorize the nighttime MSTIDs into two types:
the weak nighttime MSTIDs with amplitude in the range 0.005â€“0.02 TECU and the strong nighttime MSTIDs in
the range of 0.02â€“0.13 TECU. The weak nighttime MSTIDs, accounting for 80% of the total estimated nighttime
MSTIDs, propagate all westward direction (southwestward/westward/northwestward), with velocities in the
range of 100â€“250 m/s. This is consistent with the nighttime MSTID behavior in summer [see HernÃ¡ndez-Pajares
et al., 2012]. The wavelengths were in the range of 150â€“450 km and show a much higher variability than in
summer (50â€“250 km) [HernÃ¡ndez-Pajares et al., 2012]. The range of the estimated wavelengths is consistent
with the range 150â€“500 km in winter/summer as mention by Tsugawa et al. [2007a]. The characteristics of
weak nighttime MSTID propagation are compatible with the case study of nighttime MSTIDs in equinoxes for
midlatitude mentioned in Otsuka et al. [2011] and Oinats et al. [2015]. The above mentioned properties are
summarized in the detrended VTEC maps in Figures 2eâ€“2h and in the estimates as shown in Figures 5 and 7
[HernÃ¡ndez-Pajares et al., 2012].

The strong nighttime MSTIDs have higher velocities, shorter periods, and weaker velocities than their weaker
counterparts. The strong nighttime MSTIDs have a higher amplitude up to 0.13 TECU. The wavelengths have

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9567



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 8. Intensity polar plots of the MSTIDs, velocities (in m/s), and azimuths (in degree) for the whole day detected by
cGII; the color intensity is weighted by the RMS detrended VTEC (in TECUs) from the visible satellites, by local hour, from
the GEONET network for all GPS satellites, on 80th day of 2011.

a much higher mean and dispersion and the velocities present in the range of 400â€“600 m/s as can be seen in
Figure 5. This feature of the velocity component appears in the results of both methods, ADDTID and cGII. See,
for instance, Figures 7 and 8. Figure 9 shows the time interval between 20:00 and 21:00 LT, where two MSTIDs
are found with velocities over 400 m/s. This range of velocities is compatible, with Deng et al. [2013], where
they report a fast MSTID in the local morning (about 8:00 LT) propagating from east to west across Germany
with a velocity of about 700 m/s, a period of 420 s, and a wavelength of 302 km.

During the morning and evening solar terminators (04:00â€“08:00 and 16:00â€“20:00 LT), the MSTIDs occur simul-
taneously in both directions (equator-eastward and westward, respectively), as shown in Figure 5. During the
morning terminator, the westward MSTIDs are weaker, while the MSTIDs toward equator-east are stronger.
The evening pattern shows the opposite behavior. These features are also mentioned by Kotake et al. [2007]
and Otsuka et al. [2011] for dominant MSTIDs propagation during the morning/evening solar terminator
introduced in the California GPS network. The explanation is that the MSTIDs of the morning/evening solar
terminator propagate in the direction contrary to the direction of the neutral winds, which always blow from
dayside to the nightside. Another compatible observation of the equinox MSTIDs [see Afraimovich et al., 2009]
are of magnetohydrodynamic (MHD) nature and are produced immediately after evening solar terminator.

6.2.2. Different MSTIDs That Propagate in Almost Identical Azimuths
Figures 9aâ€“9d show the presence of two different MSTIDs with the same azimuth and different wavelengths
and velocities. To show more clearly the superposition of both waves, we projected the detrended VTEC in
the direction given by the estimated azimuth, which is plotted superimposed on the figure in purple.

Discussion. Both MSTIDs (20:00â€“21:00 LT) propagate in the west/equator-west direction, with a similar velocity
of about 500 m/s but with wavelengths of about 450 km and 250 km. From these figures, one can see that
the dominant MSTID has a wavelength of 450 km. The resulting projected waveform follows the form of the

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9568



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 9. Two MSTIDs with different wavelengths that propagate in almost identical azimuths at nighttime, from GEONET, for satellite PRN 31, on the 80th day
of 2011. (aâ€“d) Two MSTID propagations of different wavelengths, as detrended VTEC maps along with the detrended VTEC projection onto the propagation
azimuth coded in purple (in TECUs). At nighttime, 20:08â€“20:17 LT, for four snapshots at GPS time 38,880, 39,060, 39,240, and 39,420 s. (eâ€“h) The corresponding
time evolution of the two MSTIDs at nighttime (20:00â€“21:00 LT) by azimuth, wavelength, velocity, and amplitude.

superposition of two sinusoids of different amplitudes (one is up to 0.06 TECU, and the other is up to
0.09 TECU). Note also that the amplitude plot indicates that the MSTID associated with the longer wavelength
was the dominant MSTID, which is compatible with the projected waveform and visually corresponds to the
sum of a large-amplitude, long-wavelength sinusoid with that of a lower amplitude, shorter-wavelength sinu-
soid. Note that these two MSTIDs were found from the examination of the time series given by the ADDTID
method (i.e., see Figures 9eâ€“9h). The detection of this type of phenomena can be automated using simple
rules on the temporal evolution of the parameters.
6.2.3. Different MSTIDs That Propagate in Almost Opposite Azimuths
Figure 10 shows the event where two MSTIDs propagate in opposite azimuths and are characterized by dis-
tinct parameters. The two wavefronts moving oppositely appear just before the morning solar terminator
(about 5:00 LT) and can be clearly observed from the detrended VTEC maps (Figures 10aâ€“10d).

Discussion. These two MSTIDs with similar amplitudes about 0.005 TECU are observed before the morning
solar terminator (4:30â€“5:30 LT). The first MSTID propagates in the northeast direction and is located at the
northeast corner of the map. This MSTID can be distinguished because it consists of a narrow wavefront occur-
ring with a wavelength of about 140 km. The second MSTID can be distinguished because it consists of a flat
and wide wavefront that propagates in the west/equator-west direction. This MSTID is in the southwest cor-
ner of the map, with wavelengths of about 200 km. These two MSTIDs were found from the examination of
the time series given by the ADDTID method in Figures 10eâ€“10h, by searching for MSTIDs with azimuth paths
separated by 180âˆ˜, and afterward confirming the findings on the VTEC maps.
6.2.4. Circular Waves in a Day Without Special Ionospheric Events
Next, we present the detection of circular waves in a day without special ionospheric events (see explanation
at the beginning of section 6.2). In Figure 11, we show the correspondence between the visual appearance of
the VTEC maps (Figures 11aâ€“11d) and the temporal sequence of the estimated parameters (Figures 11eâ€“11h).

Discussion. Although the algorithm is designed to detect plane waves, by looking at the time evolution of the
parameters, we observe that the algorithm detects several MSTIDs that have azimuths compatible with the
local plane approximations of the waveform of the circular waves observed in Figures 11aâ€“11d. Previously,
circular waves of the ionospheric disturbances have been reported [see, e.g., Tsugawa et al., 2011], where the
circular waves appear locally in the form of planar waves for each set of IPPs of a given GPS satellite. This is
consistent with our findings. A manual estimation by means of a ruler on the left maps give results that are

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9569



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Figure 10. Two MSTIDs that propagate in almost opposite directions during the morning solar terminator at about 5:00 LT, from GEONET, for satellite PRN 28,
on the 80th day of 2011. (aâ€“d) The propagation pattern of two MSTIDs with opposite azimuth as detrended VTEC maps (in TECUs) at nighttime (4:56â€“5:05 LT),
for four snapshots at GPS time 70,560, 70,740, 70,920, and 71,100 s. (eâ€“h) The corresponding time evolution of the parameters at nighttime (4:30â€“5:30 LT) by
azimuth, wavelength, velocity, and amplitude. Note that at 4:56â€“5:05 LT there are two MSTIDs with an azimuth difference of 180âˆ˜.

almost equal to the parameters shown in Figures 11eâ€“11h. This estimation is done from the local slope of
the waves at different regions of the map, at a given time, for instance, at 17:30 LT. These local approxima-
tions to planar waves propagate in the northwest direction, with common values of the other parameters,
such as wavelength about 100â€“200 km, velocity about 120â€“200 m/s, and the period about 1000 s. Note also
the low variability of the wavelengths and velocities associated with each MSTID. In addition, the amplitude
of the planar waves alternates, which hints at the fact that they all have almost the same energy. Note that
the differences in the values of the wavelength and velocity arise because of the different widths of Japan.
The difference in the precision is because in the center, more cycles are measured, while at the north or south

Figure 11. Circular-like MSTIDs during the evening solar terminator about 17:30 LT, from the GEONET, for satellite PRN 14, on the 80th day of 2011. (aâ€“d) Circular
MSTID in the detrended VTEC maps (in TECUs) at evening time (17:27â€“17:36 LT), for four snapshots at GPS time 29,220, 29,400, 29,580, and 29,760 s. (eâ€“h) The
time evolution of the estimated parameters during the time interval 17:00â€“18:00 LT, by azimuth, wavelength, velocity, and amplitude.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9570



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

there is a lower number of cycles. Note that an automatic detection of the candidates for circular waves can
be done from the temporal evolution of the parameters by means of simple rules.

This finding, obtained thanks to the extreme sensitivity of the new ADDTID technique, might be generated by
two earthquakes of magnitude M 4.6 and M 4.9 in a 3 min interval (recorded at respectively 17:29 and 17:26 LT
in U.S. Geological Surve (USGS) [2011a, 2011b]). These earthquakes occurred a few hundred seconds before the
detected waves and are compatible with the center of the circular ionospheric wave. A similar precedent of a
delay between occurrence of the 2011 Japan Tohoku earthquake and the circular wave disturbances detected
over Japan is reported in Tsugawa et al. [2011]. In this case the delay was of about 7 min after the earthquake.
The novelty of this finding, regarding previous works performed on major earthquakes (with magnitudes
greater than 6), is the detection by the perturbation on the ionosphere despite the relative low magnitude of
the earthquake.

7. Conclusion

We have presented the Atomic Decomposition Detector of MSTIDs (ADDTID), a comprehensive multi-MSTID
detection technique, and successfully applied it in both simulated and actual data in wide and dense networks
of GNSS permanent receivers, such as GEONET in Japan. The method that we have presented improves the
previous cGII method [see HernÃ¡ndez-Pajares et al., 2012] in the sense that it simultaneously can detect differ-
ent MSTID planar waves and estimate their parameters. The new method is compared with the cGII method
as a benchmark. The general properties are consistent with results of previous studies [e.g., Jacobson et al.,
1995; HernÃ¡ndez-Pajares et al., 2006; Tsugawa et al., 2007a, 2007b; HernÃ¡ndez-Pajares et al., 2012; Otsuka et al.,
2013]. The main contribution of the method for the study of MSTIDs can be summarized as follows: (a) the
distribution and tracking of simultaneous MSTID, i.e., temporal variation of the azimuth, velocity, amplitude,
and wavelength, and the determination of the number of MSTIDs present at a given moment; (b) the obser-
vation of MSTIDs with velocities much higher than 400â€“600 m/s during nighttime and the solar terminator;
(c) the detection of different simultaneous MSTIDs with the same azimuth or differences of azimuth of 180âˆ˜;
(d) the detection of circular waves that are compatible (in time and space) with the occurrence of two consec-
utive earthquakes of low magnitude; and (e) the possibility of creating rules for automatically finding special
distributions of the MSTIDs without a visual inspection of the VTEC maps.

In the future, we will explore extensions of the wave model to include MSTID circular or elliptic waves, which
appear in the case of earthquakes and are of interest and complement the study that we have presented.
Note also that in some cases the planar wave model detects multiple, distinct MSTIDs with azimuthal pat-
terns consistent with a spherical wave. This further justifies future work to incorporate circular or ecliptic
wave models.

Appendix A: Implementation Details
A1. Two-Step Estimation of the MSTIDs Parameters
The MSTID model presented in equation (7) is characterized by three parameters: {ğœ†, ğœƒ, ğœ‘}. As the recon-
struction error depends on the parameters through trigonometric functions, and a division, this error is more
sensitive to some parameters than others. Specifically, the impact of small deviations of the parameters {ğœ†, ğœƒ}
on the final performance is much higher than the case ofğœ‘. The method is extremely precise in the estimation
of the angle of propagation and wavelength, but the velocity estimation is less accurate, possibly because it
is computed from differences of ğœ‘ at each snapshot. Taking this into consideration, the estimation strategy
will have two steps; in the first step, the parameters {ğœ†, ğœƒ} are estimated using a dictionary fine grained in the
range of these parameters and rough in {ğœ‘}. In the second step, the estimation is done with ğœ† and ğœƒ fixed to
the values of the first step, and the parameter ğœ‘ will be used to construct a new dictionary with a fine-grained
range of values.

The effect of splitting the estimation into two steps also has an important impact on the computational
requirements of the problem. If the granularity (i.e., increments) on the values of each parameter were of n, the
size of the dictionary would be O(n3). By dividing the estimation into two phases, the dictionary of the struc-
ture in equation (A4) gives a requirement of O(n2) for the first phase. The resulting nonzero-weight elements
of the dictionary of the detected MSTID in the first phase M (where M << N) reduces the total number of
operations on the second phase to O(Mn). The range of values n needs to be adapted to the problem at hand,
which depends on the margin of phases, frequencies, and azimuths of the MSTIDs that we want to detect.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9571



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

Step I. Estimation of ğ€, ğœ½, and the number of MSTIDs. For the estimation of {ğœ†, ğœƒ}, we can simplify the
dictionary by means of simple trigonometry; the parameter ğœ‘ of the elements Ti(x, y) of the dictionary (see
equation (7)) is absorbed by the amplitude of the wave. Thus, the element Ti(x, y) for the snapshot t is

ğ›¼iTi(x, y) = ğ›½i cos
(

2ğœ‹
ğœ†i

(
x â‹… cos ğœƒi + y â‹… sin ğœƒi

))
+ ğ›¾i sin

(
2ğœ‹
ğœ†i

(
x â‹… cos ğœƒi + y â‹… sin ğœƒi

))
(A1)

which can be rearranged as two new dictionary elements as

Tğ›½i(x, y) = cos
(

2ğœ‹
ğœ†i

(
x cos ğœƒi + y sin ğœƒi

))
(A2)

Tğ›¾ i(x, y) = sin
(

2ğœ‹
ğœ†i

(
x cos ğœƒi + y sin ğœƒi

))
(A3)

where ğ›½i and ğ›¾i are the amplitudes of the pair orthogonal sinusoidal basis, which satisfy the relationship of
ğ›½i = ğ›¼ti cos(ğœ‘i) and ğ›¾i = âˆ’ğ›¼ti sin(ğœ‘i). Note that the values of ğ›½i and ğ›¾i are used only for deciding the set of
elements of the dictionary Ti(x, y) to be used in the following step.

Although the phase ğœ‘i can be obtained from ğ›½i and ğ›¾i , by their ratio and the use of the atan function, this
method is extremely unreliable, which justifies postponing the estimation of ğœ‘i for step II. The estimation of
ğœ‘ is done in step II keeping the fixed values ğœ† and ğœƒ estimated in step I.

The dictionary DI for step I has the following structure:

DI = [Dğ›½ ,Dğ›¾ ] = [Tğ›½1, Tğ›½2,â€¦ , Tğ›½N, Tğ›¾1, Tğ›¾2,â€¦ , Tğ›¾N] (A4)

where Tğ›½i and Tğ›¾ i denote the elements of the dictionary defined in equations (A2) and (A3) with the corre-
sponding parameters ğœƒğ›½i, ğœ†ğ›½i and ğœƒğ›¾ i, ğœ†ğ›¾ i . We denote the vectors of the weights associated with each estimated
parameter as ğ›½t and ğ›¾t . Note that we did not introduce a constraint in the elements of the vectors ğ›½t and ğ›¾t so
that they should be non-null simultaneously; we decided to take as candidates of MSTID the union of indices
i found in both vectors, to filter the values in step II. That is, some of the candidates to be detected MSTIDs will
be discarded in the second step. The map V(x, y) at epoch t can be expressed as follows:

V(x, y) = DI â‹… [ğ›½t, ï¿½Ì‚ï¿½t]
T = Dğ›½ â‹… ğ›½t + Dğ›¾ â‹… ï¿½Ì‚ï¿½t (A5)

where the vector of coefficients ğ›½t and ï¿½Ì‚ï¿½t are estimated by means of the LASSO algorithm. The elements of
the dictionary DI associated with the coefficients ğ›½t and ï¿½Ì‚ï¿½t different from zero determine the wavelengths ï¿½Ì‚ï¿½t
and directions ï¿½Ì‚ï¿½t of each MSTID candidate and are the input for the next step.

Step II. Estimation of ğ‹. In step I at epoch t, we detect a set of M possible MSTIDs candidates. We define the
parameters of the ith detected MSTID at epoch t as the pair (ï¿½Ì‚ï¿½i, ï¿½Ì‚ï¿½i), which remains fixed in step II, where we
create a new smaller dictionary for estimating the ğœ‘i associated with each pair (ï¿½Ì‚ï¿½i, ï¿½Ì‚ï¿½i), from a new variable
that is more suitable. We will denote it as B and is defined as B(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j =

ï¿½Ì‚ï¿½i
2ğœ‹
ğœ‘(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j

(see equations (A6) and (A7)
below). Thus, given a pair (ï¿½Ì‚ï¿½i, ï¿½Ì‚ï¿½i), we create j = 1, 2,â€¦ ,N possible values of B(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j . An error analysis showed
that the expression (A7) has a lower sensitivity to the estimation error of ğœ‘j than (A6). Hence, the dictionary is
parametrized by B(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j .

The structure for the elements j associated with the pair (ï¿½Ì‚ï¿½i, ï¿½Ì‚ï¿½i) of the dictionary of step II will be as follows:

T(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j(x, y) = cos

(
2ğœ‹

ï¿½Ì‚ï¿½i

(
x â‹… cos ï¿½Ì‚ï¿½i + y â‹… sin ï¿½Ì‚ï¿½i

)
+ ğœ‘(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j

)
(A6)

= cos

(
2ğœ‹

ï¿½Ì‚ï¿½i

(
x â‹… cos ï¿½Ì‚ï¿½i + y â‹… sin ï¿½Ì‚ï¿½i + B(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j

))
(A7)

with i = 1, 2,â€¦ ,M, j = 1, 2,â€¦ ,N. Each element of the new dictionary will correspond to a given ğœ‘, and the
structure of the new dictionary, which we will denote as DII, is created by concatenation of the dictionaries

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9572



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

specific for each MSTID associated with each pair (ï¿½Ì‚ï¿½i, ï¿½Ì‚ï¿½i)detected in step I. Therefore, the dictionary associated
with a given MSTID Dï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i will consist of a set of waveforms that characterize the MSTID estimated for fixed
values of ï¿½Ì‚ï¿½i and ï¿½Ì‚ï¿½i and the range of values B(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j related to the phase ğœ‘j of the waveform.

DII =
[

Dï¿½Ì‚ï¿½1 ï¿½Ì‚ï¿½1 ,Dï¿½Ì‚ï¿½2 ï¿½Ì‚ï¿½2 ,â€¦ ,Dï¿½Ì‚ï¿½M ï¿½Ì‚ï¿½M
]
=
[

Tï¿½Ì‚ï¿½1 ï¿½Ì‚ï¿½11, Tï¿½Ì‚ï¿½1 ï¿½Ì‚ï¿½12,â€¦ , Tï¿½Ì‚ï¿½M ï¿½Ì‚ï¿½MN
]

(A8)

Thus, if the range of possible values of B(ï¿½Ì‚ï¿½i ï¿½Ì‚ï¿½i)j is N, the size of the dictionary DII is M Ã— N (M is the number of
candidate MSTIDs from step I).

Note that dividing the estimation into two steps, in addition to solving the estimation uncertainty in ğœ‘j ,
reduces the computational needs. That is, the combined size of the two dictionaries is 2N2 + MN, which is
much smaller than the size N3 needed for simultaneously computing all the parameters. For instance, if the
resolution of ğœƒ, ğœ†, and B are 2âˆ˜, 2 km, and 0.1 km, respectively, assuming M â‰¤ 10 in each snapshot, the size of
the dictionary is N3 â‰ˆ108 versus 2N2 +MNâ‰ˆ106. The value of N was variable and depended on the resolution
of each variable. Typically, the value of N was around 500.

A2. Dealing With Noise and Distortion
The difficulty of estimating the number of MSTIDs and their characteristics from an incomplete and nonuni-
form sampling is aggravated by the presence of noise that depends on the elevation of each satellite and of
distortions due to the geometry. The noise and distortion can be summarized into two categories, which are
dealt with differently by the algorithm ADDTID presented in this work.

Additive noise. The term 1
2
â€–V âˆ’ Dğ›¼tâ€–ğ“2<ğœ in the optimization problem allows for small deviations of the order

of ğœ . Note that as the metric is quadratic, the underlying hypothesis is that this additive noise follows a
Gaussian distribution.

Distortion due to multiplicative effects. These are effects that modify subsets of samples and can be understood
as the inaccuracy in the estimation of the slant factor cosğœ’(t), loss of data from one station, cycle slips, eleva-
tion of the satellites, etc. These effects can be dealt with by extending the dictionary by means of a diagonal
matrix of the size of the number of samples, that is, adding a diagonal subdictionary. This idea was introduced
by Wright et al. [2009], to model the effect of occlusions in the context of image processing, and is appropriate
for modeling the categories of distortion mentioned above. This diagonal subdictionary allows for assigning
a specific value to the sampling points that have suffered an extreme degradation while allowing the set of
global dictionary entries that model the MSTID as plane waves. The structure of the extended dictionary is
as follows:

DMÃ—(N+M) = [T1, T2, T3, ...TN, IMÃ—M] (A9)

Therefore, now the reconstruction of the plane wave model is given by

V(x, y) =
Nâˆ‘

i=0
ğ›¼i â‹… Ti(x, y) +

Mâˆ‘
j=0

ğ›¿j â‹… Ij(x, y) (A10)

where the diagonal term IMÃ—M in the dictionary allows for modeling effects on the isolated observations by
means of the coefficient ğ›¿j . Note that this coefficient is a dummy variable in the sense that it enters the opti-
mization problem as a variable but is not used. The variables of interest are ğ›¼i , i.e., the coefficients of the
elements of the dictionary related to the waves that we want to detect.

A3. Improvement: Reweighted LASSO
As mentioned in section 5.3, the LASSO algorithm allows for the reconstruction of the initial observation
vector of pierce points by means of a sparse set of elements of a dictionary. This can be thought of as an
approximation of ğ“0 by means of ğ“1. Nevertheless, the ğ“1 solution still allowed for similar elements of the
dictionary to have weights different from zero. The underlying physical phenomenon consists of a small
number of significant MSTIDs with different velocities, azimuths, and wavelengths. To improve the sparseness
of the solution, we have implemented a variant that provides a higher degree of sparsity than the original
LASSO. This solution is based on iteratively solving the problem stated in equation (11) by reweighting the
vector of estimated coefficients ğ›¼ from each intermediate solution. The idea proposed by Candes et al. [2008]

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9573



Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

uses a diagonal weight matrix W designed to penalize the use of correlated elements of the dictionary in the
reconstruction of the observation. The estimation of ï¿½Ì‚ï¿½(j) at the reweighting iteration j can be stated as

ï¿½Ì‚ï¿½(j) = arg min
ğ›¼

1
2
â€–V âˆ’ Dğ›¼â€–22 + ğœŒâ€–Wğ›¼â€–1 (A11)

where the diagonal of W consists of positive weights wi (i = 1, 2,â€¦ , dim(ğ›¼)), which redefines the influence of
the MSTID wave atoms. The elements of the diagonal matrix W are defined as wi =

1|ğ›¼i|+ğœ€w , if ğ›¼i â‰  0, otherwise
wi = âˆ. The term ğœ€w > 0, which typically is slightly smaller than the mean of the elements of ï¿½Ì‚ï¿½(j), ensures that
there are no divisions by zero. This normalization forces the solution ï¿½Ì‚ï¿½(j) to concentrate on the indices where
wi is small to prevent a penalization of larger coefficients in the regularization term.

Observe that the weighting term W in equation (A11) affects the regularization term, not the reconstruction
error term. This rescaling method seeks to achieve the selection of the weights independent of the magnitude
of the approximation coefficients ï¿½Ì‚ï¿½. An interesting property of this method is that the convergence is fast.
We have found empirically (also mentioned in Candes et al. [2008]) that only two or three iterations are needed
for convergence. Although the method introduces a normalization of the ğ›¼, the relative amplitude of the
MSTIDs is preserved.

References
Afraimovich, E., I. Edemskiy, A. Leonovich, L. Leonovich, S. Voeykov, and Y. V. Yasyukevich (2009), MHD nature of night-time MSTIDs excited

by the solar terminator, Geophys. Res. Lett., 36, L15106, doi:10.1029/2009GL039803.
Bilitza, D., D. Altadill, Y. Zhang, C. Mertens, V. Truhlik, P. Richards, L.-A. McKinnell, and B. Reinisch (2014), The International Reference

Ionosphere 2012â€”A model of international collaboration, J. Space Weather Space Clim., 4, A07.
Candes, E. J., M. B. Wakin, and S. P. Boyd (2008), Enhancing sparsity by reweighted ğ“1 minimization, J. Fourier Anal. Appl., 14(5â€“6), 877â€“905.
Chen, C., A. Saito, C. Lin, M. Yamamoto, S. Suzuki, and G. Seemala (2016), Medium-scale traveling ionospheric disturbances by

three-dimensional ionospheric GPS tomography, Earth Planets Space, 68(1), 1â€“9.
Chen, S. S., D. L. Donoho, and M. A. Saunders (2001), Atomic decomposition by basis pursuit, SIAM Rev., 43(1), 129â€“159.
Chilcote, M., J. LaBelle, F. Lind, A. Coster, E. Miller, I. Galkin, and A. Weatherwax (2015), Detection of traveling ionospheric disturbances by

medium-frequency Doppler sounding using AM radio transmissions, Radio Sci., 50, 249â€“263, doi:10.1002/2014RS005617.
Deng, Z., S. SchÃ¶n, H. Zhang, M. Bender, and J. Wickert (2013), Medium-scale traveling ionospheric disturbances (MSTID) modeling using a

dense German GPS network, Adv. Space Res., 51(6), 1001â€“1007.
Ding, F., W. Wan, G. Xu, T. Yu, G. Yang, and J.-S. Wang (2011), Climatology of medium-scale traveling ionospheric disturbances observed by a

GPS network in central China, J. Geophys. Res., 116, A09327, doi:10.1029/2011JA016545.
Dow, J. M., R. Neilan, and C. Rizos (2009), The International GNSS Service in a changing landscape of Global Navigation Satellite Systems,

J. Geod., 83(3â€“4), 191â€“198.
Fischler, M. A., and R. C. Bolles (1981), Random Sample Consensus: A paradigm for model fitting with applications to image analysis and

automated cartography, Commun. ACM, 24(6), 381â€“395.
Hastie, T., R. Tibshirani, and J. Friedman (2009), The Elements of Statistical Learning: Data Mining, Inference, and Prediction, 2nd ed.,

Springer Series in Statistics, New York.
Hastie, T., R. Tibshirani, and M. Wainwright (2015), Statistical Learning With Sparsity: The Lasso and Generalizations, CRC Press, Boca Raton, Fla.
HernÃ¡ndez-Pajares, M., J. Juan, J. Sanz, and O. Colombo (2002), Improving the real-time ionospheric determination from GPS sites at very

long distances over the equator, J. Geophys. Res., 107, 1296, doi:10.1029/2001JA009203.
HernÃ¡ndez-Pajares, M., J. Juan, and J. Sanz (2006), Medium-scale traveling ionospheric disturbances affecting GPS measurements: Spatial

and temporal analysis, J. Geophys. Res., 111, A07S11, doi:10.1029/2005JA011474.
HernÃ¡ndez-Pajares, M., J. Juan, J. Sanz, R. Orus, A. Garcia-Rigo, J. Feltens, A. Komjathy, S. Schaer, and A. Krankowski (2009), The IGS VTEC

maps: A reliable source of ionospheric information since 1998, J. Geod., 83(3â€“4), 263â€“275.
HernÃ¡ndez-Pajares, M., J. M. Juan, J. Sanz, Ã€. AragÃ³n-Ã€ngel, A. GarcÃ­a-Rigo, D. Salazar, and M. Escudero (2011), The ionosphere: Effects, GPS

modeling and the benefits for space geodetic techniques, J. Geod., 85(12), 887â€“907.
HernÃ¡ndez-Pajares, M., J. Juan, J. Sanz, and A. AragÃ³n-Ã€ngel (2012), Propagation of medium scale traveling ionospheric disturbances at

different latitudes and solar cycle conditions, Radio Sci., 47(6), RS0K05, doi:10.1029/2011RS004951.
HernÃ¡ndez-Pajares, M., et al. (2017), Direct MSTID mitigation in precise GPS processing, Radio Sci., 52, 321â€“337, doi:10.1002/2016RS006159.
Hocke, K., and K. Schlegel (1996), A review of atmospheric gravity waves and travelling ionospheric disturbances: 1982â€“1995,

Ann. Geophys., 14(9), 917â€“940.
Huang, F., X. Dou, J. Lei, J. Lin, F. Ding, and J. Zhong (2016), Statistical analysis of nighttime medium-scale traveling ionospheric

disturbances using airglow images and GPS observations over central China, J. Geophys. Res. Space Physics, 121, 8887â€“8899,
doi:10.1002/2016JA022760.

Hunsucker, R. D. (1982), Atmospheric gravity waves generated in the high-latitude ionosphere: A review, Rev. Geophys., 20(2), 293â€“315.
Jacobson, A. R., R. C. Carlos, R. S. Massey, and G. Wu (1995), Observations of traveling ionospheric disturbances with a satellite-beacon radio

interferometer: Seasonal and local time behavior, J. Geophys. Res., 100(A2), 1653â€“1665.
Kelley, M. C. (2011), On the origin of mesoscale TIDs at midlatitudes, Ann. Geophys., 29(2), 361â€“366.
Kotake, N., Y. Otsuka, T. Ogawa, T. Tsugawa, and A. Saito (2007), Statistical study of medium-scale traveling ionospheric disturbances

observed with the GPS networks in Southern California, Earth Planets Space, 59(2), 95â€“102.
Lee, J. K., F. Kamalabadi, and J. J. Makela (2008), Three-dimensional tomography of ionospheric variability using a dense GPS receiver array,

Radio Sci., 43(3), RS3001, doi:10.1029/2007RS003716.
Mevius, M., et al. (2016), Probing ionospheric structures using the LOFAR radio telescope, Radio Sci., 51, 927â€“941,

doi:10.1002/2016RS006028.

Acknowledgments
This work was supported by
the project TEC2015-69266-P
(MINECO/FEDER, UE). We also
acknowledge the scholarship from
China Scholarship Council (CSC)
under the grant CSC 201508390017.
We acknowledge that the GPS data
of GEONET are provided by the
Geospatial Information Authority
of Japan (GSI). We would like to
thank Nathaniel Frissell, for the
helpful comments that have improved
the manuscript. Also, we would like
to thank the anonymous reviewers
for their comments that have also
improved the first version of the
manuscript. All the code of this
project was done in Python using the
machine learning library scikit-learn.
The data for this paper are available,
and they can be requested from
any of the authors in particular
from Heng Yang (h.yang@upc.edu)
and Enrique Monte-Moreno
(enric.monte@upc.edu).

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9574

http://dx.doi.org/10.1029/2009GL039803
http://dx.doi.org/10.1002/2014RS005617
http://dx.doi.org/10.1029/2011JA016545
http://dx.doi.org/10.1029/2001JA009203
http://dx.doi.org/10.1029/2005JA011474
http://dx.doi.org/10.1029/2011RS004951
http://dx.doi.org/10.1002/2016RS006159
http://dx.doi.org/10.1002/2016JA022760
http://dx.doi.org/10.1029/2007RS003716
http://dx.doi.org/10.1002/2016RS006028


Journal of Geophysical Research: Space Physics 10.1002/2017JA023988

National Aeronautics and Space Administration/Goddard Space Flight Center (NASA/GSFC) (2012), International Reference Ionosphere
2012 (IRI-2012) Database. [Available at https://omniweb.gsfc.nasa.gov/vitmo/iri2012_vitmo.html, accessed 1â€“Mayâ€“2017.]

Ogawa, T., N. Nishitani, Y. Otsuka, K. Shiokawa, T. Tsugawa, and K. Hosokawa (2009), Medium-scale traveling ionospheric disturbances
observed with the SuperDARN Hokkaido radar, all-sky imager, and GPS network and their relation to concurrent sporadic E irregularities,
J. Geophys. Res., 114, A03316, doi:10.1029/2008JA013893.

Oinats, A. V., V. I. Kurkin, and N. Nishitani (2015), Statistical study of medium-scale traveling ionospheric disturbances using SuperDARN
Hokkaido ground backscatter data for 2011, Earth Planets Space, 67(1), 1â€“9.

Otsuka, Y., K. Shiokawa, T. Ogawa, and P. Wilkinson (2004), Geomagnetic conjugate observations of medium-scale traveling ionospheric
disturbances at midlatitude using all-sky airglow imagers, Geophys. Res. Lett., 31, L15803, doi:10.1029/2004GL020262.

Otsuka, Y., N. Kotake, K. Shiokawa, T. Ogawa, T. Tsugawa, and A. Saito (2011), Statistical study of medium-scale traveling ionospheric
disturbances observed with a GPS receiver network in Japan, in Aeronomy of the Earthâ€™s Atmosphere and Ionosphere, vol. 2, pp. 291â€“299,
Springer, Dordrecht, Netherlands.

Otsuka, Y., K. Suzuki, S. Nakagawa, M. Nishioka, K. Shiokawa, and T. Tsugawa (2013), GPS observations of medium-scale traveling
ionospheric disturbances over Europe, Ann. Geophys., 31(2), 163â€“172.

Sagiya, T. (2004), A decade of GEONET: 1994â€“2003, Earth Planets Space, 56(8), xxixâ€“xli.
Saito, A., S. Fukao, and S. Miyazaki (1998), High resolution mapping of TEC perturbations with the GSI GPS network over Japan,

Geophys. Res. Lett., 25(16), 3079â€“3082.
Shiokawa, K., C. Ihara, Y. Otsuka, and T. Ogawa (2003), Statistical study of nighttime medium-scale traveling ionospheric disturbances using

midlatitude airglow images, J. Geophys. Res., 108, 1052, doi:10.1029/2002JA009491.
Ssessanga, N., Y. H. Kim, and E. Kim (2015), Vertical structure of medium-scale traveling ionospheric disturbances, Geophys. Res. Lett., 42,

9156â€“9165, doi:10.1002/2015GL066093.
Stefanello, M., M. Muella, D. Amorim, C. Machado, J. Bageston, A. Pimenta, C. Martinis, C. Sullivan, J. Bittencourt, and N. Schuch (2015),

OI 630.0 nm all-sky image observations of medium-scale traveling ionospheric disturbances at geomagnetic conjugate points, J. Atmos.
Sol. Terr. Phys., 128, 58â€“69.

Tibshirani, R. (1996), Regression shrinkage and selection via the Lasso, J. R. Stat. Soc. Ser. B, 58, 267â€“288.
Tsugawa, T., K. Shiokawa, Y. Otsuka, T. Ogawa, A. Saito, and M. Nishioka (2006), Geomagnetic conjugate observations of large-scale traveling

ionospheric disturbances using GPS networks in Japan and Australia, J. Geophys. Res., 111, A02302, doi:10.1029/2005JA011300.
Tsugawa, T., N. Kotake, Y. Otsuka, and A. Saito (2007a), Medium-scale traveling ionospheric disturbances observed by GPS receiver network

in Japan: A short review, GPS Solutions, 11(2), 139â€“144.
Tsugawa, T., Y. Otsuka, A. Coster, and A. Saito (2007b), Medium-scale traveling ionospheric disturbances detected with dense and wide TEC

maps over North America, Geophys. Res. Lett., 34, L22101, doi:10.1029/2007GL031663.
Tsugawa, T., A. Saito, Y. Otsuka, M. Nishioka, T. Maruyama, H. Kato, T. Nagatsuma, and K. Murata (2011), Ionospheric disturbances detected

by GPS total electron content observation after the 2011 off the Pacific coast of Tohoku earthquake, Earth Planets Space, 63(7), 875â€“879.
U.S. Department of Commerce, N. O. a. A. A. (2011a), Earthquake Data and Information. [Available at https://www.ngdc.noaa.gov/

hazard/earthqk.shtml, accessed 20â€“Julyâ€“2016.]
U.S. Department of Commerce, N. O. a. A. A. (2011b), Tsunami Data and Information. [Available at https://www.ngdc.noaa.gov/

hazard/tsu.shtml, accessed 20â€“Julyâ€“2016.]
U.S. Department of Commerce, N. O. a. A. A. (2011c), Solar Data Services: Sun, Solar Activity and Upper Atmosphere Data. [Available at

https://www.ngdc.noaa.gov/stp/solar/solardataservices.html, accessed 20â€“Julyâ€“2016.]
U.S. Department of Commerce, N. O. a. A. A. (2011d), Geomagnetic Calculators, Maps, Models, and Software. [Available at

http://www.ngdc.noaa.gov/geomag/models.shtml, accessed 20â€“Julyâ€“2016.]
U.S. Geological Surve (USGS) (2011a), Earthquake Summary, Magnitude 4.6, Near Honshu Japan. [Available at https://earthquake.usgs.gov/

earthquakes/eventpage/usp000hy51#executive Date: 2011â€“03â€“21 08:09:26 UTC; Location: 39.195âˆ˜ N, 142.625âˆ˜ E; Depth: 49.9 km.]
U.S. Geological Surve (USGS) (2011b), Earthquake Summary, Magnitude 4.9, Near Honshu Japan. [Available at https://earthquake.usgs.gov/

earthquakes/eventpage/usp000hy50#executive Date: 2011â€“03â€“21 08:06:22 UTC; Location: 36.452âˆ˜N, 141.537âˆ˜E; Depth: 21.4 km.]
Wright, J., A. Y. Yang, A. Ganesh, S. S. Sastry, and Y. Ma (2009), Robust face recognition via sparse representation, IEEE Trans. Pattern Anal.

Mach. Intell., 31(2), 210â€“227.

YANG ET AL. MULTI-TID DETECTION AND CHARACTERIZATION 9575

https://omniweb.gsfc.nasa.gov/vitmo/iri2012_vitmo.html
http://dx.doi.org/10.1029/2008JA013893
http://dx.doi.org/10.1029/2004GL020262
http://dx.doi.org/10.1029/2002JA009491
http://dx.doi.org/10.1002/2015GL066093
http://dx.doi.org/10.1029/2005JA011300
http://dx.doi.org/10.1029/2007GL031663
https://www.ngdc.noaa.gov/hazard/earthqk.shtml
https://www.ngdc.noaa.gov/hazard/earthqk.shtml
https://www.ngdc.noaa.gov/hazard/tsu.shtml
https://www.ngdc.noaa.gov/hazard/tsu.shtml
https://www.ngdc.noaa.gov/stp/solar/solardataservices.html
http://www.ngdc.noaa.gov/geomag/models.shtml
https://earthquake.usgs.gov/earthquakes/eventpage/usp000hy51#executive
https://earthquake.usgs.gov/earthquakes/eventpage/usp000hy51#executive
https://earthquake.usgs.gov/earthquakes/eventpage/usp000hy50#executive
https://earthquake.usgs.gov/earthquakes/eventpage/usp000hy50#executive

	Abstract
	References
















<<
  /ASCII85EncodePages false
  /AllowTransparency false
  /AutoPositionEPSFiles true
  /AutoRotatePages /All
  /Binding /Left
  /CalGrayProfile (None)
  /CalRGBProfile (ECI-RGB.icc)
  /CalCMYKProfile (Photoshop 5 Default CMYK)
  /sRGBProfile (sRGB IEC61966-2.1)
  /CannotEmbedFontPolicy /Warning
  /CompatibilityLevel 1.6
  /CompressObjects /Off
  /CompressPages true
  /ConvertImagesToIndexed true
  /PassThroughJPEGImages false
  /CreateJobTicket false
  /DefaultRenderingIntent /Default
  /DetectBlends false
  /DetectCurves 0.1000
  /ColorConversionStrategy /sRGB
  /DoThumbnails false
  /EmbedAllFonts true
  /EmbedOpenType false
  /ParseICCProfilesInComments true
  /EmbedJobOptions true
  /DSCReportingLevel 0
  /EmitDSCWarnings false
  /EndPage -1
  /ImageMemory 524288
  /LockDistillerParams false
  /MaxSubsetPct 100
  /Optimize true
  /OPM 1
  /ParseDSCComments true
  /ParseDSCCommentsForDocInfo true
  /PreserveCopyPage true
  /PreserveDICMYKValues true
  /PreserveEPSInfo false
  /PreserveFlatness false
  /PreserveHalftoneInfo false
  /PreserveOPIComments false
  /PreserveOverprintSettings true
  /StartPage 1
  /SubsetFonts true
  /TransferFunctionInfo /Preserve
  /UCRandBGInfo /Remove
  /UsePrologue false
  /ColorSettingsFile ()
  /AlwaysEmbed [ true
  ]
  /NeverEmbed [ true
    /Courier
    /Courier-Bold
    /Courier-BoldOblique
    /Courier-Oblique
    /Helvetica
    /Helvetica-Bold
    /Helvetica-BoldOblique
    /Helvetica-Oblique
    /Symbol
    /Times-Bold
    /Times-BoldItalic
    /Times-Italic
    /Times-Roman
    /ZapfDingbats
  ]
  /AntiAliasColorImages false
  /CropColorImages false
  /ColorImageMinResolution 300
  /ColorImageMinResolutionPolicy /OK
  /DownsampleColorImages true
  /ColorImageDownsampleType /Bicubic
  /ColorImageResolution 300
  /ColorImageDepth -1
  /ColorImageMinDownsampleDepth 1
  /ColorImageDownsampleThreshold 1.00000
  /EncodeColorImages true
  /ColorImageFilter /DCTEncode
  /AutoFilterColorImages true
  /ColorImageAutoFilterStrategy /JPEG
  /ColorACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /ColorImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /JPEG2000ColorACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000ColorImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasGrayImages false
  /CropGrayImages false
  /GrayImageMinResolution 300
  /GrayImageMinResolutionPolicy /OK
  /DownsampleGrayImages true
  /GrayImageDownsampleType /Bicubic
  /GrayImageResolution 300
  /GrayImageDepth -1
  /GrayImageMinDownsampleDepth 2
  /GrayImageDownsampleThreshold 1.00000
  /EncodeGrayImages true
  /GrayImageFilter /DCTEncode
  /AutoFilterGrayImages true
  /GrayImageAutoFilterStrategy /JPEG
  /GrayACSImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /GrayImageDict <<
    /QFactor 0.76
    /HSamples [2 1 1 2] /VSamples [2 1 1 2]
  >>
  /JPEG2000GrayACSImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /JPEG2000GrayImageDict <<
    /TileWidth 256
    /TileHeight 256
    /Quality 15
  >>
  /AntiAliasMonoImages false
  /CropMonoImages false
  /MonoImageMinResolution 1200
  /MonoImageMinResolutionPolicy /OK
  /DownsampleMonoImages true
  /MonoImageDownsampleType /Bicubic
  /MonoImageResolution 400
  /MonoImageDepth -1
  /MonoImageDownsampleThreshold 1.00000
  /EncodeMonoImages true
  /MonoImageFilter /CCITTFaxEncode
  /MonoImageDict <<
    /K -1
  >>
  /AllowPSXObjects true
  /CheckCompliance [
    /None
  ]
  /PDFX1aCheck false
  /PDFX3Check false
  /PDFXCompliantPDFOnly false
  /PDFXNoTrimBoxError true
  /PDFXTrimBoxToMediaBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXSetBleedBoxToMediaBox true
  /PDFXBleedBoxToTrimBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXOutputIntentProfile (None)
  /PDFXOutputConditionIdentifier ()
  /PDFXOutputCondition ()
  /PDFXRegistryName ()
  /PDFXTrapped /False

  /CreateJDFFile false
  /Description <<
    /ENU ()
  >>
  /Namespace [
    (Adobe)
    (Common)
    (1.0)
  ]
  /OtherNamespaces [
    <<
      /AsReaderSpreads false
      /CropImagesToFrames true
      /ErrorControl /WarnAndContinue
      /FlattenerIgnoreSpreadOverrides false
      /IncludeGuidesGrids false
      /IncludeNonPrinting false
      /IncludeSlug false
      /Namespace [
        (Adobe)
        (InDesign)
        (4.0)
      ]
      /OmitPlacedBitmaps false
      /OmitPlacedEPS false
      /OmitPlacedPDF false
      /SimulateOverprint /Legacy
    >>
    <<
      /AllowImageBreaks true
      /AllowTableBreaks true
      /ExpandPage false
      /HonorBaseURL true
      /HonorRolloverEffect false
      /IgnoreHTMLPageBreaks false
      /IncludeHeaderFooter false
      /MarginOffset [
        0
        0
        0
        0
      ]
      /MetadataAuthor ()
      /MetadataKeywords ()
      /MetadataSubject ()
      /MetadataTitle ()
      /MetricPageSize [
        0
        0
      ]
      /MetricUnit /inch
      /MobileCompatible 0
      /Namespace [
        (Adobe)
        (GoLive)
        (8.0)
      ]
      /OpenZoomToHTMLFontSize false
      /PageOrientation /Portrait
      /RemoveBackground false
      /ShrinkContent true
      /TreatColorsAs /MainMonitorColors
      /UseEmbeddedProfiles false
      /UseHTMLTitleAsMetadata true
    >>
    <<
      /AddBleedMarks false
      /AddColorBars false
      /AddCropMarks false
      /AddPageInfo false
      /AddRegMarks false
      /BleedOffset [
        0
        0
        0
        0
      ]
      /ConvertColors /ConvertToRGB
      /DestinationProfileName (sRGB IEC61966-2.1)
      /DestinationProfileSelector /UseName
      /Downsample16BitImages true
      /FlattenerPreset <<
        /PresetSelector /MediumResolution
      >>
      /FormElements true
      /GenerateStructure false
      /IncludeBookmarks false
      /IncludeHyperlinks false
      /IncludeInteractive false
      /IncludeLayers false
      /IncludeProfiles true
      /MarksOffset 6
      /MarksWeight 0.250000
      /MultimediaHandling /UseObjectSettings
      /Namespace [
        (Adobe)
        (CreativeSuite)
        (2.0)
      ]
      /PDFXOutputIntentProfileSelector /DocumentCMYK
      /PageMarksFile /RomanDefault
      /PreserveEditing true
      /UntaggedCMYKHandling /UseDocumentProfile
      /UntaggedRGBHandling /UseDocumentProfile
      /UseDocumentBleed false
    >>
  ]
>> setdistillerparams
<<
  /HWResolution [600 600]
  /PageSize [612.000 792.000]
>> setpagedevice

